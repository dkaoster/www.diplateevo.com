function ar(){}const Yf=t=>t;function dd(t,e){for(const r in e)t[r]=e[r];return t}function qf(t){return t()}function Zf(){return Object.create(null)}function zr(t){t.forEach(qf)}function Qf(t){return typeof t=="function"}function hd(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ua;function $m(t,e){return ua||(ua=document.createElement("a")),ua.href=e,t===ua.href}function md(t){return Object.keys(t).length===0}function pd(t,...e){if(t==null)return ar;const r=t.subscribe(...e);return r.unsubscribe?()=>r.unsubscribe():r}function zm(t,e,r){t.$$.on_destroy.push(pd(e,r))}function Hm(t,e,r,n){if(t){const o=Kf(t,e,r,n);return t[0](o)}}function Kf(t,e,r,n){return t[1]&&n?dd(r.ctx.slice(),t[1](n(e))):r.ctx}function jm(t,e,r,n){if(t[2]&&n){const o=t[2](n(r));if(e.dirty===void 0)return o;if(typeof o=="object"){const l=[],b=Math.max(e.dirty.length,o.length);for(let T=0;T<b;T+=1)l[T]=e.dirty[T]|o[T];return l}return e.dirty|o}return e.dirty}function Vm(t,e,r,n,o,l){if(o){const b=Kf(e,r,n,l);t.p(b,o)}}function Xm(t){if(t.ctx.length>32){const e=[],r=t.ctx.length/32;for(let n=0;n<r;n++)e[n]=-1;return e}return-1}const Jf=typeof window!="undefined";let vd=Jf?()=>window.performance.now():()=>Date.now(),Ci=Jf?t=>requestAnimationFrame(t):ar;const Hr=new Set;function es(t){Hr.forEach(e=>{e.c(t)||(Hr.delete(e),e.f())}),Hr.size!==0&&Ci(es)}function bd(t){let e;return Hr.size===0&&Ci(es),{promise:new Promise(r=>{Hr.add(e={c:t,f:r})}),abort(){Hr.delete(e)}}}let la=!1;function _d(){la=!0}function yd(){la=!1}function gd(t,e,r,n){for(;t<e;){const o=t+(e-t>>1);r(o)<=n?t=o+1:e=o}return t}function xd(t){if(t.hydrate_init)return;t.hydrate_init=!0;let e=t.childNodes;if(t.nodeName==="HEAD"){const D=[];for(let j=0;j<e.length;j++){const le=e[j];le.claim_order!==void 0&&D.push(le)}e=D}const r=new Int32Array(e.length+1),n=new Int32Array(e.length);r[0]=-1;let o=0;for(let D=0;D<e.length;D++){const j=e[D].claim_order,le=(o>0&&e[r[o]].claim_order<=j?o+1:gd(1,o,ve=>e[r[ve]].claim_order,j))-1;n[D]=r[le]+1;const ge=le+1;r[ge]=D,o=Math.max(ge,o)}const l=[],b=[];let T=e.length-1;for(let D=r[o]+1;D!=0;D=n[D-1]){for(l.push(e[D-1]);T>=D;T--)b.push(e[T]);T--}for(;T>=0;T--)b.push(e[T]);l.reverse(),b.sort((D,j)=>D.claim_order-j.claim_order);for(let D=0,j=0;D<b.length;D++){for(;j<l.length&&b[D].claim_order>=l[j].claim_order;)j++;const le=j<l.length?l[j]:null;t.insertBefore(b[D],le)}}function ts(t,e){t.appendChild(e)}function rs(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Ed(t){const e=ca("style");return Td(rs(t),e),e.sheet}function Td(t,e){ts(t.head||t,e)}function wd(t,e){if(la){for(xd(t),(t.actual_end_child===void 0||t.actual_end_child!==null&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild);t.actual_end_child!==null&&t.actual_end_child.claim_order===void 0;)t.actual_end_child=t.actual_end_child.nextSibling;e!==t.actual_end_child?(e.claim_order!==void 0||e.parentNode!==t)&&t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling}else(e.parentNode!==t||e.nextSibling!==null)&&t.appendChild(e)}function Ad(t,e,r){t.insertBefore(e,r||null)}function Sd(t,e,r){la&&!r?wd(t,e):(e.parentNode!==t||e.nextSibling!=r)&&t.insertBefore(e,r||null)}function dn(t){t.parentNode.removeChild(t)}function Wm(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function ca(t){return document.createElement(t)}function kd(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Ri(t){return document.createTextNode(t)}function Ym(){return Ri(" ")}function qm(){return Ri("")}function ns(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function Zm(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function Ld(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function Qm(t,e){const r=Object.getOwnPropertyDescriptors(t.__proto__);for(const n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:r[n]&&r[n].set?t[n]=e[n]:Ld(t,n,e[n])}function Cd(t){return Array.from(t.childNodes)}function as(t){t.claim_info===void 0&&(t.claim_info={last_index:0,total_claimed:0})}function is(t,e,r,n,o=!1){as(t);const l=(()=>{for(let b=t.claim_info.last_index;b<t.length;b++){const T=t[b];if(e(T)){const D=r(T);return D===void 0?t.splice(b,1):t[b]=D,o||(t.claim_info.last_index=b),T}}for(let b=t.claim_info.last_index-1;b>=0;b--){const T=t[b];if(e(T)){const D=r(T);return D===void 0?t.splice(b,1):t[b]=D,o?D===void 0&&t.claim_info.last_index--:t.claim_info.last_index=b,T}}return n()})();return l.claim_order=t.claim_info.total_claimed,t.claim_info.total_claimed+=1,l}function os(t,e,r,n){return is(t,o=>o.nodeName===e,o=>{const l=[];for(let b=0;b<o.attributes.length;b++){const T=o.attributes[b];r[T.name]||l.push(T.name)}l.forEach(b=>o.removeAttribute(b))},()=>n(e))}function Km(t,e,r){return os(t,e,r,ca)}function Jm(t,e,r){return os(t,e,r,kd)}function Rd(t,e){return is(t,r=>r.nodeType===3,r=>{const n=""+e;if(r.data.startsWith(n)){if(r.data.length!==n.length)return r.splitText(n.length)}else r.data=n},()=>Ri(e),!0)}function ep(t){return Rd(t," ")}function fs(t,e,r){for(let n=r;n<t.length;n+=1){const o=t[n];if(o.nodeType===8&&o.textContent.trim()===e)return n}return t.length}function tp(t){const e=fs(t,"HTML_TAG_START",0),r=fs(t,"HTML_TAG_END",e);if(e===r)return new ss;as(t);const n=t.splice(e,r-e+1);dn(n[0]),dn(n[n.length-1]);const o=n.slice(1,n.length-1);for(const l of o)l.claim_order=t.claim_info.total_claimed,t.claim_info.total_claimed+=1;return new ss(o)}function rp(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function np(t,e,r,n){r===null?t.style.removeProperty(e):t.style.setProperty(e,r,n?"important":"")}let da;function Od(){if(da===void 0){da=!1;try{typeof window!="undefined"&&window.parent&&window.parent.document}catch{da=!0}}return da}function ap(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");const n=ca("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const o=Od();let l;return o?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",l=ns(window,"message",b=>{b.source===n.contentWindow&&e()})):(n.src="about:blank",n.onload=()=>{l=ns(n.contentWindow,"resize",e)}),ts(t,n),()=>{(o||l&&n.contentWindow)&&l(),dn(n)}}function ip(t,e,r){t.classList[r?"add":"remove"](e)}function Dd(t,e,r=!1){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,r,!1,e),n}function op(t,e=document.body){return Array.from(e.querySelectorAll(t))}class Fd{constructor(){this.e=this.n=null}c(e){this.h(e)}m(e,r,n=null){this.e||(this.e=ca(r.nodeName),this.t=r,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let r=0;r<this.n.length;r+=1)Ad(this.t,this.n[r],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(dn)}}class ss extends Fd{constructor(e){super();this.e=this.n=null,this.l=e}c(e){this.l?this.n=this.l:super.c(e)}i(e){for(let r=0;r<this.n.length;r+=1)Sd(this.t,this.n[r],e)}}const ha=new Map;let ma=0;function Gd(t){let e=5381,r=t.length;for(;r--;)e=(e<<5)-e^t.charCodeAt(r);return e>>>0}function Id(t,e){const r={stylesheet:Ed(e),rules:{}};return ha.set(t,r),r}function us(t,e,r,n,o,l,b,T=0){const D=16.666/n;let j=`{
`;for(let Ye=0;Ye<=1;Ye+=D){const Fe=e+(r-e)*l(Ye);j+=Ye*100+`%{${b(Fe,1-Fe)}}
`}const le=j+`100% {${b(r,1-r)}}
}`,ge=`__svelte_${Gd(le)}_${T}`,ve=rs(t),{stylesheet:oe,rules:$e}=ha.get(ve)||Id(ve,t);$e[ge]||($e[ge]=!0,oe.insertRule(`@keyframes ${ge} ${le}`,oe.cssRules.length));const je=t.style.animation||"";return t.style.animation=`${je?`${je}, `:""}${ge} ${n}ms linear ${o}ms 1 both`,ma+=1,ge}function Nd(t,e){const r=(t.style.animation||"").split(", "),n=r.filter(e?l=>l.indexOf(e)<0:l=>l.indexOf("__svelte")===-1),o=r.length-n.length;o&&(t.style.animation=n.join(", "),ma-=o,ma||Md())}function Md(){Ci(()=>{ma||(ha.forEach(t=>{const{stylesheet:e}=t;let r=e.cssRules.length;for(;r--;)e.deleteRule(r);t.rules={}}),ha.clear())})}let hn;function mn(t){hn=t}function pn(){if(!hn)throw new Error("Function called outside component initialization");return hn}function fp(t){pn().$$.on_mount.push(t)}function sp(t){pn().$$.after_update.push(t)}function up(t){pn().$$.on_destroy.push(t)}function lp(t,e){pn().$$.context.set(t,e)}function cp(t){return pn().$$.context.get(t)}const vn=[],ls=[],pa=[],cs=[],ds=Promise.resolve();let Oi=!1;function hs(){Oi||(Oi=!0,ds.then(ms))}function dp(){return hs(),ds}function va(t){pa.push(t)}const Di=new Set;let ba=0;function ms(){const t=hn;do{for(;ba<vn.length;){const e=vn[ba];ba++,mn(e),Bd(e.$$)}for(mn(null),vn.length=0,ba=0;ls.length;)ls.pop()();for(let e=0;e<pa.length;e+=1){const r=pa[e];Di.has(r)||(Di.add(r),r())}pa.length=0}while(vn.length);for(;cs.length;)cs.pop()();Oi=!1,Di.clear(),mn(t)}function Bd(t){if(t.fragment!==null){t.update(),zr(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(va)}}let bn;function Pd(){return bn||(bn=Promise.resolve(),bn.then(()=>{bn=null})),bn}function Fi(t,e,r){t.dispatchEvent(Dd(`${e?"intro":"outro"}${r}`))}const _a=new Set;let Xt;function hp(){Xt={r:0,c:[],p:Xt}}function mp(){Xt.r||zr(Xt.c),Xt=Xt.p}function Ud(t,e){t&&t.i&&(_a.delete(t),t.i(e))}function pp(t,e,r,n){if(t&&t.o){if(_a.has(t))return;_a.add(t),Xt.c.push(()=>{_a.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}}const $d={duration:0};function vp(t,e,r,n){let o=e(t,r),l=n?0:1,b=null,T=null,D=null;function j(){D&&Nd(t,D)}function le(ve,oe){const $e=ve.b-l;return oe*=Math.abs($e),{a:l,b:ve.b,d:$e,duration:oe,start:ve.start,end:ve.start+oe,group:ve.group}}function ge(ve){const{delay:oe=0,duration:$e=300,easing:je=Yf,tick:Ye=ar,css:Fe}=o||$d,be={start:vd()+oe,b:ve};ve||(be.group=Xt,Xt.r+=1),b||T?T=be:(Fe&&(j(),D=us(t,l,ve,$e,oe,je,Fe)),ve&&Ye(0,1),b=le(be,$e),va(()=>Fi(t,ve,"start")),bd(Te=>{if(T&&Te>T.start&&(b=le(T,$e),T=null,Fi(t,b.b,"start"),Fe&&(j(),D=us(t,l,b.b,b.duration,0,je,o.css))),b){if(Te>=b.end)Ye(l=b.b,1-l),Fi(t,b.b,"end"),T||(b.b?j():--b.group.r||zr(b.group.c)),b=null;else if(Te>=b.start){const Ie=Te-b.start;l=b.a+b.d*je(Ie/b.duration),Ye(l,1-l)}}return!!(b||T)}))}return{run(ve){Qf(o)?Pd().then(()=>{o=o(),ge(ve)}):ge(ve)},end(){j(),b=T=null}}}function bp(t,e){const r={},n={},o={$$scope:1};let l=t.length;for(;l--;){const b=t[l],T=e[l];if(T){for(const D in b)D in T||(n[D]=1);for(const D in T)o[D]||(r[D]=T[D],o[D]=1);t[l]=T}else for(const D in b)o[D]=1}for(const b in n)b in r||(r[b]=void 0);return r}function _p(t){return typeof t=="object"&&t!==null?t:{}}function yp(t){t&&t.c()}function gp(t,e){t&&t.l(e)}function zd(t,e,r,n){const{fragment:o,on_mount:l,on_destroy:b,after_update:T}=t.$$;o&&o.m(e,r),n||va(()=>{const D=l.map(qf).filter(Qf);b?b.push(...D):zr(D),t.$$.on_mount=[]}),T.forEach(va)}function Hd(t,e){const r=t.$$;r.fragment!==null&&(zr(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function jd(t,e){t.$$.dirty[0]===-1&&(vn.push(t),hs(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function xp(t,e,r,n,o,l,b,T=[-1]){const D=hn;mn(t);const j=t.$$={fragment:null,ctx:null,props:l,update:ar,not_equal:o,bound:Zf(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(D?D.$$.context:[])),callbacks:Zf(),dirty:T,skip_bound:!1,root:e.target||D.$$.root};b&&b(j.root);let le=!1;if(j.ctx=r?r(t,e.props||{},(ge,ve,...oe)=>{const $e=oe.length?oe[0]:ve;return j.ctx&&o(j.ctx[ge],j.ctx[ge]=$e)&&(!j.skip_bound&&j.bound[ge]&&j.bound[ge]($e),le&&jd(t,ge)),ve}):[],j.update(),le=!0,zr(j.before_update),j.fragment=n?n(j.ctx):!1,e.target){if(e.hydrate){_d();const ge=Cd(e.target);j.fragment&&j.fragment.l(ge),ge.forEach(dn)}else j.fragment&&j.fragment.c();e.intro&&Ud(t.$$.fragment),zd(t,e.target,e.anchor,e.customElement),yd(),ms()}mn(D)}class Ep{$destroy(){Hd(this,1),this.$destroy=ar}$on(e,r){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const o=n.indexOf(r);o!==-1&&n.splice(o,1)}}$set(e){this.$$set&&!md(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const jr=[];function Tp(t,e){return{subscribe:Vd(t,e).subscribe}}function Vd(t,e=ar){let r;const n=new Set;function o(T){if(hd(t,T)&&(t=T,r)){const D=!jr.length;for(const j of n)j[1](),jr.push(j,t);if(D){for(let j=0;j<jr.length;j+=2)jr[j][0](jr[j+1]);jr.length=0}}}function l(T){o(T(t))}function b(T,D=ar){const j=[T,D];return n.add(j),n.size===1&&(r=e(o)||ar),T(t),()=>{n.delete(j),n.size===0&&(r(),r=null)}}return{set:o,update:l,subscribe:b}}function wp(t,{delay:e=0,duration:r=400,easing:n=Yf}={}){const o=+getComputedStyle(t).opacity;return{delay:e,duration:r,easing:n,css:l=>`opacity: ${l*o}`}}var Xd=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},ps={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(Xd,function(){var r=function(a){return a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Float32Array||a instanceof Float64Array||a instanceof Uint8ClampedArray},n=function(a,f){for(var p=Object.keys(f),C=0;C<p.length;++C)a[p[C]]=f[p[C]];return a},o=`
`;function l(a){return typeof atob!="undefined"?atob(a):"base64:"+a}function b(a){var f=new Error("(regl) "+a);throw console.error(f),f}function T(a,f){a||b(f)}function D(a){return a?": "+a:""}function j(a,f,p){a in f||b("unknown parameter ("+a+")"+D(p)+". possible values: "+Object.keys(f).join())}function le(a,f){r(a)||b("invalid parameter type"+D(f)+". must be a typed array")}function ge(a,f){switch(f){case"number":return typeof a=="number";case"object":return typeof a=="object";case"string":return typeof a=="string";case"boolean":return typeof a=="boolean";case"function":return typeof a=="function";case"undefined":return typeof a=="undefined";case"symbol":return typeof a=="symbol"}}function ve(a,f,p){ge(a,f)||b("invalid parameter type"+D(p)+". expected "+f+", got "+typeof a)}function oe(a,f){a>=0&&(a|0)===a||b("invalid parameter type, ("+a+")"+D(f)+". must be a nonnegative integer")}function $e(a,f,p){f.indexOf(a)<0&&b("invalid value"+D(p)+". must be one of: "+f)}var je=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ye(a){Object.keys(a).forEach(function(f){je.indexOf(f)<0&&b('invalid regl constructor argument "'+f+'". must be one of '+je)})}function Fe(a,f){for(a=a+"";a.length<f;)a=" "+a;return a}function be(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Te(a,f){this.number=a,this.line=f,this.errors=[]}function Ie(a,f,p){this.file=a,this.line=f,this.message=p}function qe(){var a=new Error,f=(a.stack||a).toString(),p=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(f);if(p)return p[1];var C=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(f);return C?C[1]:"unknown"}function Ze(){var a=new Error,f=(a.stack||a).toString(),p=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(f);if(p)return p[1];var C=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(f);return C?C[1]:"unknown"}function yt(a,f){var p=a.split(`
`),C=1,M=0,L={unknown:new be,0:new be};L.unknown.name=L[0].name=f||qe(),L.unknown.lines.push(new Te(0,""));for(var F=0;F<p.length;++F){var H=p[F],z=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(H);if(z)switch(z[1]){case"line":var q=/(\d+)(\s+\d+)?/.exec(z[2]);q&&(C=q[1]|0,q[2]&&(M=q[2]|0,M in L||(L[M]=new be)));break;case"define":var Q=/SHADER_NAME(_B64)?\s+(.*)$/.exec(z[2]);Q&&(L[M].name=Q[1]?l(Q[2]):Q[2]);break}L[M].lines.push(new Te(C++,H))}return Object.keys(L).forEach(function(Z){var J=L[Z];J.lines.forEach(function(V){J.index[V.number]=V})}),L}function gt(a){var f=[];return a.split(`
`).forEach(function(p){if(!(p.length<5)){var C=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(p);C?f.push(new Ie(C[1]|0,C[2]|0,C[3].trim())):p.length>0&&f.push(new Ie("unknown",0,p))}}),f}function Mt(a,f){f.forEach(function(p){var C=a[p.file];if(C){var M=C.index[p.line];if(M){M.errors.push(p),C.hasErrors=!0;return}}a.unknown.hasErrors=!0,a.unknown.lines[0].errors.push(p)})}function ir(a,f,p,C,M){if(!a.getShaderParameter(f,a.COMPILE_STATUS)){var L=a.getShaderInfoLog(f),F=C===a.FRAGMENT_SHADER?"fragment":"vertex";Ln(p,"string",F+" shader source must be a string",M);var H=yt(p,M),z=gt(L);Mt(H,z),Object.keys(H).forEach(function(q){var Q=H[q];if(!Q.hasErrors)return;var Z=[""],J=[""];function V(Y,E){Z.push(Y),J.push(E||"")}V("file number "+q+": "+Q.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Q.lines.forEach(function(Y){if(Y.errors.length>0){V(Fe(Y.number,4)+"|  ","background-color:yellow; font-weight:bold"),V(Y.line+o,"color:red; background-color:yellow; font-weight:bold");var E=0;Y.errors.forEach(function(O){var W=O.message,ue=/^\s*'(.*)'\s*:\s*(.*)$/.exec(W);if(ue){var $=ue[1];switch(W=ue[2],$){case"assign":$="=";break}E=Math.max(Y.line.indexOf($,E),0)}else E=0;V(Fe("| ",6)),V(Fe("^^^",E+3)+o,"font-weight:bold"),V(Fe("| ",6)),V(W+o,"font-weight:bold")}),V(Fe("| ",6)+o)}else V(Fe(Y.number,4)+"|  "),V(Y.line+o,"color:red")}),typeof document!="undefined"&&!window.chrome?(J[0]=Z.join("%c"),console.log.apply(console,J)):console.log(Z.join(""))}),T.raise("Error compiling "+F+" shader, "+H[0].name)}}function or(a,f,p,C,M){if(!a.getProgramParameter(f,a.LINK_STATUS)){var L=a.getProgramInfoLog(f),F=yt(p,M),H=yt(C,M),z='Error linking program with vertex shader, "'+H[0].name+'", and fragment shader "'+F[0].name+'"';typeof document!="undefined"?console.log("%c"+z+o+"%c"+L,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(z+o+L),T.raise(z)}}function wr(a){a._commandRef=qe()}function Xr(a,f,p,C){wr(a);function M(z){return z?C.id(z):0}a._fragId=M(a.static.frag),a._vertId=M(a.static.vert);function L(z,q){Object.keys(q).forEach(function(Q){z[C.id(Q)]=!0})}var F=a._uniformSet={};L(F,f.static),L(F,f.dynamic);var H=a._attributeSet={};L(H,p.static),L(H,p.dynamic),a._hasCount="count"in a.static||"count"in a.dynamic||"elements"in a.static||"elements"in a.dynamic}function Zt(a,f){var p=Ze();b(a+" in command "+(f||qe())+(p==="unknown"?"":" called from "+p))}function Ft(a,f,p){a||Zt(f,p||qe())}function Ar(a,f,p,C){a in f||Zt("unknown parameter ("+a+")"+D(p)+". possible values: "+Object.keys(f).join(),C||qe())}function Ln(a,f,p,C){ge(a,f)||Zt("invalid parameter type"+D(p)+". expected "+f+", got "+typeof a,C||qe())}function Ta(a){a()}function wa(a,f,p){a.texture?$e(a.texture._texture.internalformat,f,"unsupported texture format for attachment"):$e(a.renderbuffer._renderbuffer.format,p,"unsupported renderbuffer format for attachment")}var Sr=33071,Cn=9728,Aa=9984,Sa=9985,ka=9986,La=9987,Ca=5120,Ra=5121,Oa=5122,Ee=5123,ze=5124,Xe=5125,ne=5126,xt=32819,Qe=32820,Et=33635,Tt=34042,zt=36193,wt={};wt[Ca]=wt[Ra]=1,wt[Oa]=wt[Ee]=wt[zt]=wt[Et]=wt[xt]=wt[Qe]=2,wt[ze]=wt[Xe]=wt[ne]=wt[Tt]=4;function Wi(a,f){return a===Qe||a===xt||a===Et?2:a===Tt?4:wt[a]*f}function Rn(a){return!(a&a-1)&&!!a}function Zs(a,f,p){var C,M=f.width,L=f.height,F=f.channels;T(M>0&&M<=p.maxTextureSize&&L>0&&L<=p.maxTextureSize,"invalid texture shape"),(a.wrapS!==Sr||a.wrapT!==Sr)&&T(Rn(M)&&Rn(L),"incompatible wrap mode for texture, both width and height must be power of 2"),f.mipmask===1?M!==1&&L!==1&&T(a.minFilter!==Aa&&a.minFilter!==ka&&a.minFilter!==Sa&&a.minFilter!==La,"min filter requires mipmap"):(T(Rn(M)&&Rn(L),"texture must be a square power of 2 to support mipmapping"),T(f.mipmask===(M<<1)-1,"missing or incomplete mipmap data")),f.type===ne&&(p.extensions.indexOf("oes_texture_float_linear")<0&&T(a.minFilter===Cn&&a.magFilter===Cn,"filter not supported, must enable oes_texture_float_linear"),T(!a.genMipmaps,"mipmap generation not supported with float textures"));var H=f.images;for(C=0;C<16;++C)if(H[C]){var z=M>>C,q=L>>C;T(f.mipmask&1<<C,"missing mipmap data");var Q=H[C];if(T(Q.width===z&&Q.height===q,"invalid shape for mip images"),T(Q.format===f.format&&Q.internalformat===f.internalformat&&Q.type===f.type,"incompatible type for mip image"),!Q.compressed)if(Q.data){var Z=Math.ceil(Wi(Q.type,F)*z/Q.unpackAlignment)*Q.unpackAlignment;T(Q.data.byteLength===Z*q,"invalid data for image, buffer size is inconsistent with image format")}else Q.element||Q.copy}else a.genMipmaps||T((f.mipmask&1<<C)==0,"extra mipmap data");f.compressed&&T(!a.genMipmaps,"mipmap generation for compressed images not supported")}function Qs(a,f,p,C){var M=a.width,L=a.height,F=a.channels;T(M>0&&M<=C.maxTextureSize&&L>0&&L<=C.maxTextureSize,"invalid texture shape"),T(M===L,"cube map must be square"),T(f.wrapS===Sr&&f.wrapT===Sr,"wrap mode not supported by cube map");for(var H=0;H<p.length;++H){var z=p[H];T(z.width===M&&z.height===L,"inconsistent cube map face shape"),f.genMipmaps&&(T(!z.compressed,"can not generate mipmap for compressed textures"),T(z.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var q=z.images,Q=0;Q<16;++Q){var Z=q[Q];if(Z){var J=M>>Q,V=L>>Q;T(z.mipmask&1<<Q,"missing mipmap data"),T(Z.width===J&&Z.height===V,"invalid shape for mip images"),T(Z.format===a.format&&Z.internalformat===a.internalformat&&Z.type===a.type,"incompatible type for mip image"),Z.compressed||(Z.data?T(Z.data.byteLength===J*V*Math.max(Wi(Z.type,F),Z.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Z.element||Z.copy)}}}}var s=n(T,{optional:Ta,raise:b,commandRaise:Zt,command:Ft,parameter:j,commandParameter:Ar,constructor:Ye,type:ve,commandType:Ln,isTypedArray:le,nni:oe,oneOf:$e,shaderError:ir,linkError:or,callSite:Ze,saveCommandRef:wr,saveDrawInfo:Xr,framebufferFormat:wa,guessCommand:qe,texture2D:Zs,textureCube:Qs}),Ks=0,Js=0,eu=5,tu=6;function fr(a,f){this.id=Ks++,this.type=a,this.data=f}function Yi(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Wr(a){if(a.length===0)return[];var f=a.charAt(0),p=a.charAt(a.length-1);if(a.length>1&&f===p&&(f==='"'||f==="'"))return['"'+Yi(a.substr(1,a.length-2))+'"'];var C=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a);if(C)return Wr(a.substr(0,C.index)).concat(Wr(C[1])).concat(Wr(a.substr(C.index+C[0].length)));var M=a.split(".");if(M.length===1)return['"'+Yi(a)+'"'];for(var L=[],F=0;F<M.length;++F)L=L.concat(Wr(M[F]));return L}function qi(a){return"["+Wr(a).join("][")+"]"}function ru(a,f){return new fr(a,qi(f+""))}function nu(a){return typeof a=="function"&&!a._reglType||a instanceof fr}function Zi(a,f){if(typeof a=="function")return new fr(Js,a);if(typeof a=="number"||typeof a=="boolean")return new fr(eu,a);if(Array.isArray(a))return new fr(tu,a.map(function(p,C){return Zi(p,f+"["+C+"]")}));if(a instanceof fr)return a;s(!1,"invalid option type in uniform "+f)}var kt={DynamicVariable:fr,define:ru,isDynamic:nu,unbox:Zi,accessor:qi},Da={next:typeof requestAnimationFrame=="function"?function(a){return requestAnimationFrame(a)}:function(a){return setTimeout(a,16)},cancel:typeof cancelAnimationFrame=="function"?function(a){return cancelAnimationFrame(a)}:clearTimeout},Qi=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function au(){var a={"":0},f=[""];return{id:function(p){var C=a[p];return C||(C=a[p]=f.length,f.push(p),C)},str:function(p){return f[p]}}}function iu(a,f,p){var C=document.createElement("canvas");n(C.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),a.appendChild(C),a===document.body&&(C.style.position="absolute",n(a.style,{margin:0,padding:0}));function M(){var H=window.innerWidth,z=window.innerHeight;if(a!==document.body){var q=C.getBoundingClientRect();H=q.right-q.left,z=q.bottom-q.top}C.width=p*H,C.height=p*z}var L;a!==document.body&&typeof ResizeObserver=="function"?(L=new ResizeObserver(function(){setTimeout(M)}),L.observe(a)):window.addEventListener("resize",M,!1);function F(){L?L.disconnect():window.removeEventListener("resize",M),a.removeChild(C)}return M(),{canvas:C,onDestroy:F}}function ou(a,f){function p(C){try{return a.getContext(C,f)}catch{return null}}return p("webgl")||p("experimental-webgl")||p("webgl-experimental")}function fu(a){return typeof a.nodeName=="string"&&typeof a.appendChild=="function"&&typeof a.getBoundingClientRect=="function"}function su(a){return typeof a.drawArrays=="function"||typeof a.drawElements=="function"}function Ki(a){return typeof a=="string"?a.split():(s(Array.isArray(a),"invalid extension array"),a)}function Ji(a){return typeof a=="string"?(s(typeof document!="undefined","not supported outside of DOM"),document.querySelector(a)):a}function uu(a){var f=a||{},p,C,M,L,F={},H=[],z=[],q=typeof window=="undefined"?1:window.devicePixelRatio,Q=!1,Z=function(Y){Y&&s.raise(Y)},J=function(){};if(typeof f=="string"?(s(typeof document!="undefined","selector queries only supported in DOM enviroments"),p=document.querySelector(f),s(p,"invalid query string for element")):typeof f=="object"?fu(f)?p=f:su(f)?(L=f,M=L.canvas):(s.constructor(f),"gl"in f?L=f.gl:"canvas"in f?M=Ji(f.canvas):"container"in f&&(C=Ji(f.container)),"attributes"in f&&(F=f.attributes,s.type(F,"object","invalid context attributes")),"extensions"in f&&(H=Ki(f.extensions)),"optionalExtensions"in f&&(z=Ki(f.optionalExtensions)),"onDone"in f&&(s.type(f.onDone,"function","invalid or missing onDone callback"),Z=f.onDone),"profile"in f&&(Q=!!f.profile),"pixelRatio"in f&&(q=+f.pixelRatio,s(q>0,"invalid pixel ratio"))):s.raise("invalid arguments to regl"),p&&(p.nodeName.toLowerCase()==="canvas"?M=p:C=p),!L){if(!M){s(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var V=iu(C||document.body,Z,q);if(!V)return null;M=V.canvas,J=V.onDestroy}F.premultipliedAlpha===void 0&&(F.premultipliedAlpha=!0),L=ou(M,F)}return L?{gl:L,canvas:M,container:C,extensions:H,optionalExtensions:z,pixelRatio:q,profile:Q,onDone:Z,onDestroy:J}:(J(),Z("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function lu(a,f){var p={};function C(F){s.type(F,"string","extension name must be string");var H=F.toLowerCase(),z;try{z=p[H]=a.getExtension(H)}catch{}return!!z}for(var M=0;M<f.extensions.length;++M){var L=f.extensions[M];if(!C(L))return f.onDestroy(),f.onDone('"'+L+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return f.optionalExtensions.forEach(C),{extensions:p,restore:function(){Object.keys(p).forEach(function(F){if(p[F]&&!C(F))throw new Error("(regl): error restoring extension "+F)})}}}function Lt(a,f){for(var p=Array(a),C=0;C<a;++C)p[C]=f(C);return p}var cu=5120,du=5121,hu=5122,mu=5123,pu=5124,vu=5125,bu=5126;function _u(a){for(var f=16;f<=1<<28;f*=16)if(a<=f)return f;return 0}function eo(a){var f,p;return f=(a>65535)<<4,a>>>=f,p=(a>255)<<3,a>>>=p,f|=p,p=(a>15)<<2,a>>>=p,f|=p,p=(a>3)<<1,a>>>=p,f|=p,f|a>>1}function to(){var a=Lt(8,function(){return[]});function f(L){var F=_u(L),H=a[eo(F)>>2];return H.length>0?H.pop():new ArrayBuffer(F)}function p(L){a[eo(L.byteLength)>>2].push(L)}function C(L,F){var H=null;switch(L){case cu:H=new Int8Array(f(F),0,F);break;case du:H=new Uint8Array(f(F),0,F);break;case hu:H=new Int16Array(f(2*F),0,F);break;case mu:H=new Uint16Array(f(2*F),0,F);break;case pu:H=new Int32Array(f(4*F),0,F);break;case vu:H=new Uint32Array(f(4*F),0,F);break;case bu:H=new Float32Array(f(4*F),0,F);break;default:return null}return H.length!==F?H.subarray(0,F):H}function M(L){p(L.buffer)}return{alloc:f,free:p,allocType:C,freeType:M}}var it=to();it.zero=to();var yu=3408,gu=3410,xu=3411,Eu=3412,Tu=3413,wu=3414,Au=3415,Su=33901,ku=33902,Lu=3379,Cu=3386,Ru=34921,Ou=36347,Du=36348,Fu=35661,Gu=35660,Iu=34930,Nu=36349,Mu=34076,Bu=34024,Pu=7936,Uu=7937,$u=7938,zu=35724,Hu=34047,ju=36063,Vu=34852,On=3553,ro=34067,Xu=34069,Wu=33984,Yr=6408,Fa=5126,no=5121,Ga=36160,Yu=36053,qu=36064,Zu=16384,Qu=function(a,f){var p=1;f.ext_texture_filter_anisotropic&&(p=a.getParameter(Hu));var C=1,M=1;f.webgl_draw_buffers&&(C=a.getParameter(Vu),M=a.getParameter(ju));var L=!!f.oes_texture_float;if(L){var F=a.createTexture();a.bindTexture(On,F),a.texImage2D(On,0,Yr,1,1,0,Yr,Fa,null);var H=a.createFramebuffer();if(a.bindFramebuffer(Ga,H),a.framebufferTexture2D(Ga,qu,On,F,0),a.bindTexture(On,null),a.checkFramebufferStatus(Ga)!==Yu)L=!1;else{a.viewport(0,0,1,1),a.clearColor(1,0,0,1),a.clear(Zu);var z=it.allocType(Fa,4);a.readPixels(0,0,1,1,Yr,Fa,z),a.getError()?L=!1:(a.deleteFramebuffer(H),a.deleteTexture(F),L=z[0]===1),it.freeType(z)}}var q=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Q=!0;if(!q){var Z=a.createTexture(),J=it.allocType(no,36);a.activeTexture(Wu),a.bindTexture(ro,Z),a.texImage2D(Xu,0,Yr,3,3,0,Yr,no,J),it.freeType(J),a.bindTexture(ro,null),a.deleteTexture(Z),Q=!a.getError()}return{colorBits:[a.getParameter(gu),a.getParameter(xu),a.getParameter(Eu),a.getParameter(Tu)],depthBits:a.getParameter(wu),stencilBits:a.getParameter(Au),subpixelBits:a.getParameter(yu),extensions:Object.keys(f).filter(function(V){return!!f[V]}),maxAnisotropic:p,maxDrawbuffers:C,maxColorAttachments:M,pointSizeDims:a.getParameter(Su),lineWidthDims:a.getParameter(ku),maxViewportDims:a.getParameter(Cu),maxCombinedTextureUnits:a.getParameter(Fu),maxCubeMapSize:a.getParameter(Mu),maxRenderbufferSize:a.getParameter(Bu),maxTextureUnits:a.getParameter(Iu),maxTextureSize:a.getParameter(Lu),maxAttributes:a.getParameter(Ru),maxVertexUniforms:a.getParameter(Ou),maxVertexTextureUnits:a.getParameter(Gu),maxVaryingVectors:a.getParameter(Du),maxFragmentUniforms:a.getParameter(Nu),glsl:a.getParameter(zu),renderer:a.getParameter(Uu),vendor:a.getParameter(Pu),version:a.getParameter($u),readFloat:L,npotTextureCube:Q}};function Gt(a){return!!a&&typeof a=="object"&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&typeof a.offset=="number"&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||r(a.data))}var Ct=function(a){return Object.keys(a).map(function(f){return a[f]})},Dn={shape:tl,flatten:el};function Ku(a,f,p){for(var C=0;C<f;++C)p[C]=a[C]}function Ju(a,f,p,C){for(var M=0,L=0;L<f;++L)for(var F=a[L],H=0;H<p;++H)C[M++]=F[H]}function ao(a,f,p,C,M,L){for(var F=L,H=0;H<f;++H)for(var z=a[H],q=0;q<p;++q)for(var Q=z[q],Z=0;Z<C;++Z)M[F++]=Q[Z]}function io(a,f,p,C,M){for(var L=1,F=p+1;F<f.length;++F)L*=f[F];var H=f[p];if(f.length-p==4){var z=f[p+1],q=f[p+2],Q=f[p+3];for(F=0;F<H;++F)ao(a[F],z,q,Q,C,M),M+=L}else for(F=0;F<H;++F)io(a[F],f,p+1,C,M),M+=L}function el(a,f,p,C){var M=1;if(f.length)for(var L=0;L<f.length;++L)M*=f[L];else M=0;var F=C||it.allocType(p,M);switch(f.length){case 0:break;case 1:Ku(a,f[0],F);break;case 2:Ju(a,f[0],f[1],F);break;case 3:ao(a,f[0],f[1],f[2],F,0);break;default:io(a,f,0,F,0)}return F}function tl(a){for(var f=[],p=a;p.length;p=p[0])f.push(p.length);return f}var Ia={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},rl=5120,nl=5122,al=5124,il=5121,ol=5123,fl=5125,sl=5126,ul=5126,sr={int8:rl,int16:nl,int32:al,uint8:il,uint16:ol,uint32:fl,float:sl,float32:ul},ll=35048,cl=35040,Fn={dynamic:ll,stream:cl,static:35044},Na=Dn.flatten,oo=Dn.shape,fo=35044,dl=35040,Ma=5121,Ba=5126,Qt=[];Qt[5120]=1,Qt[5122]=2,Qt[5124]=4,Qt[5121]=1,Qt[5123]=2,Qt[5125]=4,Qt[5126]=4;function Gn(a){return Ia[Object.prototype.toString.call(a)]|0}function so(a,f){for(var p=0;p<f.length;++p)a[p]=f[p]}function uo(a,f,p,C,M,L,F){for(var H=0,z=0;z<p;++z)for(var q=0;q<C;++q)a[H++]=f[M*z+L*q+F]}function hl(a,f,p,C){var M=0,L={};function F(E){this.id=M++,this.buffer=a.createBuffer(),this.type=E,this.usage=fo,this.byteLength=0,this.dimension=1,this.dtype=Ma,this.persistentData=null,p.profile&&(this.stats={size:0})}F.prototype.bind=function(){a.bindBuffer(this.type,this.buffer)},F.prototype.destroy=function(){J(this)};var H=[];function z(E,O){var W=H.pop();return W||(W=new F(E)),W.bind(),Z(W,O,dl,0,1,!1),W}function q(E){H.push(E)}function Q(E,O,W){E.byteLength=O.byteLength,a.bufferData(E.type,O,W)}function Z(E,O,W,ue,$,fe){var ae;if(E.usage=W,Array.isArray(O)){if(E.dtype=ue||Ba,O.length>0){var ye;if(Array.isArray(O[0])){ae=oo(O);for(var B=1,N=1;N<ae.length;++N)B*=ae[N];E.dimension=B,ye=Na(O,ae,E.dtype),Q(E,ye,W),fe?E.persistentData=ye:it.freeType(ye)}else if(typeof O[0]=="number"){E.dimension=$;var he=it.allocType(E.dtype,O.length);so(he,O),Q(E,he,W),fe?E.persistentData=he:it.freeType(he)}else r(O[0])?(E.dimension=O[0].length,E.dtype=ue||Gn(O[0])||Ba,ye=Na(O,[O.length,O[0].length],E.dtype),Q(E,ye,W),fe?E.persistentData=ye:it.freeType(ye)):s.raise("invalid buffer data")}}else if(r(O))E.dtype=ue||Gn(O),E.dimension=$,Q(E,O,W),fe&&(E.persistentData=new Uint8Array(new Uint8Array(O.buffer)));else if(Gt(O)){ae=O.shape;var ee=O.stride,X=O.offset,te=0,re=0,Ce=0,Le=0;ae.length===1?(te=ae[0],re=1,Ce=ee[0],Le=0):ae.length===2?(te=ae[0],re=ae[1],Ce=ee[0],Le=ee[1]):s.raise("invalid shape"),E.dtype=ue||Gn(O.data)||Ba,E.dimension=re;var ie=it.allocType(E.dtype,te*re);uo(ie,O.data,te,re,Ce,Le,X),Q(E,ie,W),fe?E.persistentData=ie:it.freeType(ie)}else O instanceof ArrayBuffer?(E.dtype=Ma,E.dimension=$,Q(E,O,W),fe&&(E.persistentData=new Uint8Array(new Uint8Array(O)))):s.raise("invalid buffer data")}function J(E){f.bufferCount--,C(E);var O=E.buffer;s(O,"buffer must not be deleted already"),a.deleteBuffer(O),E.buffer=null,delete L[E.id]}function V(E,O,W,ue){f.bufferCount++;var $=new F(O);L[$.id]=$;function fe(B){var N=fo,he=null,ee=0,X=0,te=1;return Array.isArray(B)||r(B)||Gt(B)||B instanceof ArrayBuffer?he=B:typeof B=="number"?ee=B|0:B&&(s.type(B,"object","buffer arguments must be an object, a number or an array"),"data"in B&&(s(he===null||Array.isArray(he)||r(he)||Gt(he),"invalid data for buffer"),he=B.data),"usage"in B&&(s.parameter(B.usage,Fn,"invalid buffer usage"),N=Fn[B.usage]),"type"in B&&(s.parameter(B.type,sr,"invalid buffer type"),X=sr[B.type]),"dimension"in B&&(s.type(B.dimension,"number","invalid dimension"),te=B.dimension|0),"length"in B&&(s.nni(ee,"buffer length must be a nonnegative integer"),ee=B.length|0)),$.bind(),he?Z($,he,N,X,te,ue):(ee&&a.bufferData($.type,ee,N),$.dtype=X||Ma,$.usage=N,$.dimension=te,$.byteLength=ee),p.profile&&($.stats.size=$.byteLength*Qt[$.dtype]),fe}function ae(B,N){s(N+B.byteLength<=$.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+B.byteLength+" starting from offset "+N+" to a buffer of size "+$.byteLength),a.bufferSubData($.type,N,B)}function ye(B,N){var he=(N||0)|0,ee;if($.bind(),r(B)||B instanceof ArrayBuffer)ae(B,he);else if(Array.isArray(B)){if(B.length>0)if(typeof B[0]=="number"){var X=it.allocType($.dtype,B.length);so(X,B),ae(X,he),it.freeType(X)}else if(Array.isArray(B[0])||r(B[0])){ee=oo(B);var te=Na(B,ee,$.dtype);ae(te,he),it.freeType(te)}else s.raise("invalid buffer data")}else if(Gt(B)){ee=B.shape;var re=B.stride,Ce=0,Le=0,ie=0,se=0;ee.length===1?(Ce=ee[0],Le=1,ie=re[0],se=0):ee.length===2?(Ce=ee[0],Le=ee[1],ie=re[0],se=re[1]):s.raise("invalid shape");var Ae=Array.isArray(B.data)?$.dtype:Gn(B.data),Re=it.allocType(Ae,Ce*Le);uo(Re,B.data,Ce,Le,ie,se,B.offset),ae(Re,he),it.freeType(Re)}else s.raise("invalid data for buffer subdata");return fe}return W||fe(E),fe._reglType="buffer",fe._buffer=$,fe.subdata=ye,p.profile&&(fe.stats=$.stats),fe.destroy=function(){J($)},fe}function Y(){Ct(L).forEach(function(E){E.buffer=a.createBuffer(),a.bindBuffer(E.type,E.buffer),a.bufferData(E.type,E.persistentData||E.byteLength,E.usage)})}return p.profile&&(f.getTotalBufferSize=function(){var E=0;return Object.keys(L).forEach(function(O){E+=L[O].stats.size}),E}),{create:V,createStream:z,destroyStream:q,clear:function(){Ct(L).forEach(J),H.forEach(J)},getBuffer:function(E){return E&&E._buffer instanceof F?E._buffer:null},restore:Y,_initBuffer:Z}}var ml=0,pl=0,vl=1,bl=1,_l=4,yl=4,Kt={points:ml,point:pl,lines:vl,line:bl,triangles:_l,triangle:yl,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},gl=0,xl=1,qr=4,El=5120,kr=5121,lo=5122,Lr=5123,co=5124,ur=5125,Pa=34963,Tl=35040,wl=35044;function Al(a,f,p,C){var M={},L=0,F={uint8:kr,uint16:Lr};f.oes_element_index_uint&&(F.uint32=ur);function H(Y){this.id=L++,M[this.id]=this,this.buffer=Y,this.primType=qr,this.vertCount=0,this.type=0}H.prototype.bind=function(){this.buffer.bind()};var z=[];function q(Y){var E=z.pop();return E||(E=new H(p.create(null,Pa,!0,!1)._buffer)),Z(E,Y,Tl,-1,-1,0,0),E}function Q(Y){z.push(Y)}function Z(Y,E,O,W,ue,$,fe){Y.buffer.bind();var ae;if(E){var ye=fe;!fe&&(!r(E)||Gt(E)&&!r(E.data))&&(ye=f.oes_element_index_uint?ur:Lr),p._initBuffer(Y.buffer,E,O,ye,3)}else a.bufferData(Pa,$,O),Y.buffer.dtype=ae||kr,Y.buffer.usage=O,Y.buffer.dimension=3,Y.buffer.byteLength=$;if(ae=fe,!fe){switch(Y.buffer.dtype){case kr:case El:ae=kr;break;case Lr:case lo:ae=Lr;break;case ur:case co:ae=ur;break;default:s.raise("unsupported type for element array")}Y.buffer.dtype=ae}Y.type=ae,s(ae!==ur||!!f.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var B=ue;B<0&&(B=Y.buffer.byteLength,ae===Lr?B>>=1:ae===ur&&(B>>=2)),Y.vertCount=B;var N=W;if(W<0){N=qr;var he=Y.buffer.dimension;he===1&&(N=gl),he===2&&(N=xl),he===3&&(N=qr)}Y.primType=N}function J(Y){C.elementsCount--,s(Y.buffer!==null,"must not double destroy elements"),delete M[Y.id],Y.buffer.destroy(),Y.buffer=null}function V(Y,E){var O=p.create(null,Pa,!0),W=new H(O._buffer);C.elementsCount++;function ue($){if(!$)O(),W.primType=qr,W.vertCount=0,W.type=kr;else if(typeof $=="number")O($),W.primType=qr,W.vertCount=$|0,W.type=kr;else{var fe=null,ae=wl,ye=-1,B=-1,N=0,he=0;Array.isArray($)||r($)||Gt($)?fe=$:(s.type($,"object","invalid arguments for elements"),"data"in $&&(fe=$.data,s(Array.isArray(fe)||r(fe)||Gt(fe),"invalid data for element buffer")),"usage"in $&&(s.parameter($.usage,Fn,"invalid element buffer usage"),ae=Fn[$.usage]),"primitive"in $&&(s.parameter($.primitive,Kt,"invalid element buffer primitive"),ye=Kt[$.primitive]),"count"in $&&(s(typeof $.count=="number"&&$.count>=0,"invalid vertex count for elements"),B=$.count|0),"type"in $&&(s.parameter($.type,F,"invalid buffer type"),he=F[$.type]),"length"in $?N=$.length|0:(N=B,he===Lr||he===lo?N*=2:(he===ur||he===co)&&(N*=4))),Z(W,fe,ae,ye,B,N,he)}return ue}return ue(Y),ue._reglType="elements",ue._elements=W,ue.subdata=function($,fe){return O.subdata($,fe),ue},ue.destroy=function(){J(W)},ue}return{create:V,createStream:q,destroyStream:Q,getElements:function(Y){return typeof Y=="function"&&Y._elements instanceof H?Y._elements:null},clear:function(){Ct(M).forEach(J)}}}var ho=new Float32Array(1),Sl=new Uint32Array(ho.buffer),kl=5123;function mo(a){for(var f=it.allocType(kl,a.length),p=0;p<a.length;++p)if(isNaN(a[p]))f[p]=65535;else if(a[p]===1/0)f[p]=31744;else if(a[p]===-1/0)f[p]=64512;else{ho[0]=a[p];var C=Sl[0],M=C>>>31<<15,L=(C<<1>>>24)-127,F=C>>13&(1<<10)-1;if(L<-24)f[p]=M;else if(L<-14){var H=-14-L;f[p]=M+(F+(1<<10)>>H)}else L>15?f[p]=M+31744:f[p]=M+(L+15<<10)+F}return f}function et(a){return Array.isArray(a)||r(a)}var po=function(a){return!(a&a-1)&&!!a},Ll=34467,Bt=3553,Ua=34067,In=34069,lr=6408,$a=6406,Nn=6407,Zr=6409,Mn=6410,vo=32854,za=32855,bo=36194,Cl=32819,Rl=32820,Ol=33635,Dl=34042,Ha=6402,Bn=34041,ja=35904,Va=35906,Cr=36193,Xa=33776,Wa=33777,Ya=33778,qa=33779,_o=35986,yo=35987,go=34798,xo=35840,Eo=35841,To=35842,wo=35843,Ao=36196,Rr=5121,Za=5123,Qa=5125,Qr=5126,Fl=10242,Gl=10243,Il=10497,Ka=33071,Nl=33648,Ml=10240,Bl=10241,Ja=9728,Pl=9729,ei=9984,So=9985,ko=9986,ti=9987,Ul=33170,Pn=4352,$l=4353,zl=4354,Hl=34046,jl=3317,Vl=37440,Xl=37441,Wl=37443,Lo=37444,Kr=33984,Yl=[ei,ko,So,ti],Un=[0,Zr,Mn,Nn,lr],Ot={};Ot[Zr]=Ot[$a]=Ot[Ha]=1,Ot[Bn]=Ot[Mn]=2,Ot[Nn]=Ot[ja]=3,Ot[lr]=Ot[Va]=4;function Or(a){return"[object "+a+"]"}var Co=Or("HTMLCanvasElement"),Ro=Or("OffscreenCanvas"),Oo=Or("CanvasRenderingContext2D"),Do=Or("ImageBitmap"),Fo=Or("HTMLImageElement"),Go=Or("HTMLVideoElement"),ql=Object.keys(Ia).concat([Co,Ro,Oo,Do,Fo,Go]),Dr=[];Dr[Rr]=1,Dr[Qr]=4,Dr[Cr]=2,Dr[Za]=2,Dr[Qa]=4;var ht=[];ht[vo]=2,ht[za]=2,ht[bo]=2,ht[Bn]=4,ht[Xa]=.5,ht[Wa]=.5,ht[Ya]=1,ht[qa]=1,ht[_o]=.5,ht[yo]=1,ht[go]=1,ht[xo]=.5,ht[Eo]=.25,ht[To]=.5,ht[wo]=.25,ht[Ao]=.5;function Io(a){return Array.isArray(a)&&(a.length===0||typeof a[0]=="number")}function No(a){if(!Array.isArray(a))return!1;var f=a.length;return!(f===0||!et(a[0]))}function cr(a){return Object.prototype.toString.call(a)}function Mo(a){return cr(a)===Co}function Bo(a){return cr(a)===Ro}function Zl(a){return cr(a)===Oo}function Ql(a){return cr(a)===Do}function Kl(a){return cr(a)===Fo}function Jl(a){return cr(a)===Go}function ri(a){if(!a)return!1;var f=cr(a);return ql.indexOf(f)>=0?!0:Io(a)||No(a)||Gt(a)}function Po(a){return Ia[Object.prototype.toString.call(a)]|0}function ec(a,f){var p=f.length;switch(a.type){case Rr:case Za:case Qa:case Qr:var C=it.allocType(a.type,p);C.set(f),a.data=C;break;case Cr:a.data=mo(f);break;default:s.raise("unsupported texture type, must specify a typed array")}}function Uo(a,f){return it.allocType(a.type===Cr?Qr:a.type,f)}function $o(a,f){a.type===Cr?(a.data=mo(f),it.freeType(f)):a.data=f}function tc(a,f,p,C,M,L){for(var F=a.width,H=a.height,z=a.channels,q=F*H*z,Q=Uo(a,q),Z=0,J=0;J<H;++J)for(var V=0;V<F;++V)for(var Y=0;Y<z;++Y)Q[Z++]=f[p*V+C*J+M*Y+L];$o(a,Q)}function $n(a,f,p,C,M,L){var F;if(typeof ht[a]!="undefined"?F=ht[a]:F=Ot[a]*Dr[f],L&&(F*=6),M){for(var H=0,z=p;z>=1;)H+=F*z*z,z/=2;return H}else return F*p*C}function rc(a,f,p,C,M,L,F){var H={"don't care":Pn,"dont care":Pn,nice:zl,fast:$l},z={repeat:Il,clamp:Ka,mirror:Nl},q={nearest:Ja,linear:Pl},Q=n({mipmap:ti,"nearest mipmap nearest":ei,"linear mipmap nearest":So,"nearest mipmap linear":ko,"linear mipmap linear":ti},q),Z={none:0,browser:Lo},J={uint8:Rr,rgba4:Cl,rgb565:Ol,"rgb5 a1":Rl},V={alpha:$a,luminance:Zr,"luminance alpha":Mn,rgb:Nn,rgba:lr,rgba4:vo,"rgb5 a1":za,rgb565:bo},Y={};f.ext_srgb&&(V.srgb=ja,V.srgba=Va),f.oes_texture_float&&(J.float32=J.float=Qr),f.oes_texture_half_float&&(J.float16=J["half float"]=Cr),f.webgl_depth_texture&&(n(V,{depth:Ha,"depth stencil":Bn}),n(J,{uint16:Za,uint32:Qa,"depth stencil":Dl})),f.webgl_compressed_texture_s3tc&&n(Y,{"rgb s3tc dxt1":Xa,"rgba s3tc dxt1":Wa,"rgba s3tc dxt3":Ya,"rgba s3tc dxt5":qa}),f.webgl_compressed_texture_atc&&n(Y,{"rgb atc":_o,"rgba atc explicit alpha":yo,"rgba atc interpolated alpha":go}),f.webgl_compressed_texture_pvrtc&&n(Y,{"rgb pvrtc 4bppv1":xo,"rgb pvrtc 2bppv1":Eo,"rgba pvrtc 4bppv1":To,"rgba pvrtc 2bppv1":wo}),f.webgl_compressed_texture_etc1&&(Y["rgb etc1"]=Ao);var E=Array.prototype.slice.call(a.getParameter(Ll));Object.keys(Y).forEach(function(h){var R=Y[h];E.indexOf(R)>=0&&(V[h]=R)});var O=Object.keys(V);p.textureFormats=O;var W=[];Object.keys(V).forEach(function(h){var R=V[h];W[R]=h});var ue=[];Object.keys(J).forEach(function(h){var R=J[h];ue[R]=h});var $=[];Object.keys(q).forEach(function(h){var R=q[h];$[R]=h});var fe=[];Object.keys(Q).forEach(function(h){var R=Q[h];fe[R]=h});var ae=[];Object.keys(z).forEach(function(h){var R=z[h];ae[R]=h});var ye=O.reduce(function(h,R){var k=V[R];return k===Zr||k===$a||k===Zr||k===Mn||k===Ha||k===Bn||f.ext_srgb&&(k===ja||k===Va)?h[k]=k:k===za||R.indexOf("rgba")>=0?h[k]=lr:h[k]=Nn,h},{});function B(){this.internalformat=lr,this.format=lr,this.type=Rr,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Lo,this.width=0,this.height=0,this.channels=0}function N(h,R){h.internalformat=R.internalformat,h.format=R.format,h.type=R.type,h.compressed=R.compressed,h.premultiplyAlpha=R.premultiplyAlpha,h.flipY=R.flipY,h.unpackAlignment=R.unpackAlignment,h.colorSpace=R.colorSpace,h.width=R.width,h.height=R.height,h.channels=R.channels}function he(h,R){if(!(typeof R!="object"||!R)){if("premultiplyAlpha"in R&&(s.type(R.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),h.premultiplyAlpha=R.premultiplyAlpha),"flipY"in R&&(s.type(R.flipY,"boolean","invalid texture flip"),h.flipY=R.flipY),"alignment"in R&&(s.oneOf(R.alignment,[1,2,4,8],"invalid texture unpack alignment"),h.unpackAlignment=R.alignment),"colorSpace"in R&&(s.parameter(R.colorSpace,Z,"invalid colorSpace"),h.colorSpace=Z[R.colorSpace]),"type"in R){var k=R.type;s(f.oes_texture_float||!(k==="float"||k==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),s(f.oes_texture_half_float||!(k==="half float"||k==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),s(f.webgl_depth_texture||!(k==="uint16"||k==="uint32"||k==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),s.parameter(k,J,"invalid texture type"),h.type=J[k]}var de=h.width,Ge=h.height,u=h.channels,i=!1;"shape"in R?(s(Array.isArray(R.shape)&&R.shape.length>=2,"shape must be an array"),de=R.shape[0],Ge=R.shape[1],R.shape.length===3&&(u=R.shape[2],s(u>0&&u<=4,"invalid number of channels"),i=!0),s(de>=0&&de<=p.maxTextureSize,"invalid width"),s(Ge>=0&&Ge<=p.maxTextureSize,"invalid height")):("radius"in R&&(de=Ge=R.radius,s(de>=0&&de<=p.maxTextureSize,"invalid radius")),"width"in R&&(de=R.width,s(de>=0&&de<=p.maxTextureSize,"invalid width")),"height"in R&&(Ge=R.height,s(Ge>=0&&Ge<=p.maxTextureSize,"invalid height")),"channels"in R&&(u=R.channels,s(u>0&&u<=4,"invalid number of channels"),i=!0)),h.width=de|0,h.height=Ge|0,h.channels=u|0;var v=!1;if("format"in R){var x=R.format;s(f.webgl_depth_texture||!(x==="depth"||x==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),s.parameter(x,V,"invalid texture format");var w=h.internalformat=V[x];h.format=ye[w],x in J&&("type"in R||(h.type=J[x])),x in Y&&(h.compressed=!0),v=!0}!i&&v?h.channels=Ot[h.format]:i&&!v?h.channels!==Un[h.format]&&(h.format=h.internalformat=Un[h.channels]):v&&i&&s(h.channels===Ot[h.format],"number of channels inconsistent with specified format")}}function ee(h){a.pixelStorei(Vl,h.flipY),a.pixelStorei(Xl,h.premultiplyAlpha),a.pixelStorei(Wl,h.colorSpace),a.pixelStorei(jl,h.unpackAlignment)}function X(){B.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function te(h,R){var k=null;if(ri(R)?k=R:R&&(s.type(R,"object","invalid pixel data type"),he(h,R),"x"in R&&(h.xOffset=R.x|0),"y"in R&&(h.yOffset=R.y|0),ri(R.data)&&(k=R.data)),s(!h.compressed||k instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),R.copy){s(!k,"can not specify copy and data field for the same texture");var de=M.viewportWidth,Ge=M.viewportHeight;h.width=h.width||de-h.xOffset,h.height=h.height||Ge-h.yOffset,h.needsCopy=!0,s(h.xOffset>=0&&h.xOffset<de&&h.yOffset>=0&&h.yOffset<Ge&&h.width>0&&h.width<=de&&h.height>0&&h.height<=Ge,"copy texture read out of bounds")}else if(!k)h.width=h.width||1,h.height=h.height||1,h.channels=h.channels||4;else if(r(k))h.channels=h.channels||4,h.data=k,!("type"in R)&&h.type===Rr&&(h.type=Po(k));else if(Io(k))h.channels=h.channels||4,ec(h,k),h.alignment=1,h.needsFree=!0;else if(Gt(k)){var u=k.data;!Array.isArray(u)&&h.type===Rr&&(h.type=Po(u));var i=k.shape,v=k.stride,x,w,y,_,g,c;i.length===3?(y=i[2],c=v[2]):(s(i.length===2,"invalid ndarray pixel data, must be 2 or 3D"),y=1,c=1),x=i[0],w=i[1],_=v[0],g=v[1],h.alignment=1,h.width=x,h.height=w,h.channels=y,h.format=h.internalformat=Un[y],h.needsFree=!0,tc(h,u,_,g,c,k.offset)}else if(Mo(k)||Bo(k)||Zl(k))Mo(k)||Bo(k)?h.element=k:h.element=k.canvas,h.width=h.element.width,h.height=h.element.height,h.channels=4;else if(Ql(k))h.element=k,h.width=k.width,h.height=k.height,h.channels=4;else if(Kl(k))h.element=k,h.width=k.naturalWidth,h.height=k.naturalHeight,h.channels=4;else if(Jl(k))h.element=k,h.width=k.videoWidth,h.height=k.videoHeight,h.channels=4;else if(No(k)){var m=h.width||k[0].length,d=h.height||k.length,S=h.channels;et(k[0][0])?S=S||k[0][0].length:S=S||1;for(var A=Dn.shape(k),I=1,P=0;P<A.length;++P)I*=A[P];var K=Uo(h,I);Dn.flatten(k,A,"",K),$o(h,K),h.alignment=1,h.width=m,h.height=d,h.channels=S,h.format=h.internalformat=Un[S],h.needsFree=!0}h.type===Qr?s(p.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):h.type===Cr&&s(p.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function re(h,R,k){var de=h.element,Ge=h.data,u=h.internalformat,i=h.format,v=h.type,x=h.width,w=h.height;ee(h),de?a.texImage2D(R,k,i,i,v,de):h.compressed?a.compressedTexImage2D(R,k,u,x,w,0,Ge):h.needsCopy?(C(),a.copyTexImage2D(R,k,i,h.xOffset,h.yOffset,x,w,0)):a.texImage2D(R,k,i,x,w,0,i,v,Ge||null)}function Ce(h,R,k,de,Ge){var u=h.element,i=h.data,v=h.internalformat,x=h.format,w=h.type,y=h.width,_=h.height;ee(h),u?a.texSubImage2D(R,Ge,k,de,x,w,u):h.compressed?a.compressedTexSubImage2D(R,Ge,k,de,v,y,_,i):h.needsCopy?(C(),a.copyTexSubImage2D(R,Ge,k,de,h.xOffset,h.yOffset,y,_)):a.texSubImage2D(R,Ge,k,de,y,_,x,w,i)}var Le=[];function ie(){return Le.pop()||new X}function se(h){h.needsFree&&it.freeType(h.data),X.call(h),Le.push(h)}function Ae(){B.call(this),this.genMipmaps=!1,this.mipmapHint=Pn,this.mipmask=0,this.images=Array(16)}function Re(h,R,k){var de=h.images[0]=ie();h.mipmask=1,de.width=h.width=R,de.height=h.height=k,de.channels=h.channels=4}function Ne(h,R){var k=null;if(ri(R))k=h.images[0]=ie(),N(k,h),te(k,R),h.mipmask=1;else if(he(h,R),Array.isArray(R.mipmap))for(var de=R.mipmap,Ge=0;Ge<de.length;++Ge)k=h.images[Ge]=ie(),N(k,h),k.width>>=Ge,k.height>>=Ge,te(k,de[Ge]),h.mipmask|=1<<Ge;else k=h.images[0]=ie(),N(k,h),te(k,R),h.mipmask=1;N(h,h.images[0]),h.compressed&&(h.internalformat===Xa||h.internalformat===Wa||h.internalformat===Ya||h.internalformat===qa)&&s(h.width%4==0&&h.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function tt(h,R){for(var k=h.images,de=0;de<k.length;++de){if(!k[de])return;re(k[de],R,de)}}var rt=[];function Be(){var h=rt.pop()||new Ae;B.call(h),h.mipmask=0;for(var R=0;R<16;++R)h.images[R]=null;return h}function st(h){for(var R=h.images,k=0;k<R.length;++k)R[k]&&se(R[k]),R[k]=null;rt.push(h)}function Ke(){this.minFilter=Ja,this.magFilter=Ja,this.wrapS=Ka,this.wrapT=Ka,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Pn}function ft(h,R){if("min"in R){var k=R.min;s.parameter(k,Q),h.minFilter=Q[k],Yl.indexOf(h.minFilter)>=0&&!("faces"in R)&&(h.genMipmaps=!0)}if("mag"in R){var de=R.mag;s.parameter(de,q),h.magFilter=q[de]}var Ge=h.wrapS,u=h.wrapT;if("wrap"in R){var i=R.wrap;typeof i=="string"?(s.parameter(i,z),Ge=u=z[i]):Array.isArray(i)&&(s.parameter(i[0],z),s.parameter(i[1],z),Ge=z[i[0]],u=z[i[1]])}else{if("wrapS"in R){var v=R.wrapS;s.parameter(v,z),Ge=z[v]}if("wrapT"in R){var x=R.wrapT;s.parameter(x,z),u=z[x]}}if(h.wrapS=Ge,h.wrapT=u,"anisotropic"in R){var w=R.anisotropic;s(typeof w=="number"&&w>=1&&w<=p.maxAnisotropic,"aniso samples must be between 1 and "),h.anisotropic=R.anisotropic}if("mipmap"in R){var y=!1;switch(typeof R.mipmap){case"string":s.parameter(R.mipmap,H,"invalid mipmap hint"),h.mipmapHint=H[R.mipmap],h.genMipmaps=!0,y=!0;break;case"boolean":y=h.genMipmaps=R.mipmap;break;case"object":s(Array.isArray(R.mipmap),"invalid mipmap type"),h.genMipmaps=!1,y=!0;break;default:s.raise("invalid mipmap type")}y&&!("min"in R)&&(h.minFilter=ei)}}function ut(h,R){a.texParameteri(R,Bl,h.minFilter),a.texParameteri(R,Ml,h.magFilter),a.texParameteri(R,Fl,h.wrapS),a.texParameteri(R,Gl,h.wrapT),f.ext_texture_filter_anisotropic&&a.texParameteri(R,Hl,h.anisotropic),h.genMipmaps&&(a.hint(Ul,h.mipmapHint),a.generateMipmap(R))}var lt=0,dt={},mt=p.maxTextureUnits,nt=Array(mt).map(function(){return null});function De(h){B.call(this),this.mipmask=0,this.internalformat=lr,this.id=lt++,this.refCount=1,this.target=h,this.texture=a.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ke,F.profile&&(this.stats={size:0})}function pt(h){a.activeTexture(Kr),a.bindTexture(h.target,h.texture)}function He(){var h=nt[0];h?a.bindTexture(h.target,h.texture):a.bindTexture(Bt,null)}function we(h){var R=h.texture;s(R,"must not double destroy texture");var k=h.unit,de=h.target;k>=0&&(a.activeTexture(Kr+k),a.bindTexture(de,null),nt[k]=null),a.deleteTexture(R),h.texture=null,h.params=null,h.pixels=null,h.refCount=0,delete dt[h.id],L.textureCount--}n(De.prototype,{bind:function(){var h=this;h.bindCount+=1;var R=h.unit;if(R<0){for(var k=0;k<mt;++k){var de=nt[k];if(de){if(de.bindCount>0)continue;de.unit=-1}nt[k]=h,R=k;break}R>=mt&&s.raise("insufficient number of texture units"),F.profile&&L.maxTextureUnits<R+1&&(L.maxTextureUnits=R+1),h.unit=R,a.activeTexture(Kr+R),a.bindTexture(h.target,h.texture)}return R},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&we(this)}});function Me(h,R){var k=new De(Bt);dt[k.id]=k,L.textureCount++;function de(i,v){var x=k.texInfo;Ke.call(x);var w=Be();return typeof i=="number"?typeof v=="number"?Re(w,i|0,v|0):Re(w,i|0,i|0):i?(s.type(i,"object","invalid arguments to regl.texture"),ft(x,i),Ne(w,i)):Re(w,1,1),x.genMipmaps&&(w.mipmask=(w.width<<1)-1),k.mipmask=w.mipmask,N(k,w),s.texture2D(x,w,p),k.internalformat=w.internalformat,de.width=w.width,de.height=w.height,pt(k),tt(w,Bt),ut(x,Bt),He(),st(w),F.profile&&(k.stats.size=$n(k.internalformat,k.type,w.width,w.height,x.genMipmaps,!1)),de.format=W[k.internalformat],de.type=ue[k.type],de.mag=$[x.magFilter],de.min=fe[x.minFilter],de.wrapS=ae[x.wrapS],de.wrapT=ae[x.wrapT],de}function Ge(i,v,x,w){s(!!i,"must specify image data");var y=v|0,_=x|0,g=w|0,c=ie();return N(c,k),c.width=0,c.height=0,te(c,i),c.width=c.width||(k.width>>g)-y,c.height=c.height||(k.height>>g)-_,s(k.type===c.type&&k.format===c.format&&k.internalformat===c.internalformat,"incompatible format for texture.subimage"),s(y>=0&&_>=0&&y+c.width<=k.width&&_+c.height<=k.height,"texture.subimage write out of bounds"),s(k.mipmask&1<<g,"missing mipmap data"),s(c.data||c.element||c.needsCopy,"missing image data"),pt(k),Ce(c,Bt,y,_,g),He(),se(c),de}function u(i,v){var x=i|0,w=v|0||x;if(x===k.width&&w===k.height)return de;de.width=k.width=x,de.height=k.height=w,pt(k);for(var y=0;k.mipmask>>y;++y){var _=x>>y,g=w>>y;if(!_||!g)break;a.texImage2D(Bt,y,k.format,_,g,0,k.format,k.type,null)}return He(),F.profile&&(k.stats.size=$n(k.internalformat,k.type,x,w,!1,!1)),de}return de(h,R),de.subimage=Ge,de.resize=u,de._reglType="texture2d",de._texture=k,F.profile&&(de.stats=k.stats),de.destroy=function(){k.decRef()},de}function Ue(h,R,k,de,Ge,u){var i=new De(Ua);dt[i.id]=i,L.cubeCount++;var v=new Array(6);function x(_,g,c,m,d,S){var A,I=i.texInfo;for(Ke.call(I),A=0;A<6;++A)v[A]=Be();if(typeof _=="number"||!_){var P=_|0||1;for(A=0;A<6;++A)Re(v[A],P,P)}else if(typeof _=="object")if(g)Ne(v[0],_),Ne(v[1],g),Ne(v[2],c),Ne(v[3],m),Ne(v[4],d),Ne(v[5],S);else if(ft(I,_),he(i,_),"faces"in _){var K=_.faces;for(s(Array.isArray(K)&&K.length===6,"cube faces must be a length 6 array"),A=0;A<6;++A)s(typeof K[A]=="object"&&!!K[A],"invalid input for cube map face"),N(v[A],i),Ne(v[A],K[A])}else for(A=0;A<6;++A)Ne(v[A],_);else s.raise("invalid arguments to cube map");for(N(i,v[0]),s.optional(function(){p.npotTextureCube||s(po(i.width)&&po(i.height),"your browser does not support non power or two texture dimensions")}),I.genMipmaps?i.mipmask=(v[0].width<<1)-1:i.mipmask=v[0].mipmask,s.textureCube(i,I,v,p),i.internalformat=v[0].internalformat,x.width=v[0].width,x.height=v[0].height,pt(i),A=0;A<6;++A)tt(v[A],In+A);for(ut(I,Ua),He(),F.profile&&(i.stats.size=$n(i.internalformat,i.type,x.width,x.height,I.genMipmaps,!0)),x.format=W[i.internalformat],x.type=ue[i.type],x.mag=$[I.magFilter],x.min=fe[I.minFilter],x.wrapS=ae[I.wrapS],x.wrapT=ae[I.wrapT],A=0;A<6;++A)st(v[A]);return x}function w(_,g,c,m,d){s(!!g,"must specify image data"),s(typeof _=="number"&&_===(_|0)&&_>=0&&_<6,"invalid face");var S=c|0,A=m|0,I=d|0,P=ie();return N(P,i),P.width=0,P.height=0,te(P,g),P.width=P.width||(i.width>>I)-S,P.height=P.height||(i.height>>I)-A,s(i.type===P.type&&i.format===P.format&&i.internalformat===P.internalformat,"incompatible format for texture.subimage"),s(S>=0&&A>=0&&S+P.width<=i.width&&A+P.height<=i.height,"texture.subimage write out of bounds"),s(i.mipmask&1<<I,"missing mipmap data"),s(P.data||P.element||P.needsCopy,"missing image data"),pt(i),Ce(P,In+_,S,A,I),He(),se(P),x}function y(_){var g=_|0;if(g!==i.width){x.width=i.width=g,x.height=i.height=g,pt(i);for(var c=0;c<6;++c)for(var m=0;i.mipmask>>m;++m)a.texImage2D(In+c,m,i.format,g>>m,g>>m,0,i.format,i.type,null);return He(),F.profile&&(i.stats.size=$n(i.internalformat,i.type,x.width,x.height,!1,!0)),x}}return x(h,R,k,de,Ge,u),x.subimage=w,x.resize=y,x._reglType="textureCube",x._texture=i,F.profile&&(x.stats=i.stats),x.destroy=function(){i.decRef()},x}function at(){for(var h=0;h<mt;++h)a.activeTexture(Kr+h),a.bindTexture(Bt,null),nt[h]=null;Ct(dt).forEach(we),L.cubeCount=0,L.textureCount=0}F.profile&&(L.getTotalTextureSize=function(){var h=0;return Object.keys(dt).forEach(function(R){h+=dt[R].stats.size}),h});function Ut(){for(var h=0;h<mt;++h){var R=nt[h];R&&(R.bindCount=0,R.unit=-1,nt[h]=null)}Ct(dt).forEach(function(k){k.texture=a.createTexture(),a.bindTexture(k.target,k.texture);for(var de=0;de<32;++de)if((k.mipmask&1<<de)!=0)if(k.target===Bt)a.texImage2D(Bt,de,k.internalformat,k.width>>de,k.height>>de,0,k.internalformat,k.type,null);else for(var Ge=0;Ge<6;++Ge)a.texImage2D(In+Ge,de,k.internalformat,k.width>>de,k.height>>de,0,k.internalformat,k.type,null);ut(k.texInfo,k.target)})}function _r(){for(var h=0;h<mt;++h){var R=nt[h];R&&(R.bindCount=0,R.unit=-1,nt[h]=null),a.activeTexture(Kr+h),a.bindTexture(Bt,null),a.bindTexture(Ua,null)}}return{create2D:Me,createCube:Ue,clear:at,getTexture:function(h){return null},restore:Ut,refresh:_r}}var Jt=36161,zn=32854,zo=32855,Ho=36194,jo=33189,Vo=36168,Xo=34041,Wo=35907,Yo=34836,qo=34842,Zo=34843,It=[];It[zn]=2,It[zo]=2,It[Ho]=2,It[jo]=2,It[Vo]=1,It[Xo]=4,It[Wo]=4,It[Yo]=16,It[qo]=8,It[Zo]=6;function Qo(a,f,p){return It[a]*f*p}var nc=function(a,f,p,C,M){var L={rgba4:zn,rgb565:Ho,"rgb5 a1":zo,depth:jo,stencil:Vo,"depth stencil":Xo};f.ext_srgb&&(L.srgba=Wo),f.ext_color_buffer_half_float&&(L.rgba16f=qo,L.rgb16f=Zo),f.webgl_color_buffer_float&&(L.rgba32f=Yo);var F=[];Object.keys(L).forEach(function(V){var Y=L[V];F[Y]=V});var H=0,z={};function q(V){this.id=H++,this.refCount=1,this.renderbuffer=V,this.format=zn,this.width=0,this.height=0,M.profile&&(this.stats={size:0})}q.prototype.decRef=function(){--this.refCount<=0&&Q(this)};function Q(V){var Y=V.renderbuffer;s(Y,"must not double destroy renderbuffer"),a.bindRenderbuffer(Jt,null),a.deleteRenderbuffer(Y),V.renderbuffer=null,V.refCount=0,delete z[V.id],C.renderbufferCount--}function Z(V,Y){var E=new q(a.createRenderbuffer());z[E.id]=E,C.renderbufferCount++;function O(ue,$){var fe=0,ae=0,ye=zn;if(typeof ue=="object"&&ue){var B=ue;if("shape"in B){var N=B.shape;s(Array.isArray(N)&&N.length>=2,"invalid renderbuffer shape"),fe=N[0]|0,ae=N[1]|0}else"radius"in B&&(fe=ae=B.radius|0),"width"in B&&(fe=B.width|0),"height"in B&&(ae=B.height|0);"format"in B&&(s.parameter(B.format,L,"invalid renderbuffer format"),ye=L[B.format])}else typeof ue=="number"?(fe=ue|0,typeof $=="number"?ae=$|0:ae=fe):ue?s.raise("invalid arguments to renderbuffer constructor"):fe=ae=1;if(s(fe>0&&ae>0&&fe<=p.maxRenderbufferSize&&ae<=p.maxRenderbufferSize,"invalid renderbuffer size"),!(fe===E.width&&ae===E.height&&ye===E.format))return O.width=E.width=fe,O.height=E.height=ae,E.format=ye,a.bindRenderbuffer(Jt,E.renderbuffer),a.renderbufferStorage(Jt,ye,fe,ae),s(a.getError()===0,"invalid render buffer format"),M.profile&&(E.stats.size=Qo(E.format,E.width,E.height)),O.format=F[E.format],O}function W(ue,$){var fe=ue|0,ae=$|0||fe;return fe===E.width&&ae===E.height||(s(fe>0&&ae>0&&fe<=p.maxRenderbufferSize&&ae<=p.maxRenderbufferSize,"invalid renderbuffer size"),O.width=E.width=fe,O.height=E.height=ae,a.bindRenderbuffer(Jt,E.renderbuffer),a.renderbufferStorage(Jt,E.format,fe,ae),s(a.getError()===0,"invalid render buffer format"),M.profile&&(E.stats.size=Qo(E.format,E.width,E.height))),O}return O(V,Y),O.resize=W,O._reglType="renderbuffer",O._renderbuffer=E,M.profile&&(O.stats=E.stats),O.destroy=function(){E.decRef()},O}M.profile&&(C.getTotalRenderbufferSize=function(){var V=0;return Object.keys(z).forEach(function(Y){V+=z[Y].stats.size}),V});function J(){Ct(z).forEach(function(V){V.renderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(Jt,V.renderbuffer),a.renderbufferStorage(Jt,V.format,V.width,V.height)}),a.bindRenderbuffer(Jt,null)}return{create:Z,clear:function(){Ct(z).forEach(Q)},restore:J}},Ht=36160,ni=36161,dr=3553,Hn=34069,Ko=36064,Jo=36096,ef=36128,tf=33306,rf=36053,ac=36054,ic=36055,oc=36057,fc=36061,sc=36193,uc=5121,lc=5126,nf=6407,af=6408,cc=6402,dc=[nf,af],ai=[];ai[af]=4,ai[nf]=3;var jn=[];jn[uc]=1,jn[lc]=4,jn[sc]=2;var hc=32854,mc=32855,pc=36194,vc=33189,bc=36168,of=34041,_c=35907,yc=34836,gc=34842,xc=34843,Ec=[hc,mc,pc,_c,gc,xc,yc],Fr={};Fr[rf]="complete",Fr[ac]="incomplete attachment",Fr[oc]="incomplete dimensions",Fr[ic]="incomplete, missing attachment",Fr[fc]="unsupported";function Tc(a,f,p,C,M,L){var F={cur:null,next:null,dirty:!1,setFBO:null},H=["rgba"],z=["rgba4","rgb565","rgb5 a1"];f.ext_srgb&&z.push("srgba"),f.ext_color_buffer_half_float&&z.push("rgba16f","rgb16f"),f.webgl_color_buffer_float&&z.push("rgba32f");var q=["uint8"];f.oes_texture_half_float&&q.push("half float","float16"),f.oes_texture_float&&q.push("float","float32");function Q(X,te,re){this.target=X,this.texture=te,this.renderbuffer=re;var Ce=0,Le=0;te?(Ce=te.width,Le=te.height):re&&(Ce=re.width,Le=re.height),this.width=Ce,this.height=Le}function Z(X){X&&(X.texture&&X.texture._texture.decRef(),X.renderbuffer&&X.renderbuffer._renderbuffer.decRef())}function J(X,te,re){if(!!X)if(X.texture){var Ce=X.texture._texture,Le=Math.max(1,Ce.width),ie=Math.max(1,Ce.height);s(Le===te&&ie===re,"inconsistent width/height for supplied texture"),Ce.refCount+=1}else{var se=X.renderbuffer._renderbuffer;s(se.width===te&&se.height===re,"inconsistent width/height for renderbuffer"),se.refCount+=1}}function V(X,te){te&&(te.texture?a.framebufferTexture2D(Ht,X,te.target,te.texture._texture.texture,0):a.framebufferRenderbuffer(Ht,X,ni,te.renderbuffer._renderbuffer.renderbuffer))}function Y(X){var te=dr,re=null,Ce=null,Le=X;typeof X=="object"&&(Le=X.data,"target"in X&&(te=X.target|0)),s.type(Le,"function","invalid attachment data");var ie=Le._reglType;return ie==="texture2d"?(re=Le,s(te===dr)):ie==="textureCube"?(re=Le,s(te>=Hn&&te<Hn+6,"invalid cube map target")):ie==="renderbuffer"?(Ce=Le,te=ni):s.raise("invalid regl object for attachment"),new Q(te,re,Ce)}function E(X,te,re,Ce,Le){if(re){var ie=C.create2D({width:X,height:te,format:Ce,type:Le});return ie._texture.refCount=0,new Q(dr,ie,null)}else{var se=M.create({width:X,height:te,format:Ce});return se._renderbuffer.refCount=0,new Q(ni,null,se)}}function O(X){return X&&(X.texture||X.renderbuffer)}function W(X,te,re){X&&(X.texture?X.texture.resize(te,re):X.renderbuffer&&X.renderbuffer.resize(te,re),X.width=te,X.height=re)}var ue=0,$={};function fe(){this.id=ue++,$[this.id]=this,this.framebuffer=a.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function ae(X){X.colorAttachments.forEach(Z),Z(X.depthAttachment),Z(X.stencilAttachment),Z(X.depthStencilAttachment)}function ye(X){var te=X.framebuffer;s(te,"must not double destroy framebuffer"),a.deleteFramebuffer(te),X.framebuffer=null,L.framebufferCount--,delete $[X.id]}function B(X){var te;a.bindFramebuffer(Ht,X.framebuffer);var re=X.colorAttachments;for(te=0;te<re.length;++te)V(Ko+te,re[te]);for(te=re.length;te<p.maxColorAttachments;++te)a.framebufferTexture2D(Ht,Ko+te,dr,null,0);a.framebufferTexture2D(Ht,tf,dr,null,0),a.framebufferTexture2D(Ht,Jo,dr,null,0),a.framebufferTexture2D(Ht,ef,dr,null,0),V(Jo,X.depthAttachment),V(ef,X.stencilAttachment),V(tf,X.depthStencilAttachment);var Ce=a.checkFramebufferStatus(Ht);!a.isContextLost()&&Ce!==rf&&s.raise("framebuffer configuration not supported, status = "+Fr[Ce]),a.bindFramebuffer(Ht,F.next?F.next.framebuffer:null),F.cur=F.next,a.getError()}function N(X,te){var re=new fe;L.framebufferCount++;function Ce(ie,se){var Ae;s(F.next!==re,"can not update framebuffer which is currently in use");var Re=0,Ne=0,tt=!0,rt=!0,Be=null,st=!0,Ke="rgba",ft="uint8",ut=1,lt=null,dt=null,mt=null,nt=!1;if(typeof ie=="number")Re=ie|0,Ne=se|0||Re;else if(!ie)Re=Ne=1;else{s.type(ie,"object","invalid arguments for framebuffer");var De=ie;if("shape"in De){var pt=De.shape;s(Array.isArray(pt)&&pt.length>=2,"invalid shape for framebuffer"),Re=pt[0],Ne=pt[1]}else"radius"in De&&(Re=Ne=De.radius),"width"in De&&(Re=De.width),"height"in De&&(Ne=De.height);("color"in De||"colors"in De)&&(Be=De.color||De.colors,Array.isArray(Be)&&s(Be.length===1||f.webgl_draw_buffers,"multiple render targets not supported")),Be||("colorCount"in De&&(ut=De.colorCount|0,s(ut>0,"invalid color buffer count")),"colorTexture"in De&&(st=!!De.colorTexture,Ke="rgba4"),"colorType"in De&&(ft=De.colorType,st?(s(f.oes_texture_float||!(ft==="float"||ft==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),s(f.oes_texture_half_float||!(ft==="half float"||ft==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):ft==="half float"||ft==="float16"?(s(f.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ke="rgba16f"):(ft==="float"||ft==="float32")&&(s(f.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ke="rgba32f"),s.oneOf(ft,q,"invalid color type")),"colorFormat"in De&&(Ke=De.colorFormat,H.indexOf(Ke)>=0?st=!0:z.indexOf(Ke)>=0?st=!1:s.optional(function(){st?s.oneOf(De.colorFormat,H,"invalid color format for texture"):s.oneOf(De.colorFormat,z,"invalid color format for renderbuffer")}))),("depthTexture"in De||"depthStencilTexture"in De)&&(nt=!!(De.depthTexture||De.depthStencilTexture),s(!nt||f.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in De&&(typeof De.depth=="boolean"?tt=De.depth:(lt=De.depth,rt=!1)),"stencil"in De&&(typeof De.stencil=="boolean"?rt=De.stencil:(dt=De.stencil,tt=!1)),"depthStencil"in De&&(typeof De.depthStencil=="boolean"?tt=rt=De.depthStencil:(mt=De.depthStencil,tt=!1,rt=!1))}var He=null,we=null,Me=null,Ue=null;if(Array.isArray(Be))He=Be.map(Y);else if(Be)He=[Y(Be)];else for(He=new Array(ut),Ae=0;Ae<ut;++Ae)He[Ae]=E(Re,Ne,st,Ke,ft);s(f.webgl_draw_buffers||He.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),s(He.length<=p.maxColorAttachments,"too many color attachments, not supported"),Re=Re||He[0].width,Ne=Ne||He[0].height,lt?we=Y(lt):tt&&!rt&&(we=E(Re,Ne,nt,"depth","uint32")),dt?Me=Y(dt):rt&&!tt&&(Me=E(Re,Ne,!1,"stencil","uint8")),mt?Ue=Y(mt):!lt&&!dt&&rt&&tt&&(Ue=E(Re,Ne,nt,"depth stencil","depth stencil")),s(!!lt+!!dt+!!mt<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var at=null;for(Ae=0;Ae<He.length;++Ae)if(J(He[Ae],Re,Ne),s(!He[Ae]||He[Ae].texture&&dc.indexOf(He[Ae].texture._texture.format)>=0||He[Ae].renderbuffer&&Ec.indexOf(He[Ae].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ae+" is invalid"),He[Ae]&&He[Ae].texture){var Ut=ai[He[Ae].texture._texture.format]*jn[He[Ae].texture._texture.type];at===null?at=Ut:s(at===Ut,"all color attachments much have the same number of bits per pixel.")}return J(we,Re,Ne),s(!we||we.texture&&we.texture._texture.format===cc||we.renderbuffer&&we.renderbuffer._renderbuffer.format===vc,"invalid depth attachment for framebuffer object"),J(Me,Re,Ne),s(!Me||Me.renderbuffer&&Me.renderbuffer._renderbuffer.format===bc,"invalid stencil attachment for framebuffer object"),J(Ue,Re,Ne),s(!Ue||Ue.texture&&Ue.texture._texture.format===of||Ue.renderbuffer&&Ue.renderbuffer._renderbuffer.format===of,"invalid depth-stencil attachment for framebuffer object"),ae(re),re.width=Re,re.height=Ne,re.colorAttachments=He,re.depthAttachment=we,re.stencilAttachment=Me,re.depthStencilAttachment=Ue,Ce.color=He.map(O),Ce.depth=O(we),Ce.stencil=O(Me),Ce.depthStencil=O(Ue),Ce.width=re.width,Ce.height=re.height,B(re),Ce}function Le(ie,se){s(F.next!==re,"can not resize a framebuffer which is currently in use");var Ae=Math.max(ie|0,1),Re=Math.max(se|0||Ae,1);if(Ae===re.width&&Re===re.height)return Ce;for(var Ne=re.colorAttachments,tt=0;tt<Ne.length;++tt)W(Ne[tt],Ae,Re);return W(re.depthAttachment,Ae,Re),W(re.stencilAttachment,Ae,Re),W(re.depthStencilAttachment,Ae,Re),re.width=Ce.width=Ae,re.height=Ce.height=Re,B(re),Ce}return Ce(X,te),n(Ce,{resize:Le,_reglType:"framebuffer",_framebuffer:re,destroy:function(){ye(re),ae(re)},use:function(ie){F.setFBO({framebuffer:Ce},ie)}})}function he(X){var te=Array(6);function re(Le){var ie;s(te.indexOf(F.next)<0,"can not update framebuffer which is currently in use");var se={color:null},Ae=0,Re=null,Ne="rgba",tt="uint8",rt=1;if(typeof Le=="number")Ae=Le|0;else if(!Le)Ae=1;else{s.type(Le,"object","invalid arguments for framebuffer");var Be=Le;if("shape"in Be){var st=Be.shape;s(Array.isArray(st)&&st.length>=2,"invalid shape for framebuffer"),s(st[0]===st[1],"cube framebuffer must be square"),Ae=st[0]}else"radius"in Be&&(Ae=Be.radius|0),"width"in Be?(Ae=Be.width|0,"height"in Be&&s(Be.height===Ae,"must be square")):"height"in Be&&(Ae=Be.height|0);("color"in Be||"colors"in Be)&&(Re=Be.color||Be.colors,Array.isArray(Re)&&s(Re.length===1||f.webgl_draw_buffers,"multiple render targets not supported")),Re||("colorCount"in Be&&(rt=Be.colorCount|0,s(rt>0,"invalid color buffer count")),"colorType"in Be&&(s.oneOf(Be.colorType,q,"invalid color type"),tt=Be.colorType),"colorFormat"in Be&&(Ne=Be.colorFormat,s.oneOf(Be.colorFormat,H,"invalid color format for texture"))),"depth"in Be&&(se.depth=Be.depth),"stencil"in Be&&(se.stencil=Be.stencil),"depthStencil"in Be&&(se.depthStencil=Be.depthStencil)}var Ke;if(Re)if(Array.isArray(Re))for(Ke=[],ie=0;ie<Re.length;++ie)Ke[ie]=Re[ie];else Ke=[Re];else{Ke=Array(rt);var ft={radius:Ae,format:Ne,type:tt};for(ie=0;ie<rt;++ie)Ke[ie]=C.createCube(ft)}for(se.color=Array(Ke.length),ie=0;ie<Ke.length;++ie){var ut=Ke[ie];s(typeof ut=="function"&&ut._reglType==="textureCube","invalid cube map"),Ae=Ae||ut.width,s(ut.width===Ae&&ut.height===Ae,"invalid cube map shape"),se.color[ie]={target:Hn,data:Ke[ie]}}for(ie=0;ie<6;++ie){for(var lt=0;lt<Ke.length;++lt)se.color[lt].target=Hn+ie;ie>0&&(se.depth=te[0].depth,se.stencil=te[0].stencil,se.depthStencil=te[0].depthStencil),te[ie]?te[ie](se):te[ie]=N(se)}return n(re,{width:Ae,height:Ae,color:Ke})}function Ce(Le){var ie,se=Le|0;if(s(se>0&&se<=p.maxCubeMapSize,"invalid radius for cube fbo"),se===re.width)return re;var Ae=re.color;for(ie=0;ie<Ae.length;++ie)Ae[ie].resize(se);for(ie=0;ie<6;++ie)te[ie].resize(se);return re.width=re.height=se,re}return re(X),n(re,{faces:te,resize:Ce,_reglType:"framebufferCube",destroy:function(){te.forEach(function(Le){Le.destroy()})}})}function ee(){F.cur=null,F.next=null,F.dirty=!0,Ct($).forEach(function(X){X.framebuffer=a.createFramebuffer(),B(X)})}return n(F,{getFramebuffer:function(X){if(typeof X=="function"&&X._reglType==="framebuffer"){var te=X._framebuffer;if(te instanceof fe)return te}return null},create:N,createCube:he,clear:function(){Ct($).forEach(ye)},restore:ee})}var wc=5126,ff=34962,Vn=34963,sf=["attributes","elements","offset","count","primitive","instances"];function ii(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=wc,this.offset=0,this.stride=0,this.divisor=0}function Ac(a,f,p,C,M,L,F){for(var H=p.maxAttributes,z=new Array(H),q=0;q<H;++q)z[q]=new ii;var Q=0,Z={},J={Record:ii,scope:{},state:z,currentVAO:null,targetVAO:null,restore:Y()?ae:function(){},createVAO:ye,getVAO:O,destroyBuffer:V,setVAO:Y()?W:ue,clear:Y()?$:function(){}};function V(B){for(var N=0;N<z.length;++N){var he=z[N];he.buffer===B&&(a.disableVertexAttribArray(N),he.buffer=null)}}function Y(){return f.oes_vertex_array_object}function E(){return f.angle_instanced_arrays}function O(B){return typeof B=="function"&&B._vao?B._vao:null}function W(B){if(B!==J.currentVAO){var N=Y();B?N.bindVertexArrayOES(B.vao):N.bindVertexArrayOES(null),J.currentVAO=B}}function ue(B){if(B!==J.currentVAO){if(B)B.bindAttrs();else{for(var N=E(),he=0;he<z.length;++he){var ee=z[he];ee.buffer?(a.enableVertexAttribArray(he),ee.buffer.bind(),a.vertexAttribPointer(he,ee.size,ee.type,ee.normalized,ee.stride,ee.offfset),N&&ee.divisor&&N.vertexAttribDivisorANGLE(he,ee.divisor)):(a.disableVertexAttribArray(he),a.vertexAttrib4f(he,ee.x,ee.y,ee.z,ee.w))}F.elements?a.bindBuffer(Vn,F.elements.buffer.buffer):a.bindBuffer(Vn,null)}J.currentVAO=B}}function $(){Ct(Z).forEach(function(B){B.destroy()})}function fe(){this.id=++Q,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var B=Y();B?this.vao=B.createVertexArrayOES():this.vao=null,Z[this.id]=this,this.buffers=[]}fe.prototype.bindAttrs=function(){for(var B=E(),N=this.attributes,he=0;he<N.length;++he){var ee=N[he];ee.buffer?(a.enableVertexAttribArray(he),a.bindBuffer(ff,ee.buffer.buffer),a.vertexAttribPointer(he,ee.size,ee.type,ee.normalized,ee.stride,ee.offset),B&&ee.divisor&&B.vertexAttribDivisorANGLE(he,ee.divisor)):(a.disableVertexAttribArray(he),a.vertexAttrib4f(he,ee.x,ee.y,ee.z,ee.w))}for(var X=N.length;X<H;++X)a.disableVertexAttribArray(X);var te=L.getElements(this.elements);te?a.bindBuffer(Vn,te.buffer.buffer):a.bindBuffer(Vn,null)},fe.prototype.refresh=function(){var B=Y();B&&(B.bindVertexArrayOES(this.vao),this.bindAttrs(),J.currentVAO=null,B.bindVertexArrayOES(null))},fe.prototype.destroy=function(){if(this.vao){var B=Y();this===J.currentVAO&&(J.currentVAO=null,B.bindVertexArrayOES(null)),B.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Z[this.id]&&(delete Z[this.id],C.vaoCount-=1)};function ae(){var B=Y();B&&Ct(Z).forEach(function(N){N.refresh()})}function ye(B){var N=new fe;C.vaoCount+=1;function he(ee){var X;if(Array.isArray(ee))X=ee,N.elements&&N.ownsElements&&N.elements.destroy(),N.elements=null,N.ownsElements=!1,N.offset=0,N.count=0,N.instances=-1,N.primitive=4;else{if(s(typeof ee=="object","invalid arguments for create vao"),s("attributes"in ee,"must specify attributes for vao"),ee.elements){var te=ee.elements;N.ownsElements?typeof te=="function"&&te._reglType==="elements"?(N.elements.destroy(),N.ownsElements=!1):(N.elements(te),N.ownsElements=!1):L.getElements(ee.elements)?(N.elements=ee.elements,N.ownsElements=!1):(N.elements=L.create(ee.elements),N.ownsElements=!0)}else N.elements=null,N.ownsElements=!1;X=ee.attributes,N.offset=0,N.count=-1,N.instances=-1,N.primitive=4,N.elements&&(N.count=N.elements._elements.vertCount,N.primitive=N.elements._elements.primType),"offset"in ee&&(N.offset=ee.offset|0),"count"in ee&&(N.count=ee.count|0),"instances"in ee&&(N.instances=ee.instances|0),"primitive"in ee&&(s(ee.primitive in Kt,"bad primitive type: "+ee.primitive),N.primitive=Kt[ee.primitive]),s.optional(()=>{for(var tt=Object.keys(ee),rt=0;rt<tt.length;++rt)s(sf.indexOf(tt[rt])>=0,'invalid option for vao: "'+tt[rt]+'" valid options are '+sf)}),s(Array.isArray(X),"attributes must be an array")}s(X.length<H,"too many attributes"),s(X.length>0,"must specify at least one attribute");var re={},Ce=N.attributes;Ce.length=X.length;for(var Le=0;Le<X.length;++Le){var ie=X[Le],se=Ce[Le]=new ii,Ae=ie.data||ie;if(Array.isArray(Ae)||r(Ae)||Gt(Ae)){var Re;N.buffers[Le]&&(Re=N.buffers[Le],r(Ae)&&Re._buffer.byteLength>=Ae.byteLength?Re.subdata(Ae):(Re.destroy(),N.buffers[Le]=null)),N.buffers[Le]||(Re=N.buffers[Le]=M.create(ie,ff,!1,!0)),se.buffer=M.getBuffer(Re),se.size=se.buffer.dimension|0,se.normalized=!1,se.type=se.buffer.dtype,se.offset=0,se.stride=0,se.divisor=0,se.state=1,re[Le]=1}else M.getBuffer(ie)?(se.buffer=M.getBuffer(ie),se.size=se.buffer.dimension|0,se.normalized=!1,se.type=se.buffer.dtype,se.offset=0,se.stride=0,se.divisor=0,se.state=1):M.getBuffer(ie.buffer)?(se.buffer=M.getBuffer(ie.buffer),se.size=(+ie.size||se.buffer.dimension)|0,se.normalized=!!ie.normalized||!1,"type"in ie?(s.parameter(ie.type,sr,"invalid buffer type"),se.type=sr[ie.type]):se.type=se.buffer.dtype,se.offset=(ie.offset||0)|0,se.stride=(ie.stride||0)|0,se.divisor=(ie.divisor||0)|0,se.state=1,s(se.size>=1&&se.size<=4,"size must be between 1 and 4"),s(se.offset>=0,"invalid offset"),s(se.stride>=0&&se.stride<=255,"stride must be between 0 and 255"),s(se.divisor>=0,"divisor must be positive"),s(!se.divisor||!!f.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in ie?(s(Le>0,"first attribute must not be a constant"),se.x=+ie.x||0,se.y=+ie.y||0,se.z=+ie.z||0,se.w=+ie.w||0,se.state=2):s(!1,"invalid attribute spec for location "+Le)}for(var Ne=0;Ne<N.buffers.length;++Ne)!re[Ne]&&N.buffers[Ne]&&(N.buffers[Ne].destroy(),N.buffers[Ne]=null);return N.refresh(),he}return he.destroy=function(){for(var ee=0;ee<N.buffers.length;++ee)N.buffers[ee]&&N.buffers[ee].destroy();N.buffers.length=0,N.ownsElements&&(N.elements.destroy(),N.elements=null,N.ownsElements=!1),N.destroy()},he._vao=N,he._reglType="vao",he(B)}return J}var uf=35632,Sc=35633,kc=35718,Lc=35721;function Cc(a,f,p,C){var M={},L={};function F(E,O,W,ue){this.name=E,this.id=O,this.location=W,this.info=ue}function H(E,O){for(var W=0;W<E.length;++W)if(E[W].id===O.id){E[W].location=O.location;return}E.push(O)}function z(E,O,W){var ue=E===uf?M:L,$=ue[O];if(!$){var fe=f.str(O);$=a.createShader(E),a.shaderSource($,fe),a.compileShader($),s.shaderError(a,$,fe,E,W),ue[O]=$}return $}var q={},Q=[],Z=0;function J(E,O){this.id=Z++,this.fragId=E,this.vertId=O,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,C.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function V(E,O,W){var ue,$,fe=z(uf,E.fragId),ae=z(Sc,E.vertId),ye=E.program=a.createProgram();if(a.attachShader(ye,fe),a.attachShader(ye,ae),W)for(ue=0;ue<W.length;++ue){var B=W[ue];a.bindAttribLocation(ye,B[0],B[1])}a.linkProgram(ye),s.linkError(a,ye,f.str(E.fragId),f.str(E.vertId),O);var N=a.getProgramParameter(ye,kc);C.profile&&(E.stats.uniformsCount=N);var he=E.uniforms;for(ue=0;ue<N;++ue)if($=a.getActiveUniform(ye,ue),$){if($.size>1)for(var ee=0;ee<$.size;++ee){var X=$.name.replace("[0]","["+ee+"]");H(he,new F(X,f.id(X),a.getUniformLocation(ye,X),$))}var te=$.name;$.size>1&&(te=te.replace("[0]","")),H(he,new F(te,f.id(te),a.getUniformLocation(ye,te),$))}var re=a.getProgramParameter(ye,Lc);C.profile&&(E.stats.attributesCount=re);var Ce=E.attributes;for(ue=0;ue<re;++ue)$=a.getActiveAttrib(ye,ue),$&&H(Ce,new F($.name,f.id($.name),a.getAttribLocation(ye,$.name),$))}C.profile&&(p.getMaxUniformsCount=function(){var E=0;return Q.forEach(function(O){O.stats.uniformsCount>E&&(E=O.stats.uniformsCount)}),E},p.getMaxAttributesCount=function(){var E=0;return Q.forEach(function(O){O.stats.attributesCount>E&&(E=O.stats.attributesCount)}),E});function Y(){M={},L={};for(var E=0;E<Q.length;++E)V(Q[E],null,Q[E].attributes.map(function(O){return[O.location,O.name]}))}return{clear:function(){var E=a.deleteShader.bind(a);Ct(M).forEach(E),M={},Ct(L).forEach(E),L={},Q.forEach(function(O){a.deleteProgram(O.program)}),Q.length=0,q={},p.shaderCount=0},program:function(E,O,W,ue){s.command(E>=0,"missing vertex shader",W),s.command(O>=0,"missing fragment shader",W);var $=q[O];$||($=q[O]={});var fe=$[E];if(fe&&(fe.refCount++,!ue))return fe;var ae=new J(O,E);return p.shaderCount++,V(ae,W,ue),fe||($[E]=ae),Q.push(ae),n(ae,{destroy:function(){if(ae.refCount--,ae.refCount<=0){a.deleteProgram(ae.program);var ye=Q.indexOf(ae);Q.splice(ye,1),p.shaderCount--}$[ae.vertId].refCount<=0&&(a.deleteShader(L[ae.vertId]),delete L[ae.vertId],delete q[ae.fragId][ae.vertId]),Object.keys(q[ae.fragId]).length||(a.deleteShader(M[ae.fragId]),delete M[ae.fragId],delete q[ae.fragId])}})},restore:Y,shader:z,frag:-1,vert:-1}}var Rc=6408,Jr=5121,Oc=3333,Xn=5126;function Dc(a,f,p,C,M,L,F){function H(Q){var Z;f.next===null?(s(M.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Z=Jr):(s(f.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Z=f.next.colorAttachments[0].texture._texture.type,s.optional(function(){L.oes_texture_float?(s(Z===Jr||Z===Xn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Z===Xn&&s(F.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):s(Z===Jr,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var J=0,V=0,Y=C.framebufferWidth,E=C.framebufferHeight,O=null;r(Q)?O=Q:Q&&(s.type(Q,"object","invalid arguments to regl.read()"),J=Q.x|0,V=Q.y|0,s(J>=0&&J<C.framebufferWidth,"invalid x offset for regl.read"),s(V>=0&&V<C.framebufferHeight,"invalid y offset for regl.read"),Y=(Q.width||C.framebufferWidth-J)|0,E=(Q.height||C.framebufferHeight-V)|0,O=Q.data||null),O&&(Z===Jr?s(O instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Z===Xn&&s(O instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),s(Y>0&&Y+J<=C.framebufferWidth,"invalid width for read pixels"),s(E>0&&E+V<=C.framebufferHeight,"invalid height for read pixels"),p();var W=Y*E*4;return O||(Z===Jr?O=new Uint8Array(W):Z===Xn&&(O=O||new Float32Array(W))),s.isTypedArray(O,"data buffer for regl.read() must be a typedarray"),s(O.byteLength>=W,"data buffer for regl.read() too small"),a.pixelStorei(Oc,4),a.readPixels(J,V,Y,E,Rc,Z,O),O}function z(Q){var Z;return f.setFBO({framebuffer:Q.framebuffer},function(){Z=H(Q)}),Z}function q(Q){return!Q||!("framebuffer"in Q)?H(Q):z(Q)}return q}function Gr(a){return Array.prototype.slice.call(a)}function Ir(a){return Gr(a).join("")}function Fc(){var a=0,f=[],p=[];function C(Z){for(var J=0;J<p.length;++J)if(p[J]===Z)return f[J];var V="g"+a++;return f.push(V),p.push(Z),V}function M(){var Z=[];function J(){Z.push.apply(Z,Gr(arguments))}var V=[];function Y(){var E="v"+a++;return V.push(E),arguments.length>0&&(Z.push(E,"="),Z.push.apply(Z,Gr(arguments)),Z.push(";")),E}return n(J,{def:Y,toString:function(){return Ir([V.length>0?"var "+V.join(",")+";":"",Ir(Z)])}})}function L(){var Z=M(),J=M(),V=Z.toString,Y=J.toString;function E(O,W){J(O,W,"=",Z.def(O,W),";")}return n(function(){Z.apply(Z,Gr(arguments))},{def:Z.def,entry:Z,exit:J,save:E,set:function(O,W,ue){E(O,W),Z(O,W,"=",ue,";")},toString:function(){return V()+Y()}})}function F(){var Z=Ir(arguments),J=L(),V=L(),Y=J.toString,E=V.toString;return n(J,{then:function(){return J.apply(J,Gr(arguments)),this},else:function(){return V.apply(V,Gr(arguments)),this},toString:function(){var O=E();return O&&(O="else{"+O+"}"),Ir(["if(",Z,"){",Y(),"}",O])}})}var H=M(),z={};function q(Z,J){var V=[];function Y(){var $="a"+V.length;return V.push($),$}J=J||0;for(var E=0;E<J;++E)Y();var O=L(),W=O.toString,ue=z[Z]=n(O,{arg:Y,toString:function(){return Ir(["function(",V.join(),"){",W(),"}"])}});return ue}function Q(){var Z=['"use strict";',H,"return {"];Object.keys(z).forEach(function(Y){Z.push('"',Y,'":',z[Y].toString(),",")}),Z.push("}");var J=Ir(Z).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),V=Function.apply(null,f.concat(J));return V.apply(null,p)}return{global:H,link:C,block:M,proc:q,scope:L,cond:F,compile:Q}}var Nr="xyzw".split(""),lf=5121,Mr=1,oi=2,fi=0,si=1,ui=2,li=3,Wn=4,cf=5,df=6,hf="dither",mf="blend.enable",pf="blend.color",ci="blend.equation",di="blend.func",vf="depth.enable",bf="depth.func",_f="depth.range",yf="depth.mask",hi="colorMask",gf="cull.enable",xf="cull.face",mi="frontFace",pi="lineWidth",Ef="polygonOffset.enable",vi="polygonOffset.offset",Tf="sample.alpha",wf="sample.enable",bi="sample.coverage",Af="stencil.enable",Sf="stencil.mask",_i="stencil.func",yi="stencil.opFront",en="stencil.opBack",kf="scissor.enable",Yn="scissor.box",jt="viewport",tn="profile",hr="framebuffer",rn="vert",nn="frag",mr="elements",pr="primitive",vr="count",qn="offset",Zn="instances",an="vao",gi="Width",xi="Height",Br=hr+gi,Pr=hr+xi,Gc=jt+gi,Ic=jt+xi,Lf="drawingBuffer",Cf=Lf+gi,Rf=Lf+xi,Nc=[di,ci,_i,yi,en,bi,jt,Yn,vi],Ur=34962,Ei=34963,Mc=35632,Bc=35633,Of=3553,Pc=34067,Uc=2884,$c=3042,zc=3024,Hc=2960,jc=2929,Vc=3089,Xc=32823,Wc=32926,Yc=32928,Ti=5126,Qn=35664,Kn=35665,Jn=35666,wi=5124,ea=35667,ta=35668,ra=35669,Ai=35670,na=35671,aa=35672,ia=35673,on=35674,fn=35675,sn=35676,un=35678,ln=35680,Si=4,cn=1028,br=1029,Df=2304,ki=2305,qc=32775,Zc=32776,Qc=519,er=7680,Ff=0,Gf=1,If=32774,Kc=513,Nf=36160,Jc=36064,Pt={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Mf=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],$r={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},tr={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Bf={frag:Mc,vert:Bc},Li={cw:Df,ccw:ki};function oa(a){return Array.isArray(a)||r(a)||Gt(a)}function Pf(a){return a.sort(function(f,p){return f===jt?-1:p===jt?1:f<p?-1:1})}function ct(a,f,p,C){this.thisDep=a,this.contextDep=f,this.propDep=p,this.append=C}function rr(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function ot(a){return new ct(!1,!1,!1,a)}function At(a,f){var p=a.type;if(p===fi){var C=a.data.length;return new ct(!0,C>=1,C>=2,f)}else if(p===Wn){var M=a.data;return new ct(M.thisDep,M.contextDep,M.propDep,f)}else{if(p===cf)return new ct(!1,!1,!1,f);if(p===df){for(var L=!1,F=!1,H=!1,z=0;z<a.data.length;++z){var q=a.data[z];if(q.type===si)H=!0;else if(q.type===ui)F=!0;else if(q.type===li)L=!0;else if(q.type===fi){L=!0;var Q=q.data;Q>=1&&(F=!0),Q>=2&&(H=!0)}else q.type===Wn&&(L=L||q.data.thisDep,F=F||q.data.contextDep,H=H||q.data.propDep)}return new ct(L,F,H,f)}else return new ct(p===li,p===ui,p===si,f)}}var Uf=new ct(!1,!1,!1,function(){});function ed(a,f,p,C,M,L,F,H,z,q,Q,Z,J,V,Y){var E=q.Record,O={add:32774,subtract:32778,"reverse subtract":32779};p.ext_blend_minmax&&(O.min=qc,O.max=Zc);var W=p.angle_instanced_arrays,ue=p.webgl_draw_buffers,$=p.oes_vertex_array_object,fe={dirty:!0,profile:Y.profile},ae={},ye=[],B={},N={};function he(u){return u.replace(".","_")}function ee(u,i,v){var x=he(u);ye.push(u),ae[x]=fe[x]=!!v,B[x]=i}function X(u,i,v){var x=he(u);ye.push(u),Array.isArray(v)?(fe[x]=v.slice(),ae[x]=v.slice()):fe[x]=ae[x]=v,N[x]=i}ee(hf,zc),ee(mf,$c),X(pf,"blendColor",[0,0,0,0]),X(ci,"blendEquationSeparate",[If,If]),X(di,"blendFuncSeparate",[Gf,Ff,Gf,Ff]),ee(vf,jc,!0),X(bf,"depthFunc",Kc),X(_f,"depthRange",[0,1]),X(yf,"depthMask",!0),X(hi,hi,[!0,!0,!0,!0]),ee(gf,Uc),X(xf,"cullFace",br),X(mi,mi,ki),X(pi,pi,1),ee(Ef,Xc),X(vi,"polygonOffset",[0,0]),ee(Tf,Wc),ee(wf,Yc),X(bi,"sampleCoverage",[1,!1]),ee(Af,Hc),X(Sf,"stencilMask",-1),X(_i,"stencilFunc",[Qc,0,-1]),X(yi,"stencilOpSeparate",[cn,er,er,er]),X(en,"stencilOpSeparate",[br,er,er,er]),ee(kf,Vc),X(Yn,"scissor",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]),X(jt,jt,[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);var te={gl:a,context:J,strings:f,next:ae,current:fe,draw:Z,elements:L,buffer:M,shader:Q,attributes:q.state,vao:q,uniforms:z,framebuffer:H,extensions:p,timer:V,isBufferArgs:oa},re={primTypes:Kt,compareFuncs:$r,blendFuncs:Pt,blendEquations:O,stencilOps:tr,glTypes:sr,orientationType:Li};s.optional(function(){te.isArrayLike=et}),ue&&(re.backBuffer=[br],re.drawBuffer=Lt(C.maxDrawbuffers,function(u){return u===0?[0]:Lt(u,function(i){return Jc+i})}));var Ce=0;function Le(){var u=Fc(),i=u.link,v=u.global;u.id=Ce++,u.batchId="0";var x=i(te),w=u.shared={props:"a0"};Object.keys(te).forEach(function(m){w[m]=v.def(x,".",m)}),s.optional(function(){u.CHECK=i(s),u.commandStr=s.guessCommand(),u.command=i(u.commandStr),u.assert=function(m,d,S){m("if(!(",d,"))",this.CHECK,".commandRaise(",i(S),",",this.command,");")},re.invalidBlendCombinations=Mf});var y=u.next={},_=u.current={};Object.keys(N).forEach(function(m){Array.isArray(fe[m])&&(y[m]=v.def(w.next,".",m),_[m]=v.def(w.current,".",m))});var g=u.constants={};Object.keys(re).forEach(function(m){g[m]=v.def(JSON.stringify(re[m]))}),u.invoke=function(m,d){switch(d.type){case fi:var S=["this",w.context,w.props,u.batchId];return m.def(i(d.data),".call(",S.slice(0,Math.max(d.data.length+1,4)),")");case si:return m.def(w.props,d.data);case ui:return m.def(w.context,d.data);case li:return m.def("this",d.data);case Wn:return d.data.append(u,m),d.data.ref;case cf:return d.data.toString();case df:return d.data.map(function(A){return u.invoke(m,A)})}},u.attribCache={};var c={};return u.scopeAttrib=function(m){var d=f.id(m);if(d in c)return c[d];var S=q.scope[d];S||(S=q.scope[d]=new E);var A=c[d]=i(S);return A},u}function ie(u){var i=u.static,v=u.dynamic,x;if(tn in i){var w=!!i[tn];x=ot(function(_,g){return w}),x.enable=w}else if(tn in v){var y=v[tn];x=At(y,function(_,g){return _.invoke(g,y)})}return x}function se(u,i){var v=u.static,x=u.dynamic;if(hr in v){var w=v[hr];return w?(w=H.getFramebuffer(w),s.command(w,"invalid framebuffer object"),ot(function(_,g){var c=_.link(w),m=_.shared;g.set(m.framebuffer,".next",c);var d=m.context;return g.set(d,"."+Br,c+".width"),g.set(d,"."+Pr,c+".height"),c})):ot(function(_,g){var c=_.shared;g.set(c.framebuffer,".next","null");var m=c.context;return g.set(m,"."+Br,m+"."+Cf),g.set(m,"."+Pr,m+"."+Rf),"null"})}else if(hr in x){var y=x[hr];return At(y,function(_,g){var c=_.invoke(g,y),m=_.shared,d=m.framebuffer,S=g.def(d,".getFramebuffer(",c,")");s.optional(function(){_.assert(g,"!"+c+"||"+S,"invalid framebuffer object")}),g.set(d,".next",S);var A=m.context;return g.set(A,"."+Br,S+"?"+S+".width:"+A+"."+Cf),g.set(A,"."+Pr,S+"?"+S+".height:"+A+"."+Rf),S})}else return null}function Ae(u,i,v){var x=u.static,w=u.dynamic;function y(c){if(c in x){var m=x[c];s.commandType(m,"object","invalid "+c,v.commandStr);var d=!0,S=m.x|0,A=m.y|0,I,P;return"width"in m?(I=m.width|0,s.command(I>=0,"invalid "+c,v.commandStr)):d=!1,"height"in m?(P=m.height|0,s.command(P>=0,"invalid "+c,v.commandStr)):d=!1,new ct(!d&&i&&i.thisDep,!d&&i&&i.contextDep,!d&&i&&i.propDep,function(_e,ce){var U=_e.shared.context,G=I;"width"in m||(G=ce.def(U,".",Br,"-",S));var pe=P;return"height"in m||(pe=ce.def(U,".",Pr,"-",A)),[S,A,G,pe]})}else if(c in w){var K=w[c],ke=At(K,function(_e,ce){var U=_e.invoke(ce,K);s.optional(function(){_e.assert(ce,U+"&&typeof "+U+'==="object"',"invalid "+c)});var G=_e.shared.context,pe=ce.def(U,".x|0"),me=ce.def(U,".y|0"),Se=ce.def('"width" in ',U,"?",U,".width|0:","(",G,".",Br,"-",pe,")"),Ve=ce.def('"height" in ',U,"?",U,".height|0:","(",G,".",Pr,"-",me,")");return s.optional(function(){_e.assert(ce,Se+">=0&&"+Ve+">=0","invalid "+c)}),[pe,me,Se,Ve]});return i&&(ke.thisDep=ke.thisDep||i.thisDep,ke.contextDep=ke.contextDep||i.contextDep,ke.propDep=ke.propDep||i.propDep),ke}else return i?new ct(i.thisDep,i.contextDep,i.propDep,function(_e,ce){var U=_e.shared.context;return[0,0,ce.def(U,".",Br),ce.def(U,".",Pr)]}):null}var _=y(jt);if(_){var g=_;_=new ct(_.thisDep,_.contextDep,_.propDep,function(c,m){var d=g.append(c,m),S=c.shared.context;return m.set(S,"."+Gc,d[2]),m.set(S,"."+Ic,d[3]),d})}return{viewport:_,scissor_box:y(Yn)}}function Re(u,i){var v=u.static,x=typeof v[nn]=="string"&&typeof v[rn]=="string";if(x){if(Object.keys(i.dynamic).length>0)return null;var w=i.static,y=Object.keys(w);if(y.length>0&&typeof w[y[0]]=="number"){for(var _=[],g=0;g<y.length;++g)s(typeof w[y[g]]=="number","must specify all vertex attribute locations when using vaos"),_.push([w[y[g]]|0,y[g]]);return _}}return null}function Ne(u,i,v){var x=u.static,w=u.dynamic;function y(d){if(d in x){var S=f.id(x[d]);s.optional(function(){Q.shader(Bf[d],S,s.guessCommand())});var A=ot(function(){return S});return A.id=S,A}else if(d in w){var I=w[d];return At(I,function(P,K){var ke=P.invoke(K,I),_e=K.def(P.shared.strings,".id(",ke,")");return s.optional(function(){K(P.shared.shader,".shader(",Bf[d],",",_e,",",P.command,");")}),_e})}return null}var _=y(nn),g=y(rn),c=null,m;return rr(_)&&rr(g)?(c=Q.program(g.id,_.id,null,v),m=ot(function(d,S){return d.link(c)})):m=new ct(_&&_.thisDep||g&&g.thisDep,_&&_.contextDep||g&&g.contextDep,_&&_.propDep||g&&g.propDep,function(d,S){var A=d.shared.shader,I;_?I=_.append(d,S):I=S.def(A,".",nn);var P;g?P=g.append(d,S):P=S.def(A,".",rn);var K=A+".program("+P+","+I;return s.optional(function(){K+=","+d.command}),S.def(K+")")}),{frag:_,vert:g,progVar:m,program:c}}function tt(u,i){var v=u.static,x=u.dynamic,w={},y=!1;function _(){if(an in v){var ce=v[an];return ce!==null&&q.getVAO(ce)===null&&(ce=q.createVAO(ce)),y=!0,w.vao=ce,ot(function(G){var pe=q.getVAO(ce);return pe?G.link(pe):"null"})}else if(an in x){y=!0;var U=x[an];return At(U,function(G,pe){var me=G.invoke(pe,U);return pe.def(G.shared.vao+".getVAO("+me+")")})}return null}var g=_(),c=!1;function m(){if(mr in v){var ce=v[mr];if(w.elements=ce,oa(ce)){var U=w.elements=L.create(ce,!0);ce=L.getElements(U),c=!0}else ce&&(ce=L.getElements(ce),c=!0,s.command(ce,"invalid elements",i.commandStr));var G=ot(function(me,Se){if(ce){var Ve=me.link(ce);return me.ELEMENTS=Ve,Ve}return me.ELEMENTS=null,null});return G.value=ce,G}else if(mr in x){c=!0;var pe=x[mr];return At(pe,function(me,Se){var Ve=me.shared,vt=Ve.isBufferArgs,yr=Ve.elements,Vt=me.invoke(Se,pe),$t=Se.def("null"),nr=Se.def(vt,"(",Vt,")"),gr=me.cond(nr).then($t,"=",yr,".createStream(",Vt,");").else($t,"=",yr,".getElements(",Vt,");");return s.optional(function(){me.assert(gr.else,"!"+Vt+"||"+$t,"invalid elements")}),Se.entry(gr),Se.exit(me.cond(nr).then(yr,".destroyStream(",$t,");")),me.ELEMENTS=$t,$t})}else if(y)return new ct(g.thisDep,g.contextDep,g.propDep,function(me,Se){return Se.def(me.shared.vao+".currentVAO?"+me.shared.elements+".getElements("+me.shared.vao+".currentVAO.elements):null")});return null}var d=m();function S(){if(pr in v){var ce=v[pr];return w.primitive=ce,s.commandParameter(ce,Kt,"invalid primitve",i.commandStr),ot(function(G,pe){return Kt[ce]})}else if(pr in x){var U=x[pr];return At(U,function(G,pe){var me=G.constants.primTypes,Se=G.invoke(pe,U);return s.optional(function(){G.assert(pe,Se+" in "+me,"invalid primitive, must be one of "+Object.keys(Kt))}),pe.def(me,"[",Se,"]")})}else{if(c)return rr(d)?d.value?ot(function(G,pe){return pe.def(G.ELEMENTS,".primType")}):ot(function(){return Si}):new ct(d.thisDep,d.contextDep,d.propDep,function(G,pe){var me=G.ELEMENTS;return pe.def(me,"?",me,".primType:",Si)});if(y)return new ct(g.thisDep,g.contextDep,g.propDep,function(G,pe){return pe.def(G.shared.vao+".currentVAO?"+G.shared.vao+".currentVAO.primitive:"+Si)})}return null}function A(ce,U){if(ce in v){var G=v[ce]|0;return U?w.offset=G:w.instances=G,s.command(!U||G>=0,"invalid "+ce,i.commandStr),ot(function(me,Se){return U&&(me.OFFSET=G),G})}else if(ce in x){var pe=x[ce];return At(pe,function(me,Se){var Ve=me.invoke(Se,pe);return U&&(me.OFFSET=Ve,s.optional(function(){me.assert(Se,Ve+">=0","invalid "+ce)})),Ve})}else if(U){if(c)return ot(function(me,Se){return me.OFFSET=0,0});if(y)return new ct(g.thisDep,g.contextDep,g.propDep,function(me,Se){return Se.def(me.shared.vao+".currentVAO?"+me.shared.vao+".currentVAO.offset:0")})}else if(y)return new ct(g.thisDep,g.contextDep,g.propDep,function(me,Se){return Se.def(me.shared.vao+".currentVAO?"+me.shared.vao+".currentVAO.instances:-1")});return null}var I=A(qn,!0);function P(){if(vr in v){var ce=v[vr]|0;return w.count=ce,s.command(typeof ce=="number"&&ce>=0,"invalid vertex count",i.commandStr),ot(function(){return ce})}else if(vr in x){var U=x[vr];return At(U,function(Se,Ve){var vt=Se.invoke(Ve,U);return s.optional(function(){Se.assert(Ve,"typeof "+vt+'==="number"&&'+vt+">=0&&"+vt+"===("+vt+"|0)","invalid vertex count")}),vt})}else if(c)if(rr(d)){if(d)return I?new ct(I.thisDep,I.contextDep,I.propDep,function(Se,Ve){var vt=Ve.def(Se.ELEMENTS,".vertCount-",Se.OFFSET);return s.optional(function(){Se.assert(Ve,vt+">=0","invalid vertex offset/element buffer too small")}),vt}):ot(function(Se,Ve){return Ve.def(Se.ELEMENTS,".vertCount")});var G=ot(function(){return-1});return s.optional(function(){G.MISSING=!0}),G}else{var pe=new ct(d.thisDep||I.thisDep,d.contextDep||I.contextDep,d.propDep||I.propDep,function(Se,Ve){var vt=Se.ELEMENTS;return Se.OFFSET?Ve.def(vt,"?",vt,".vertCount-",Se.OFFSET,":-1"):Ve.def(vt,"?",vt,".vertCount:-1")});return s.optional(function(){pe.DYNAMIC=!0}),pe}else if(y){var me=new ct(g.thisDep,g.contextDep,g.propDep,function(Se,Ve){return Ve.def(Se.shared.vao,".currentVAO?",Se.shared.vao,".currentVAO.count:-1")});return me}return null}var K=S(),ke=P(),_e=A(Zn,!1);return{elements:d,primitive:K,count:ke,instances:_e,offset:I,vao:g,vaoActive:y,elementsActive:c,static:w}}function rt(u,i){var v=u.static,x=u.dynamic,w={};return ye.forEach(function(y){var _=he(y);function g(c,m){if(y in v){var d=c(v[y]);w[_]=ot(function(){return d})}else if(y in x){var S=x[y];w[_]=At(S,function(A,I){return m(A,I,A.invoke(I,S))})}}switch(y){case gf:case mf:case hf:case Af:case vf:case kf:case Ef:case Tf:case wf:case yf:return g(function(c){return s.commandType(c,"boolean",y,i.commandStr),c},function(c,m,d){return s.optional(function(){c.assert(m,"typeof "+d+'==="boolean"',"invalid flag "+y,c.commandStr)}),d});case bf:return g(function(c){return s.commandParameter(c,$r,"invalid "+y,i.commandStr),$r[c]},function(c,m,d){var S=c.constants.compareFuncs;return s.optional(function(){c.assert(m,d+" in "+S,"invalid "+y+", must be one of "+Object.keys($r))}),m.def(S,"[",d,"]")});case _f:return g(function(c){return s.command(et(c)&&c.length===2&&typeof c[0]=="number"&&typeof c[1]=="number"&&c[0]<=c[1],"depth range is 2d array",i.commandStr),c},function(c,m,d){s.optional(function(){c.assert(m,c.shared.isArrayLike+"("+d+")&&"+d+".length===2&&typeof "+d+'[0]==="number"&&typeof '+d+'[1]==="number"&&'+d+"[0]<="+d+"[1]","depth range must be a 2d array")});var S=m.def("+",d,"[0]"),A=m.def("+",d,"[1]");return[S,A]});case di:return g(function(c){s.commandType(c,"object","blend.func",i.commandStr);var m="srcRGB"in c?c.srcRGB:c.src,d="srcAlpha"in c?c.srcAlpha:c.src,S="dstRGB"in c?c.dstRGB:c.dst,A="dstAlpha"in c?c.dstAlpha:c.dst;return s.commandParameter(m,Pt,_+".srcRGB",i.commandStr),s.commandParameter(d,Pt,_+".srcAlpha",i.commandStr),s.commandParameter(S,Pt,_+".dstRGB",i.commandStr),s.commandParameter(A,Pt,_+".dstAlpha",i.commandStr),s.command(Mf.indexOf(m+", "+S)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+m+", "+S+")",i.commandStr),[Pt[m],Pt[S],Pt[d],Pt[A]]},function(c,m,d){var S=c.constants.blendFuncs;s.optional(function(){c.assert(m,d+"&&typeof "+d+'==="object"',"invalid blend func, must be an object")});function A(U,G){var pe=m.def('"',U,G,'" in ',d,"?",d,".",U,G,":",d,".",U);return s.optional(function(){c.assert(m,pe+" in "+S,"invalid "+y+"."+U+G+", must be one of "+Object.keys(Pt))}),pe}var I=A("src","RGB"),P=A("dst","RGB");s.optional(function(){var U=c.constants.invalidBlendCombinations;c.assert(m,U+".indexOf("+I+'+", "+'+P+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var K=m.def(S,"[",I,"]"),ke=m.def(S,"[",A("src","Alpha"),"]"),_e=m.def(S,"[",P,"]"),ce=m.def(S,"[",A("dst","Alpha"),"]");return[K,_e,ke,ce]});case ci:return g(function(c){if(typeof c=="string")return s.commandParameter(c,O,"invalid "+y,i.commandStr),[O[c],O[c]];if(typeof c=="object")return s.commandParameter(c.rgb,O,y+".rgb",i.commandStr),s.commandParameter(c.alpha,O,y+".alpha",i.commandStr),[O[c.rgb],O[c.alpha]];s.commandRaise("invalid blend.equation",i.commandStr)},function(c,m,d){var S=c.constants.blendEquations,A=m.def(),I=m.def(),P=c.cond("typeof ",d,'==="string"');return s.optional(function(){function K(ke,_e,ce){c.assert(ke,ce+" in "+S,"invalid "+_e+", must be one of "+Object.keys(O))}K(P.then,y,d),c.assert(P.else,d+"&&typeof "+d+'==="object"',"invalid "+y),K(P.else,y+".rgb",d+".rgb"),K(P.else,y+".alpha",d+".alpha")}),P.then(A,"=",I,"=",S,"[",d,"];"),P.else(A,"=",S,"[",d,".rgb];",I,"=",S,"[",d,".alpha];"),m(P),[A,I]});case pf:return g(function(c){return s.command(et(c)&&c.length===4,"blend.color must be a 4d array",i.commandStr),Lt(4,function(m){return+c[m]})},function(c,m,d){return s.optional(function(){c.assert(m,c.shared.isArrayLike+"("+d+")&&"+d+".length===4","blend.color must be a 4d array")}),Lt(4,function(S){return m.def("+",d,"[",S,"]")})});case Sf:return g(function(c){return s.commandType(c,"number",_,i.commandStr),c|0},function(c,m,d){return s.optional(function(){c.assert(m,"typeof "+d+'==="number"',"invalid stencil.mask")}),m.def(d,"|0")});case _i:return g(function(c){s.commandType(c,"object",_,i.commandStr);var m=c.cmp||"keep",d=c.ref||0,S="mask"in c?c.mask:-1;return s.commandParameter(m,$r,y+".cmp",i.commandStr),s.commandType(d,"number",y+".ref",i.commandStr),s.commandType(S,"number",y+".mask",i.commandStr),[$r[m],d,S]},function(c,m,d){var S=c.constants.compareFuncs;s.optional(function(){function K(){c.assert(m,Array.prototype.join.call(arguments,""),"invalid stencil.func")}K(d+"&&typeof ",d,'==="object"'),K('!("cmp" in ',d,")||(",d,".cmp in ",S,")")});var A=m.def('"cmp" in ',d,"?",S,"[",d,".cmp]",":",er),I=m.def(d,".ref|0"),P=m.def('"mask" in ',d,"?",d,".mask|0:-1");return[A,I,P]});case yi:case en:return g(function(c){s.commandType(c,"object",_,i.commandStr);var m=c.fail||"keep",d=c.zfail||"keep",S=c.zpass||"keep";return s.commandParameter(m,tr,y+".fail",i.commandStr),s.commandParameter(d,tr,y+".zfail",i.commandStr),s.commandParameter(S,tr,y+".zpass",i.commandStr),[y===en?br:cn,tr[m],tr[d],tr[S]]},function(c,m,d){var S=c.constants.stencilOps;s.optional(function(){c.assert(m,d+"&&typeof "+d+'==="object"',"invalid "+y)});function A(I){return s.optional(function(){c.assert(m,'!("'+I+'" in '+d+")||("+d+"."+I+" in "+S+")","invalid "+y+"."+I+", must be one of "+Object.keys(tr))}),m.def('"',I,'" in ',d,"?",S,"[",d,".",I,"]:",er)}return[y===en?br:cn,A("fail"),A("zfail"),A("zpass")]});case vi:return g(function(c){s.commandType(c,"object",_,i.commandStr);var m=c.factor|0,d=c.units|0;return s.commandType(m,"number",_+".factor",i.commandStr),s.commandType(d,"number",_+".units",i.commandStr),[m,d]},function(c,m,d){s.optional(function(){c.assert(m,d+"&&typeof "+d+'==="object"',"invalid "+y)});var S=m.def(d,".factor|0"),A=m.def(d,".units|0");return[S,A]});case xf:return g(function(c){var m=0;return c==="front"?m=cn:c==="back"&&(m=br),s.command(!!m,_,i.commandStr),m},function(c,m,d){return s.optional(function(){c.assert(m,d+'==="front"||'+d+'==="back"',"invalid cull.face")}),m.def(d,'==="front"?',cn,":",br)});case pi:return g(function(c){return s.command(typeof c=="number"&&c>=C.lineWidthDims[0]&&c<=C.lineWidthDims[1],"invalid line width, must be a positive number between "+C.lineWidthDims[0]+" and "+C.lineWidthDims[1],i.commandStr),c},function(c,m,d){return s.optional(function(){c.assert(m,"typeof "+d+'==="number"&&'+d+">="+C.lineWidthDims[0]+"&&"+d+"<="+C.lineWidthDims[1],"invalid line width")}),d});case mi:return g(function(c){return s.commandParameter(c,Li,_,i.commandStr),Li[c]},function(c,m,d){return s.optional(function(){c.assert(m,d+'==="cw"||'+d+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),m.def(d+'==="cw"?'+Df+":"+ki)});case hi:return g(function(c){return s.command(et(c)&&c.length===4,"color.mask must be length 4 array",i.commandStr),c.map(function(m){return!!m})},function(c,m,d){return s.optional(function(){c.assert(m,c.shared.isArrayLike+"("+d+")&&"+d+".length===4","invalid color.mask")}),Lt(4,function(S){return"!!"+d+"["+S+"]"})});case bi:return g(function(c){s.command(typeof c=="object"&&c,_,i.commandStr);var m="value"in c?c.value:1,d=!!c.invert;return s.command(typeof m=="number"&&m>=0&&m<=1,"sample.coverage.value must be a number between 0 and 1",i.commandStr),[m,d]},function(c,m,d){s.optional(function(){c.assert(m,d+"&&typeof "+d+'==="object"',"invalid sample.coverage")});var S=m.def('"value" in ',d,"?+",d,".value:1"),A=m.def("!!",d,".invert");return[S,A]})}}),w}function Be(u,i){var v=u.static,x=u.dynamic,w={};return Object.keys(v).forEach(function(y){var _=v[y],g;if(typeof _=="number"||typeof _=="boolean")g=ot(function(){return _});else if(typeof _=="function"){var c=_._reglType;c==="texture2d"||c==="textureCube"?g=ot(function(m){return m.link(_)}):c==="framebuffer"||c==="framebufferCube"?(s.command(_.color.length>0,'missing color attachment for framebuffer sent to uniform "'+y+'"',i.commandStr),g=ot(function(m){return m.link(_.color[0])})):s.commandRaise('invalid data for uniform "'+y+'"',i.commandStr)}else et(_)?g=ot(function(m){var d=m.global.def("[",Lt(_.length,function(S){return s.command(typeof _[S]=="number"||typeof _[S]=="boolean","invalid uniform "+y,m.commandStr),_[S]}),"]");return d}):s.commandRaise('invalid or missing data for uniform "'+y+'"',i.commandStr);g.value=_,w[y]=g}),Object.keys(x).forEach(function(y){var _=x[y];w[y]=At(_,function(g,c){return g.invoke(c,_)})}),w}function st(u,i){var v=u.static,x=u.dynamic,w={};return Object.keys(v).forEach(function(y){var _=v[y],g=f.id(y),c=new E;if(oa(_))c.state=Mr,c.buffer=M.getBuffer(M.create(_,Ur,!1,!0)),c.type=0;else{var m=M.getBuffer(_);if(m)c.state=Mr,c.buffer=m,c.type=0;else if(s.command(typeof _=="object"&&_,"invalid data for attribute "+y,i.commandStr),"constant"in _){var d=_.constant;c.buffer="null",c.state=oi,typeof d=="number"?c.x=d:(s.command(et(d)&&d.length>0&&d.length<=4,"invalid constant for attribute "+y,i.commandStr),Nr.forEach(function(_e,ce){ce<d.length&&(c[_e]=d[ce])}))}else{oa(_.buffer)?m=M.getBuffer(M.create(_.buffer,Ur,!1,!0)):m=M.getBuffer(_.buffer),s.command(!!m,'missing buffer for attribute "'+y+'"',i.commandStr);var S=_.offset|0;s.command(S>=0,'invalid offset for attribute "'+y+'"',i.commandStr);var A=_.stride|0;s.command(A>=0&&A<256,'invalid stride for attribute "'+y+'", must be integer betweeen [0, 255]',i.commandStr);var I=_.size|0;s.command(!("size"in _)||I>0&&I<=4,'invalid size for attribute "'+y+'", must be 1,2,3,4',i.commandStr);var P=!!_.normalized,K=0;"type"in _&&(s.commandParameter(_.type,sr,"invalid type for attribute "+y,i.commandStr),K=sr[_.type]);var ke=_.divisor|0;s.optional(function(){"divisor"in _&&(s.command(ke===0||W,'cannot specify divisor for attribute "'+y+'", instancing not supported',i.commandStr),s.command(ke>=0,'invalid divisor for attribute "'+y+'"',i.commandStr));var _e=i.commandStr,ce=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(_).forEach(function(U){s.command(ce.indexOf(U)>=0,'unknown parameter "'+U+'" for attribute pointer "'+y+'" (valid parameters are '+ce+")",_e)})}),c.buffer=m,c.state=Mr,c.size=I,c.normalized=P,c.type=K||m.dtype,c.offset=S,c.stride=A,c.divisor=ke}}w[y]=ot(function(_e,ce){var U=_e.attribCache;if(g in U)return U[g];var G={isStream:!1};return Object.keys(c).forEach(function(pe){G[pe]=c[pe]}),c.buffer&&(G.buffer=_e.link(c.buffer),G.type=G.type||G.buffer+".dtype"),U[g]=G,G})}),Object.keys(x).forEach(function(y){var _=x[y];function g(c,m){var d=c.invoke(m,_),S=c.shared,A=c.constants,I=S.isBufferArgs,P=S.buffer;s.optional(function(){c.assert(m,d+"&&(typeof "+d+'==="object"||typeof '+d+'==="function")&&('+I+"("+d+")||"+P+".getBuffer("+d+")||"+P+".getBuffer("+d+".buffer)||"+I+"("+d+'.buffer)||("constant" in '+d+"&&(typeof "+d+'.constant==="number"||'+S.isArrayLike+"("+d+".constant))))",'invalid dynamic attribute "'+y+'"')});var K={isStream:m.def(!1)},ke=new E;ke.state=Mr,Object.keys(ke).forEach(function(G){K[G]=m.def(""+ke[G])});var _e=K.buffer,ce=K.type;m("if(",I,"(",d,")){",K.isStream,"=true;",_e,"=",P,".createStream(",Ur,",",d,");",ce,"=",_e,".dtype;","}else{",_e,"=",P,".getBuffer(",d,");","if(",_e,"){",ce,"=",_e,".dtype;",'}else if("constant" in ',d,"){",K.state,"=",oi,";","if(typeof "+d+'.constant === "number"){',K[Nr[0]],"=",d,".constant;",Nr.slice(1).map(function(G){return K[G]}).join("="),"=0;","}else{",Nr.map(function(G,pe){return K[G]+"="+d+".constant.length>"+pe+"?"+d+".constant["+pe+"]:0;"}).join(""),"}}else{","if(",I,"(",d,".buffer)){",_e,"=",P,".createStream(",Ur,",",d,".buffer);","}else{",_e,"=",P,".getBuffer(",d,".buffer);","}",ce,'="type" in ',d,"?",A.glTypes,"[",d,".type]:",_e,".dtype;",K.normalized,"=!!",d,".normalized;");function U(G){m(K[G],"=",d,".",G,"|0;")}return U("size"),U("offset"),U("stride"),U("divisor"),m("}}"),m.exit("if(",K.isStream,"){",P,".destroyStream(",_e,");","}"),K}w[y]=At(_,g)}),w}function Ke(u){var i=u.static,v=u.dynamic,x={};return Object.keys(i).forEach(function(w){var y=i[w];x[w]=ot(function(_,g){return typeof y=="number"||typeof y=="boolean"?""+y:_.link(y)})}),Object.keys(v).forEach(function(w){var y=v[w];x[w]=At(y,function(_,g){return _.invoke(g,y)})}),x}function ft(u,i,v,x,w){var y=u.static,_=u.dynamic;s.optional(function(){var U=[hr,rn,nn,mr,pr,qn,vr,Zn,tn,an].concat(ye);function G(pe){Object.keys(pe).forEach(function(me){s.command(U.indexOf(me)>=0,'unknown parameter "'+me+'"',w.commandStr)})}G(y),G(_)});var g=Re(u,i),c=se(u),m=Ae(u,c,w),d=tt(u,w),S=rt(u,w),A=Ne(u,w,g);function I(U){var G=m[U];G&&(S[U]=G)}I(jt),I(he(Yn));var P=Object.keys(S).length>0,K={framebuffer:c,draw:d,shader:A,state:S,dirty:P,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(K.profile=ie(u),K.uniforms=Be(v,w),K.drawVAO=K.scopeVAO=d.vao,!K.drawVAO&&A.program&&!g&&p.angle_instanced_arrays&&d.static.elements){var ke=!0,_e=A.program.attributes.map(function(U){var G=i.static[U];return ke=ke&&!!G,G});if(ke&&_e.length>0){var ce=q.getVAO(q.createVAO({attributes:_e,elements:d.static.elements}));K.drawVAO=new ct(null,null,null,function(U,G){return U.link(ce)}),K.useVAO=!0}}return g?K.useVAO=!0:K.attributes=st(i,w),K.context=Ke(x),K}function ut(u,i,v){var x=u.shared,w=x.context,y=u.scope();Object.keys(v).forEach(function(_){i.save(w,"."+_);var g=v[_],c=g.append(u,i);Array.isArray(c)?y(w,".",_,"=[",c.join(),"];"):y(w,".",_,"=",c,";")}),i(y)}function lt(u,i,v,x){var w=u.shared,y=w.gl,_=w.framebuffer,g;ue&&(g=i.def(w.extensions,".webgl_draw_buffers"));var c=u.constants,m=c.drawBuffer,d=c.backBuffer,S;v?S=v.append(u,i):S=i.def(_,".next"),x||i("if(",S,"!==",_,".cur){"),i("if(",S,"){",y,".bindFramebuffer(",Nf,",",S,".framebuffer);"),ue&&i(g,".drawBuffersWEBGL(",m,"[",S,".colorAttachments.length]);"),i("}else{",y,".bindFramebuffer(",Nf,",null);"),ue&&i(g,".drawBuffersWEBGL(",d,");"),i("}",_,".cur=",S,";"),x||i("}")}function dt(u,i,v){var x=u.shared,w=x.gl,y=u.current,_=u.next,g=x.current,c=x.next,m=u.cond(g,".dirty");ye.forEach(function(d){var S=he(d);if(!(S in v.state)){var A,I;if(S in _){A=_[S],I=y[S];var P=Lt(fe[S].length,function(ke){return m.def(A,"[",ke,"]")});m(u.cond(P.map(function(ke,_e){return ke+"!=="+I+"["+_e+"]"}).join("||")).then(w,".",N[S],"(",P,");",P.map(function(ke,_e){return I+"["+_e+"]="+ke}).join(";"),";"))}else{A=m.def(c,".",S);var K=u.cond(A,"!==",g,".",S);m(K),S in B?K(u.cond(A).then(w,".enable(",B[S],");").else(w,".disable(",B[S],");"),g,".",S,"=",A,";"):K(w,".",N[S],"(",A,");",g,".",S,"=",A,";")}}}),Object.keys(v.state).length===0&&m(g,".dirty=false;"),i(m)}function mt(u,i,v,x){var w=u.shared,y=u.current,_=w.current,g=w.gl;Pf(Object.keys(v)).forEach(function(c){var m=v[c];if(!(x&&!x(m))){var d=m.append(u,i);if(B[c]){var S=B[c];rr(m)?d?i(g,".enable(",S,");"):i(g,".disable(",S,");"):i(u.cond(d).then(g,".enable(",S,");").else(g,".disable(",S,");")),i(_,".",c,"=",d,";")}else if(et(d)){var A=y[c];i(g,".",N[c],"(",d,");",d.map(function(I,P){return A+"["+P+"]="+I}).join(";"),";")}else i(g,".",N[c],"(",d,");",_,".",c,"=",d,";")}})}function nt(u,i){W&&(u.instancing=i.def(u.shared.extensions,".angle_instanced_arrays"))}function De(u,i,v,x,w){var y=u.shared,_=u.stats,g=y.current,c=y.timer,m=v.profile;function d(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var S,A;function I(U){S=i.def(),U(S,"=",d(),";"),typeof w=="string"?U(_,".count+=",w,";"):U(_,".count++;"),V&&(x?(A=i.def(),U(A,"=",c,".getNumPendingQueries();")):U(c,".beginQuery(",_,");"))}function P(U){U(_,".cpuTime+=",d(),"-",S,";"),V&&(x?U(c,".pushScopeStats(",A,",",c,".getNumPendingQueries(),",_,");"):U(c,".endQuery();"))}function K(U){var G=i.def(g,".profile");i(g,".profile=",U,";"),i.exit(g,".profile=",G,";")}var ke;if(m){if(rr(m)){m.enable?(I(i),P(i.exit),K("true")):K("false");return}ke=m.append(u,i),K(ke)}else ke=i.def(g,".profile");var _e=u.block();I(_e),i("if(",ke,"){",_e,"}");var ce=u.block();P(ce),i.exit("if(",ke,"){",ce,"}")}function pt(u,i,v,x,w){var y=u.shared;function _(c){switch(c){case Qn:case ea:case na:return 2;case Kn:case ta:case aa:return 3;case Jn:case ra:case ia:return 4;default:return 1}}function g(c,m,d){var S=y.gl,A=i.def(c,".location"),I=i.def(y.attributes,"[",A,"]"),P=d.state,K=d.buffer,ke=[d.x,d.y,d.z,d.w],_e=["buffer","normalized","offset","stride"];function ce(){i("if(!",I,".buffer){",S,".enableVertexAttribArray(",A,");}");var G=d.type,pe;if(d.size?pe=i.def(d.size,"||",m):pe=m,i("if(",I,".type!==",G,"||",I,".size!==",pe,"||",_e.map(function(Se){return I+"."+Se+"!=="+d[Se]}).join("||"),"){",S,".bindBuffer(",Ur,",",K,".buffer);",S,".vertexAttribPointer(",[A,pe,G,d.normalized,d.stride,d.offset],");",I,".type=",G,";",I,".size=",pe,";",_e.map(function(Se){return I+"."+Se+"="+d[Se]+";"}).join(""),"}"),W){var me=d.divisor;i("if(",I,".divisor!==",me,"){",u.instancing,".vertexAttribDivisorANGLE(",[A,me],");",I,".divisor=",me,";}")}}function U(){i("if(",I,".buffer){",S,".disableVertexAttribArray(",A,");",I,".buffer=null;","}if(",Nr.map(function(G,pe){return I+"."+G+"!=="+ke[pe]}).join("||"),"){",S,".vertexAttrib4f(",A,",",ke,");",Nr.map(function(G,pe){return I+"."+G+"="+ke[pe]+";"}).join(""),"}")}P===Mr?ce():P===oi?U():(i("if(",P,"===",Mr,"){"),ce(),i("}else{"),U(),i("}"))}x.forEach(function(c){var m=c.name,d=v.attributes[m],S;if(d){if(!w(d))return;S=d.append(u,i)}else{if(!w(Uf))return;var A=u.scopeAttrib(m);s.optional(function(){u.assert(i,A+".state","missing attribute "+m)}),S={},Object.keys(new E).forEach(function(I){S[I]=i.def(A,".",I)})}g(u.link(c),_(c.info.type),S)})}function He(u,i,v,x,w,y){for(var _=u.shared,g=_.gl,c={},m,d=0;d<x.length;++d){var S=x[d],A=S.name,I=S.info.type,P=S.info.size,K=v.uniforms[A];if(P>1){if(!K)continue;var ke=A.replace("[0]","");if(c[ke])continue;c[ke]=1}var _e=u.link(S),ce=_e+".location",U;if(K){if(!w(K))continue;if(rr(K)){var G=K.value;if(s.command(G!==null&&typeof G!="undefined",'missing uniform "'+A+'"',u.commandStr),I===un||I===ln){s.command(typeof G=="function"&&(I===un&&(G._reglType==="texture2d"||G._reglType==="framebuffer")||I===ln&&(G._reglType==="textureCube"||G._reglType==="framebufferCube")),"invalid texture for uniform "+A,u.commandStr);var pe=u.link(G._texture||G.color[0]._texture);i(g,".uniform1i(",ce,",",pe+".bind());"),i.exit(pe,".unbind();")}else if(I===on||I===fn||I===sn){s.optional(function(){s.command(et(G),"invalid matrix for uniform "+A,u.commandStr),s.command(I===on&&G.length===4||I===fn&&G.length===9||I===sn&&G.length===16,"invalid length for matrix uniform "+A,u.commandStr)});var me=u.global.def("new Float32Array(["+Array.prototype.slice.call(G)+"])"),Se=2;I===fn?Se=3:I===sn&&(Se=4),i(g,".uniformMatrix",Se,"fv(",ce,",false,",me,");")}else{switch(I){case Ti:P===1?s.commandType(G,"number","uniform "+A,u.commandStr):s.command(et(G)&&G.length===P,"uniform "+A,u.commandStr),m="1f";break;case Qn:s.command(et(G)&&G.length&&G.length%2==0&&G.length<=P*2,"uniform "+A,u.commandStr),m="2f";break;case Kn:s.command(et(G)&&G.length&&G.length%3==0&&G.length<=P*3,"uniform "+A,u.commandStr),m="3f";break;case Jn:s.command(et(G)&&G.length&&G.length%4==0&&G.length<=P*4,"uniform "+A,u.commandStr),m="4f";break;case Ai:P===1?s.commandType(G,"boolean","uniform "+A,u.commandStr):s.command(et(G)&&G.length===P,"uniform "+A,u.commandStr),m="1i";break;case wi:P===1?s.commandType(G,"number","uniform "+A,u.commandStr):s.command(et(G)&&G.length===P,"uniform "+A,u.commandStr),m="1i";break;case na:s.command(et(G)&&G.length&&G.length%2==0&&G.length<=P*2,"uniform "+A,u.commandStr),m="2i";break;case ea:s.command(et(G)&&G.length&&G.length%2==0&&G.length<=P*2,"uniform "+A,u.commandStr),m="2i";break;case aa:s.command(et(G)&&G.length&&G.length%3==0&&G.length<=P*3,"uniform "+A,u.commandStr),m="3i";break;case ta:s.command(et(G)&&G.length&&G.length%3==0&&G.length<=P*3,"uniform "+A,u.commandStr),m="3i";break;case ia:s.command(et(G)&&G.length&&G.length%4==0&&G.length<=P*4,"uniform "+A,u.commandStr),m="4i";break;case ra:s.command(et(G)&&G.length&&G.length%4==0&&G.length<=P*4,"uniform "+A,u.commandStr),m="4i";break}P>1?(m+="v",G=u.global.def("["+Array.prototype.slice.call(G)+"]")):G=et(G)?Array.prototype.slice.call(G):G,i(g,".uniform",m,"(",ce,",",G,");")}continue}else U=K.append(u,i)}else{if(!w(Uf))continue;U=i.def(_.uniforms,"[",f.id(A),"]")}I===un?(s(!Array.isArray(U),"must specify a scalar prop for textures"),i("if(",U,"&&",U,'._reglType==="framebuffer"){',U,"=",U,".color[0];","}")):I===ln&&(s(!Array.isArray(U),"must specify a scalar prop for cube maps"),i("if(",U,"&&",U,'._reglType==="framebufferCube"){',U,"=",U,".color[0];","}")),s.optional(function(){function Rt(St,fa){u.assert(i,St,'bad data or missing for uniform "'+A+'".  '+fa)}function xr(St,fa){fa===1&&s(!Array.isArray(U),"must not specify an array type for uniform"),Rt("Array.isArray("+U+") && typeof "+U+'[0]===" '+St+'" || typeof '+U+'==="'+St+'"',"invalid type, expected "+St)}function Dt(St,fa,sa){Array.isArray(U)?s(U.length&&U.length%St==0&&U.length<=St*sa,"must have length of "+(sa===1?"":"n * ")+St):Rt(_.isArrayLike+"("+U+")&&"+U+".length && "+U+".length % "+St+" === 0 && "+U+".length<="+St*sa,"invalid vector, should have length of "+(sa===1?"":"n * ")+St,u.commandStr)}function Wf(St){s(!Array.isArray(U),"must not specify a value type"),Rt("typeof "+U+'==="function"&&'+U+'._reglType==="texture'+(St===Of?"2d":"Cube")+'"',"invalid texture type",u.commandStr)}switch(I){case wi:xr("number",P);break;case ea:Dt(2,"number",P);break;case ta:Dt(3,"number",P);break;case ra:Dt(4,"number",P);break;case Ti:xr("number",P);break;case Qn:Dt(2,"number",P);break;case Kn:Dt(3,"number",P);break;case Jn:Dt(4,"number",P);break;case Ai:xr("boolean",P);break;case na:Dt(2,"boolean",P);break;case aa:Dt(3,"boolean",P);break;case ia:Dt(4,"boolean",P);break;case on:Dt(4,"number",P);break;case fn:Dt(9,"number",P);break;case sn:Dt(16,"number",P);break;case un:Wf(Of);break;case ln:Wf(Pc);break}});var Ve=1;switch(I){case un:case ln:var vt=i.def(U,"._texture");i(g,".uniform1i(",ce,",",vt,".bind());"),i.exit(vt,".unbind();");continue;case wi:case Ai:m="1i";break;case ea:case na:m="2i",Ve=2;break;case ta:case aa:m="3i",Ve=3;break;case ra:case ia:m="4i",Ve=4;break;case Ti:m="1f";break;case Qn:m="2f",Ve=2;break;case Kn:m="3f",Ve=3;break;case Jn:m="4f",Ve=4;break;case on:m="Matrix2fv";break;case fn:m="Matrix3fv";break;case sn:m="Matrix4fv";break}if(m.indexOf("Matrix")===-1&&P>1&&(m+="v",Ve=1),m.charAt(0)==="M"){i(g,".uniform",m,"(",ce,",");var yr=Math.pow(I-on+2,2),Vt=u.global.def("new Float32Array(",yr,")");Array.isArray(U)?i("false,(",Lt(yr,function(Rt){return Vt+"["+Rt+"]="+U[Rt]}),",",Vt,")"):i("false,(Array.isArray(",U,")||",U," instanceof Float32Array)?",U,":(",Lt(yr,function(Rt){return Vt+"["+Rt+"]="+U+"["+Rt+"]"}),",",Vt,")"),i(");")}else if(Ve>1){for(var $t=[],nr=[],gr=0;gr<Ve;++gr)Array.isArray(U)?nr.push(U[gr]):nr.push(i.def(U+"["+gr+"]")),y&&$t.push(i.def());y&&i("if(!",u.batchId,"||",$t.map(function(Rt,xr){return Rt+"!=="+nr[xr]}).join("||"),"){",$t.map(function(Rt,xr){return Rt+"="+nr[xr]+";"}).join("")),i(g,".uniform",m,"(",ce,",",nr.join(","),");"),y&&i("}")}else{if(s(!Array.isArray(U),"uniform value must not be an array"),y){var Xf=i.def();i("if(!",u.batchId,"||",Xf,"!==",U,"){",Xf,"=",U,";")}i(g,".uniform",m,"(",ce,",",U,");"),y&&i("}")}}}function we(u,i,v,x){var w=u.shared,y=w.gl,_=w.draw,g=x.draw;function c(){var pe=g.elements,me,Se=i;return pe?((pe.contextDep&&x.contextDynamic||pe.propDep)&&(Se=v),me=pe.append(u,Se),g.elementsActive&&Se("if("+me+")"+y+".bindBuffer("+Ei+","+me+".buffer.buffer);")):(me=Se.def(),Se(me,"=",_,".",mr,";","if(",me,"){",y,".bindBuffer(",Ei,",",me,".buffer.buffer);}","else if(",w.vao,".currentVAO){",me,"=",u.shared.elements+".getElements("+w.vao,".currentVAO.elements);",$?"":"if("+me+")"+y+".bindBuffer("+Ei+","+me+".buffer.buffer);","}")),me}function m(){var pe=g.count,me,Se=i;return pe?((pe.contextDep&&x.contextDynamic||pe.propDep)&&(Se=v),me=pe.append(u,Se),s.optional(function(){pe.MISSING&&u.assert(i,"false","missing vertex count"),pe.DYNAMIC&&u.assert(Se,me+">=0","missing vertex count")})):(me=Se.def(_,".",vr),s.optional(function(){u.assert(Se,me+">=0","missing vertex count")})),me}var d=c();function S(pe){var me=g[pe];return me?me.contextDep&&x.contextDynamic||me.propDep?me.append(u,v):me.append(u,i):i.def(_,".",pe)}var A=S(pr),I=S(qn),P=m();if(typeof P=="number"){if(P===0)return}else v("if(",P,"){"),v.exit("}");var K,ke;W&&(K=S(Zn),ke=u.instancing);var _e=d+".type",ce=g.elements&&rr(g.elements)&&!g.vaoActive;function U(){function pe(){v(ke,".drawElementsInstancedANGLE(",[A,P,_e,I+"<<(("+_e+"-"+lf+")>>1)",K],");")}function me(){v(ke,".drawArraysInstancedANGLE(",[A,I,P,K],");")}d&&d!=="null"?ce?pe():(v("if(",d,"){"),pe(),v("}else{"),me(),v("}")):me()}function G(){function pe(){v(y+".drawElements("+[A,P,_e,I+"<<(("+_e+"-"+lf+")>>1)"]+");")}function me(){v(y+".drawArrays("+[A,I,P]+");")}d&&d!=="null"?ce?pe():(v("if(",d,"){"),pe(),v("}else{"),me(),v("}")):me()}W&&(typeof K!="number"||K>=0)?typeof K=="string"?(v("if(",K,">0){"),U(),v("}else if(",K,"<0){"),G(),v("}")):U():G()}function Me(u,i,v,x,w){var y=Le(),_=y.proc("body",w);return s.optional(function(){y.commandStr=i.commandStr,y.command=y.link(i.commandStr)}),W&&(y.instancing=_.def(y.shared.extensions,".angle_instanced_arrays")),u(y,_,v,x),y.compile().body}function Ue(u,i,v,x){nt(u,i),v.useVAO?v.drawVAO?i(u.shared.vao,".setVAO(",v.drawVAO.append(u,i),");"):i(u.shared.vao,".setVAO(",u.shared.vao,".targetVAO);"):(i(u.shared.vao,".setVAO(null);"),pt(u,i,v,x.attributes,function(){return!0})),He(u,i,v,x.uniforms,function(){return!0},!1),we(u,i,i,v)}function at(u,i){var v=u.proc("draw",1);nt(u,v),ut(u,v,i.context),lt(u,v,i.framebuffer),dt(u,v,i),mt(u,v,i.state),De(u,v,i,!1,!0);var x=i.shader.progVar.append(u,v);if(v(u.shared.gl,".useProgram(",x,".program);"),i.shader.program)Ue(u,v,i,i.shader.program);else{v(u.shared.vao,".setVAO(null);");var w=u.global.def("{}"),y=v.def(x,".id"),_=v.def(w,"[",y,"]");v(u.cond(_).then(_,".call(this,a0);").else(_,"=",w,"[",y,"]=",u.link(function(g){return Me(Ue,u,i,g,1)}),"(",x,");",_,".call(this,a0);"))}Object.keys(i.state).length>0&&v(u.shared.current,".dirty=true;"),u.shared.vao&&v(u.shared.vao,".setVAO(null);")}function Ut(u,i,v,x){u.batchId="a1",nt(u,i);function w(){return!0}pt(u,i,v,x.attributes,w),He(u,i,v,x.uniforms,w,!1),we(u,i,i,v)}function _r(u,i,v,x){nt(u,i);var w=v.contextDep,y=i.def(),_="a0",g="a1",c=i.def();u.shared.props=c,u.batchId=y;var m=u.scope(),d=u.scope();i(m.entry,"for(",y,"=0;",y,"<",g,";++",y,"){",c,"=",_,"[",y,"];",d,"}",m.exit);function S(_e){return _e.contextDep&&w||_e.propDep}function A(_e){return!S(_e)}if(v.needsContext&&ut(u,d,v.context),v.needsFramebuffer&&lt(u,d,v.framebuffer),mt(u,d,v.state,S),v.profile&&S(v.profile)&&De(u,d,v,!1,!0),x)v.useVAO?v.drawVAO?S(v.drawVAO)?d(u.shared.vao,".setVAO(",v.drawVAO.append(u,d),");"):m(u.shared.vao,".setVAO(",v.drawVAO.append(u,m),");"):m(u.shared.vao,".setVAO(",u.shared.vao,".targetVAO);"):(m(u.shared.vao,".setVAO(null);"),pt(u,m,v,x.attributes,A),pt(u,d,v,x.attributes,S)),He(u,m,v,x.uniforms,A,!1),He(u,d,v,x.uniforms,S,!0),we(u,m,d,v);else{var I=u.global.def("{}"),P=v.shader.progVar.append(u,d),K=d.def(P,".id"),ke=d.def(I,"[",K,"]");d(u.shared.gl,".useProgram(",P,".program);","if(!",ke,"){",ke,"=",I,"[",K,"]=",u.link(function(_e){return Me(Ut,u,v,_e,2)}),"(",P,");}",ke,".call(this,a0[",y,"],",y,");")}}function h(u,i){var v=u.proc("batch",2);u.batchId="0",nt(u,v);var x=!1,w=!0;Object.keys(i.context).forEach(function(I){x=x||i.context[I].propDep}),x||(ut(u,v,i.context),w=!1);var y=i.framebuffer,_=!1;y?(y.propDep?x=_=!0:y.contextDep&&x&&(_=!0),_||lt(u,v,y)):lt(u,v,null),i.state.viewport&&i.state.viewport.propDep&&(x=!0);function g(I){return I.contextDep&&x||I.propDep}dt(u,v,i),mt(u,v,i.state,function(I){return!g(I)}),(!i.profile||!g(i.profile))&&De(u,v,i,!1,"a1"),i.contextDep=x,i.needsContext=w,i.needsFramebuffer=_;var c=i.shader.progVar;if(c.contextDep&&x||c.propDep)_r(u,v,i,null);else{var m=c.append(u,v);if(v(u.shared.gl,".useProgram(",m,".program);"),i.shader.program)_r(u,v,i,i.shader.program);else{v(u.shared.vao,".setVAO(null);");var d=u.global.def("{}"),S=v.def(m,".id"),A=v.def(d,"[",S,"]");v(u.cond(A).then(A,".call(this,a0,a1);").else(A,"=",d,"[",S,"]=",u.link(function(I){return Me(_r,u,i,I,2)}),"(",m,");",A,".call(this,a0,a1);"))}}Object.keys(i.state).length>0&&v(u.shared.current,".dirty=true;"),u.shared.vao&&v(u.shared.vao,".setVAO(null);")}function R(u,i){var v=u.proc("scope",3);u.batchId="a2";var x=u.shared,w=x.current;ut(u,v,i.context),i.framebuffer&&i.framebuffer.append(u,v),Pf(Object.keys(i.state)).forEach(function(_){var g=i.state[_],c=g.append(u,v);et(c)?c.forEach(function(m,d){v.set(u.next[_],"["+d+"]",m)}):v.set(x.next,"."+_,c)}),De(u,v,i,!0,!0),[mr,qn,vr,Zn,pr].forEach(function(_){var g=i.draw[_];!g||v.set(x.draw,"."+_,""+g.append(u,v))}),Object.keys(i.uniforms).forEach(function(_){var g=i.uniforms[_].append(u,v);Array.isArray(g)&&(g="["+g.join()+"]"),v.set(x.uniforms,"["+f.id(_)+"]",g)}),Object.keys(i.attributes).forEach(function(_){var g=i.attributes[_].append(u,v),c=u.scopeAttrib(_);Object.keys(new E).forEach(function(m){v.set(c,"."+m,g[m])})}),i.scopeVAO&&v.set(x.vao,".targetVAO",i.scopeVAO.append(u,v));function y(_){var g=i.shader[_];g&&v.set(x.shader,"."+_,g.append(u,v))}y(rn),y(nn),Object.keys(i.state).length>0&&(v(w,".dirty=true;"),v.exit(w,".dirty=true;")),v("a1(",u.shared.context,",a0,",u.batchId,");")}function k(u){if(!(typeof u!="object"||et(u))){for(var i=Object.keys(u),v=0;v<i.length;++v)if(kt.isDynamic(u[i[v]]))return!0;return!1}}function de(u,i,v){var x=i.static[v];if(!x||!k(x))return;var w=u.global,y=Object.keys(x),_=!1,g=!1,c=!1,m=u.global.def("{}");y.forEach(function(S){var A=x[S];if(kt.isDynamic(A)){typeof A=="function"&&(A=x[S]=kt.unbox(A));var I=At(A,null);_=_||I.thisDep,c=c||I.propDep,g=g||I.contextDep}else{switch(w(m,".",S,"="),typeof A){case"number":w(A);break;case"string":w('"',A,'"');break;case"object":Array.isArray(A)&&w("[",A.join(),"]");break;default:w(u.link(A));break}w(";")}});function d(S,A){y.forEach(function(I){var P=x[I];if(!!kt.isDynamic(P)){var K=S.invoke(A,P);A(m,".",I,"=",K,";")}})}i.dynamic[v]=new kt.DynamicVariable(Wn,{thisDep:_,contextDep:g,propDep:c,ref:m,append:d}),delete i.static[v]}function Ge(u,i,v,x,w){var y=Le();y.stats=y.link(w),Object.keys(i.static).forEach(function(g){de(y,i,g)}),Nc.forEach(function(g){de(y,u,g)});var _=ft(u,i,v,x,y);return at(y,_),R(y,_),h(y,_),n(y.compile(),{destroy:function(){_.shader.program.destroy()}})}return{next:ae,current:fe,procs:function(){var u=Le(),i=u.proc("poll"),v=u.proc("refresh"),x=u.block();i(x),v(x);var w=u.shared,y=w.gl,_=w.next,g=w.current;x(g,".dirty=false;"),lt(u,i),lt(u,v,null,!0);var c;W&&(c=u.link(W)),p.oes_vertex_array_object&&v(u.link(p.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var m=0;m<C.maxAttributes;++m){var d=v.def(w.attributes,"[",m,"]"),S=u.cond(d,".buffer");S.then(y,".enableVertexAttribArray(",m,");",y,".bindBuffer(",Ur,",",d,".buffer.buffer);",y,".vertexAttribPointer(",m,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(y,".disableVertexAttribArray(",m,");",y,".vertexAttrib4f(",m,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),v(S),W&&v(c,".vertexAttribDivisorANGLE(",m,",",d,".divisor);")}return v(u.shared.vao,".currentVAO=null;",u.shared.vao,".setVAO(",u.shared.vao,".targetVAO);"),Object.keys(B).forEach(function(A){var I=B[A],P=x.def(_,".",A),K=u.block();K("if(",P,"){",y,".enable(",I,")}else{",y,".disable(",I,")}",g,".",A,"=",P,";"),v(K),i("if(",P,"!==",g,".",A,"){",K,"}")}),Object.keys(N).forEach(function(A){var I=N[A],P=fe[A],K,ke,_e=u.block();if(_e(y,".",I,"("),et(P)){var ce=P.length;K=u.global.def(_,".",A),ke=u.global.def(g,".",A),_e(Lt(ce,function(U){return K+"["+U+"]"}),");",Lt(ce,function(U){return ke+"["+U+"]="+K+"["+U+"];"}).join("")),i("if(",Lt(ce,function(U){return K+"["+U+"]!=="+ke+"["+U+"]"}).join("||"),"){",_e,"}")}else K=x.def(_,".",A),ke=x.def(g,".",A),_e(K,");",g,".",A,"=",K,";"),i("if(",K,"!==",ke,"){",_e,"}");v(_e)}),u.compile()}(),compile:Ge}}function td(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var rd=34918,nd=34919,$f=35007,ad=function(a,f){if(!f.ext_disjoint_timer_query)return null;var p=[];function C(){return p.pop()||f.ext_disjoint_timer_query.createQueryEXT()}function M(W){p.push(W)}var L=[];function F(W){var ue=C();f.ext_disjoint_timer_query.beginQueryEXT($f,ue),L.push(ue),V(L.length-1,L.length,W)}function H(){f.ext_disjoint_timer_query.endQueryEXT($f)}function z(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var q=[];function Q(){return q.pop()||new z}function Z(W){q.push(W)}var J=[];function V(W,ue,$){var fe=Q();fe.startQueryIndex=W,fe.endQueryIndex=ue,fe.sum=0,fe.stats=$,J.push(fe)}var Y=[],E=[];function O(){var W,ue,$=L.length;if($!==0){E.length=Math.max(E.length,$+1),Y.length=Math.max(Y.length,$+1),Y[0]=0,E[0]=0;var fe=0;for(W=0,ue=0;ue<L.length;++ue){var ae=L[ue];f.ext_disjoint_timer_query.getQueryObjectEXT(ae,nd)?(fe+=f.ext_disjoint_timer_query.getQueryObjectEXT(ae,rd),M(ae)):L[W++]=ae,Y[ue+1]=fe,E[ue+1]=W}for(L.length=W,W=0,ue=0;ue<J.length;++ue){var ye=J[ue],B=ye.startQueryIndex,N=ye.endQueryIndex;ye.sum+=Y[N]-Y[B];var he=E[B],ee=E[N];ee===he?(ye.stats.gpuTime+=ye.sum/1e6,Z(ye)):(ye.startQueryIndex=he,ye.endQueryIndex=ee,J[W++]=ye)}J.length=W}}return{beginQuery:F,endQuery:H,pushScopeStats:V,update:O,getNumPendingQueries:function(){return L.length},clear:function(){p.push.apply(p,L);for(var W=0;W<p.length;W++)f.ext_disjoint_timer_query.deleteQueryEXT(p[W]);L.length=0,p.length=0},restore:function(){L.length=0,p.length=0}}},id=16384,od=256,fd=1024,sd=34962,zf="webglcontextlost",Hf="webglcontextrestored",jf=1,ud=2,ld=3;function Vf(a,f){for(var p=0;p<a.length;++p)if(a[p]===f)return p;return-1}function cd(a){var f=uu(a);if(!f)return null;var p=f.gl,C=p.getContextAttributes(),M=p.isContextLost(),L=lu(p,f);if(!L)return null;var F=au(),H=td(),z=L.extensions,q=ad(p,z),Q=Qi(),Z=p.drawingBufferWidth,J=p.drawingBufferHeight,V={tick:0,time:0,viewportWidth:Z,viewportHeight:J,framebufferWidth:Z,framebufferHeight:J,drawingBufferWidth:Z,drawingBufferHeight:J,pixelRatio:f.pixelRatio},Y={},E={elements:null,primitive:4,count:-1,offset:0,instances:-1},O=Qu(p,z),W=hl(p,H,f,fe),ue=Al(p,z,W,H),$=Ac(p,z,O,H,W,ue,E);function fe(we){return $.destroyBuffer(we)}var ae=Cc(p,F,H,f),ye=rc(p,z,O,function(){he.procs.poll()},V,H,f),B=nc(p,z,O,H,f),N=Tc(p,z,O,ye,B,H),he=ed(p,F,z,O,W,ue,ye,N,Y,$,ae,E,V,q,f),ee=Dc(p,N,he.procs.poll,V,C,z,O),X=he.next,te=p.canvas,re=[],Ce=[],Le=[],ie=[f.onDestroy],se=null;function Ae(){if(re.length===0){q&&q.update(),se=null;return}se=Da.next(Ae),mt();for(var we=re.length-1;we>=0;--we){var Me=re[we];Me&&Me(V,null,0)}p.flush(),q&&q.update()}function Re(){!se&&re.length>0&&(se=Da.next(Ae))}function Ne(){se&&(Da.cancel(Ae),se=null)}function tt(we){we.preventDefault(),M=!0,Ne(),Ce.forEach(function(Me){Me()})}function rt(we){p.getError(),M=!1,L.restore(),ae.restore(),W.restore(),ye.restore(),B.restore(),N.restore(),$.restore(),q&&q.restore(),he.procs.refresh(),Re(),Le.forEach(function(Me){Me()})}te&&(te.addEventListener(zf,tt,!1),te.addEventListener(Hf,rt,!1));function Be(){re.length=0,Ne(),te&&(te.removeEventListener(zf,tt),te.removeEventListener(Hf,rt)),ae.clear(),N.clear(),B.clear(),$.clear(),ye.clear(),ue.clear(),W.clear(),q&&q.clear(),ie.forEach(function(we){we()})}function st(we){s(!!we,"invalid args to regl({...})"),s.type(we,"object","invalid args to regl({...})");function Me(w){var y=n({},w);delete y.uniforms,delete y.attributes,delete y.context,delete y.vao,"stencil"in y&&y.stencil.op&&(y.stencil.opBack=y.stencil.opFront=y.stencil.op,delete y.stencil.op);function _(g){if(g in y){var c=y[g];delete y[g],Object.keys(c).forEach(function(m){y[g+"."+m]=c[m]})}}return _("blend"),_("depth"),_("cull"),_("stencil"),_("polygonOffset"),_("scissor"),_("sample"),"vao"in w&&(y.vao=w.vao),y}function Ue(w,y){var _={},g={};return Object.keys(w).forEach(function(c){var m=w[c];if(kt.isDynamic(m)){g[c]=kt.unbox(m,c);return}else if(y&&Array.isArray(m)){for(var d=0;d<m.length;++d)if(kt.isDynamic(m[d])){g[c]=kt.unbox(m,c);return}}_[c]=m}),{dynamic:g,static:_}}var at=Ue(we.context||{},!0),Ut=Ue(we.uniforms||{},!0),_r=Ue(we.attributes||{},!1),h=Ue(Me(we),!1),R={gpuTime:0,cpuTime:0,count:0},k=he.compile(h,_r,Ut,at,R),de=k.draw,Ge=k.batch,u=k.scope,i=[];function v(w){for(;i.length<w;)i.push(null);return i}function x(w,y){var _;if(M&&s.raise("context lost"),typeof w=="function")return u.call(this,null,w,0);if(typeof y=="function")if(typeof w=="number")for(_=0;_<w;++_)u.call(this,null,y,_);else if(Array.isArray(w))for(_=0;_<w.length;++_)u.call(this,w[_],y,_);else return u.call(this,w,y,0);else if(typeof w=="number"){if(w>0)return Ge.call(this,v(w|0),w|0)}else if(Array.isArray(w)){if(w.length)return Ge.call(this,w,w.length)}else return de.call(this,w)}return n(x,{stats:R,destroy:function(){k.destroy()}})}var Ke=N.setFBO=st({framebuffer:kt.define.call(null,jf,"framebuffer")});function ft(we,Me){var Ue=0;he.procs.poll();var at=Me.color;at&&(p.clearColor(+at[0]||0,+at[1]||0,+at[2]||0,+at[3]||0),Ue|=id),"depth"in Me&&(p.clearDepth(+Me.depth),Ue|=od),"stencil"in Me&&(p.clearStencil(Me.stencil|0),Ue|=fd),s(!!Ue,"called regl.clear with no buffer specified"),p.clear(Ue)}function ut(we){if(s(typeof we=="object"&&we,"regl.clear() takes an object as input"),"framebuffer"in we)if(we.framebuffer&&we.framebuffer_reglType==="framebufferCube")for(var Me=0;Me<6;++Me)Ke(n({framebuffer:we.framebuffer.faces[Me]},we),ft);else Ke(we,ft);else ft(null,we)}function lt(we){s.type(we,"function","regl.frame() callback must be a function"),re.push(we);function Me(){var Ue=Vf(re,we);s(Ue>=0,"cannot cancel a frame twice");function at(){var Ut=Vf(re,at);re[Ut]=re[re.length-1],re.length-=1,re.length<=0&&Ne()}re[Ue]=at}return Re(),{cancel:Me}}function dt(){var we=X.viewport,Me=X.scissor_box;we[0]=we[1]=Me[0]=Me[1]=0,V.viewportWidth=V.framebufferWidth=V.drawingBufferWidth=we[2]=Me[2]=p.drawingBufferWidth,V.viewportHeight=V.framebufferHeight=V.drawingBufferHeight=we[3]=Me[3]=p.drawingBufferHeight}function mt(){V.tick+=1,V.time=De(),dt(),he.procs.poll()}function nt(){ye.refresh(),dt(),he.procs.refresh(),q&&q.update()}function De(){return(Qi()-Q)/1e3}nt();function pt(we,Me){s.type(Me,"function","listener callback must be a function");var Ue;switch(we){case"frame":return lt(Me);case"lost":Ue=Ce;break;case"restore":Ue=Le;break;case"destroy":Ue=ie;break;default:s.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ue.push(Me),{cancel:function(){for(var at=0;at<Ue.length;++at)if(Ue[at]===Me){Ue[at]=Ue[Ue.length-1],Ue.pop();return}}}}var He=n(st,{clear:ut,prop:kt.define.bind(null,jf),context:kt.define.bind(null,ud),this:kt.define.bind(null,ld),draw:st({}),buffer:function(we){return W.create(we,sd,!1,!1)},elements:function(we){return ue.create(we,!1)},texture:ye.create2D,cube:ye.createCube,renderbuffer:B.create,framebuffer:N.create,framebufferCube:N.createCube,vao:$.createVAO,attributes:C,frame:lt,on:pt,limits:O,hasExtension:function(we){return O.extensions.indexOf(we.toLowerCase())>=0},read:ee,destroy:Be,_gl:p,_refresh:nt,poll:function(){mt(),q&&q.update()},now:De,stats:H});return f.onDone(null,He),He}return cd})})(ps);var Ap=ps.exports,_n={};function Wd(t){if(typeof t=="object"){if("buttons"in t)return t.buttons;if("which"in t){var e=t.which;if(e===2)return 4;if(e===3)return 2;if(e>0)return 1<<e-1}else if("button"in t){var e=t.button;if(e===1)return 4;if(e===2)return 2;if(e>=0)return 1<<e}}return 0}_n.buttons=Wd;function Gi(t){return t.target||t.srcElement||window}_n.element=Gi;function Yd(t){if(typeof t=="object"){if("offsetX"in t)return t.offsetX;var e=Gi(t),r=e.getBoundingClientRect();return t.clientX-r.left}return 0}_n.x=Yd;function qd(t){if(typeof t=="object"){if("offsetY"in t)return t.offsetY;var e=Gi(t),r=e.getBoundingClientRect();return t.clientY-r.top}return 0}_n.y=qd;var Zd=Qd,yn=_n;function Qd(t,e){e||(e=t,t=window);var r=0,n=0,o=0,l={shift:!1,alt:!1,control:!1,meta:!1},b=!1;function T(be){var Te=!1;return"altKey"in be&&(Te=Te||be.altKey!==l.alt,l.alt=!!be.altKey),"shiftKey"in be&&(Te=Te||be.shiftKey!==l.shift,l.shift=!!be.shiftKey),"ctrlKey"in be&&(Te=Te||be.ctrlKey!==l.control,l.control=!!be.ctrlKey),"metaKey"in be&&(Te=Te||be.metaKey!==l.meta,l.meta=!!be.metaKey),Te}function D(be,Te){var Ie=yn.x(Te),qe=yn.y(Te);"buttons"in Te&&(be=Te.buttons|0),(be!==r||Ie!==n||qe!==o||T(Te))&&(r=be|0,n=Ie||0,o=qe||0,e&&e(r,n,o,l))}function j(be){D(0,be)}function le(){(r||n||o||l.shift||l.alt||l.meta||l.control)&&(n=o=0,r=0,l.shift=l.alt=l.control=l.meta=!1,e&&e(0,0,0,l))}function ge(be){T(be)&&e&&e(r,n,o,l)}function ve(be){yn.buttons(be)===0?D(0,be):D(r,be)}function oe(be){D(r|yn.buttons(be),be)}function $e(be){D(r&~yn.buttons(be),be)}function je(){b||(b=!0,t.addEventListener("mousemove",ve),t.addEventListener("mousedown",oe),t.addEventListener("mouseup",$e),t.addEventListener("mouseleave",j),t.addEventListener("mouseenter",j),t.addEventListener("mouseout",j),t.addEventListener("mouseover",j),t.addEventListener("blur",le),t.addEventListener("keyup",ge),t.addEventListener("keydown",ge),t.addEventListener("keypress",ge),t!==window&&(window.addEventListener("blur",le),window.addEventListener("keyup",ge),window.addEventListener("keydown",ge),window.addEventListener("keypress",ge)))}function Ye(){!b||(b=!1,t.removeEventListener("mousemove",ve),t.removeEventListener("mousedown",oe),t.removeEventListener("mouseup",$e),t.removeEventListener("mouseleave",j),t.removeEventListener("mouseenter",j),t.removeEventListener("mouseout",j),t.removeEventListener("mouseover",j),t.removeEventListener("blur",le),t.removeEventListener("keyup",ge),t.removeEventListener("keydown",ge),t.removeEventListener("keypress",ge),t!==window&&(window.removeEventListener("blur",le),window.removeEventListener("keyup",ge),window.removeEventListener("keydown",ge),window.removeEventListener("keypress",ge)))}je();var Fe={element:t};return Object.defineProperties(Fe,{enabled:{get:function(){return b},set:function(be){be?je():Ye()},enumerable:!0},buttons:{get:function(){return r},enumerable:!0},x:{get:function(){return n},enumerable:!0},y:{get:function(){return o},enumerable:!0},mods:{get:function(){return l},enumerable:!0}}),Fe}var Kd=function(e,r){r||(r=[0,""]),e=String(e);var n=parseFloat(e,10);return r[0]=n,r[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",r},vs=Kd,Jd=Ni,gn=bs("in",document.body);function Ii(t,e){var r=vs(getComputedStyle(t).getPropertyValue(e));return r[0]*Ni(r[1],t)}function bs(t,e){var r=document.createElement("div");r.style.height="128"+t,e.appendChild(r);var n=Ii(r,"height")/128;return e.removeChild(r),n}function Ni(t,e){if(!t)return null;switch(e=e||document.body,t=(t+""||"px").trim().toLowerCase(),(e===window||e===document)&&(e=document.body),t){case"%":return e.clientHeight/100;case"ch":case"ex":return bs(t,e);case"em":return Ii(e,"font-size");case"rem":return Ii(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return gn;case"cm":return gn/2.54;case"mm":return gn/25.4;case"pt":return gn/72;case"pc":return gn/6;case"px":return 1}var r=vs(t);if(!isNaN(r[0])&&r[1]){var n=Ni(r[1],e);return typeof n=="number"?r[0]*n:null}return null}var eh=Jd,th=rh;function rh(t,e,r){typeof t=="function"&&(r=!!e,e=t,t=window);var n=eh("ex",t),o=function(l){r&&l.preventDefault();var b=l.deltaX||0,T=l.deltaY||0,D=l.deltaZ||0,j=l.deltaMode,le=1;switch(j){case 1:le=n;break;case 2:le=window.innerHeight;break}if(b*=le,T*=le,D*=le,b||T||D)return e(b,T,D,l)};return t.addEventListener("wheel",o),o}var _s=nh;function nh(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}var ah=ih;function ih(t,e,r,n,o){var l=1/Math.tan(e/2),b=1/(n-o);return t[0]=l/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+n)*b,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*n*b,t[15]=0,t}var oh=_s,fh=sh;function sh(t,e,r,n){var o,l,b,T,D,j,le,ge,ve,oe,$e=e[0],je=e[1],Ye=e[2],Fe=n[0],be=n[1],Te=n[2],Ie=r[0],qe=r[1],Ze=r[2];return Math.abs($e-Ie)<1e-6&&Math.abs(je-qe)<1e-6&&Math.abs(Ye-Ze)<1e-6?oh(t):(le=$e-Ie,ge=je-qe,ve=Ye-Ze,oe=1/Math.sqrt(le*le+ge*ge+ve*ve),le*=oe,ge*=oe,ve*=oe,o=be*ve-Te*ge,l=Te*le-Fe*ve,b=Fe*ge-be*le,oe=Math.sqrt(o*o+l*l+b*b),oe?(oe=1/oe,o*=oe,l*=oe,b*=oe):(o=0,l=0,b=0),T=ge*b-ve*l,D=ve*o-le*b,j=le*l-ge*o,oe=Math.sqrt(T*T+D*D+j*j),oe?(oe=1/oe,T*=oe,D*=oe,j*=oe):(T=0,D=0,j=0),t[0]=o,t[1]=T,t[2]=le,t[3]=0,t[4]=l,t[5]=D,t[6]=ge,t[7]=0,t[8]=b,t[9]=j,t[10]=ve,t[11]=0,t[12]=-(o*$e+l*je+b*Ye),t[13]=-(T*$e+D*je+j*Ye),t[14]=-(le*$e+ge*je+ve*Ye),t[15]=1,t)}var uh=Zd,lh=th,ys=_s,ch=ah,dh=fh,Sp=mh,hh=typeof window!="undefined";function mh(t,e){var r=e||{};typeof r.noScroll=="undefined"&&(r.noScroll=r.preventDefault);var n={view:ys(new Float32Array(16)),projection:ys(new Float32Array(16)),center:new Float32Array(r.center||3),theta:r.theta||0,phi:r.phi||0,distance:Math.log(r.distance||10),eye:new Float32Array(3),up:new Float32Array(r.up||[0,1,0]),fovy:r.fovy||Math.PI/4,near:typeof r.near!="undefined"?r.near:.01,far:typeof r.far!="undefined"?r.far:1e3,noScroll:typeof r.noScroll!="undefined"?r.noScroll:!1,flipY:!!r.flipY,dtheta:0,dphi:0,rotationSpeed:typeof r.rotationSpeed!="undefined"?r.rotationSpeed:1,zoomSpeed:typeof r.zoomSpeed!="undefined"?r.zoomSpeed:1,renderOnDirty:typeof r.renderOnDirty!==void 0?!!r.renderOnDirty:!1},o=r.element,l=typeof r.damping!="undefined"?r.damping:.9,b=new Float32Array([1,0,0]),T=new Float32Array([0,0,1]),D=Math.log("minDistance"in r?r.minDistance:.1),j=Math.log("maxDistance"in r?r.maxDistance:1e3),le=0,ge=0,ve=0;if(hh&&r.mouse!==!1){let Te=function(){return o?o.offsetWidth:window.innerWidth},Ie=function(){return o?o.offsetHeight:window.innerHeight};var oe=o||t._gl.canvas;uh(oe,function(qe,Ze,yt){if(qe&1){var gt=(Ze-ge)/Te(),Mt=(yt-ve)/Ie();n.dtheta+=n.rotationSpeed*4*gt,n.dphi+=n.rotationSpeed*4*Mt,n.dirty=!0}ge=Ze,ve=yt}),lh(oe,function(qe,Ze){le+=Ze/Ie()*n.zoomSpeed,n.dirty=!0},r.noScroll)}function $e(Te){var Ie=Te*l;return Math.abs(Ie)<.1?0:(n.dirty=!0,Ie)}function je(Te,Ie,qe){return Math.min(Math.max(Te,Ie),qe)}function Ye(Te){Object.keys(Te).forEach(function(Ar){n[Ar]=Te[Ar]});var Ie=n.center,qe=n.eye,Ze=n.up,yt=n.dtheta,gt=n.dphi;n.theta+=yt,n.phi=je(n.phi+gt,-Math.PI/2,Math.PI/2),n.distance=je(n.distance+le,D,j),n.dtheta=$e(yt),n.dphi=$e(gt),le=$e(le);for(var Mt=n.theta,ir=n.phi,or=Math.exp(n.distance),wr=or*Math.sin(Mt)*Math.cos(ir),Xr=or*Math.cos(Mt)*Math.cos(ir),Zt=or*Math.sin(ir),Ft=0;Ft<3;++Ft)qe[Ft]=Ie[Ft]+wr*T[Ft]+Xr*b[Ft]+Zt*Ze[Ft];dh(n.view,qe,Ie,Ze)}n.dirty=!0;var Fe=t({context:Object.assign({},n,{dirty:function(){return n.dirty},projection:function(Te){return ch(n.projection,n.fovy,Te.viewportWidth/Te.viewportHeight,n.near,n.far),n.flipY&&(n.projection[5]*=-1),n.projection}}),uniforms:Object.keys(n).reduce(function(Te,Ie){return Te[Ie]=t.context(Ie),Te},{})});function be(Te,Ie){typeof be.dirty!="undefined"&&(n.dirty=be.dirty||n.dirty,be.dirty=void 0),Te&&Ie&&(n.dirty=!0),!(n.renderOnDirty&&!n.dirty)&&(Ie||(Ie=Te,Te={}),Ye(Te),Fe(Ie),n.dirty=!1)}return Object.keys(n).forEach(function(Te){be[Te]=n[Te]}),be}var Mi=new Date,Bi=new Date;function Wt(t,e,r,n){function o(l){return t(l=arguments.length===0?new Date:new Date(+l)),l}return o.floor=function(l){return t(l=new Date(+l)),l},o.ceil=function(l){return t(l=new Date(l-1)),e(l,1),t(l),l},o.round=function(l){var b=o(l),T=o.ceil(l);return l-b<T-l?b:T},o.offset=function(l,b){return e(l=new Date(+l),b==null?1:Math.floor(b)),l},o.range=function(l,b,T){var D=[],j;if(l=o.ceil(l),T=T==null?1:Math.floor(T),!(l<b)||!(T>0))return D;do D.push(j=new Date(+l)),e(l,T),t(l);while(j<l&&l<b);return D},o.filter=function(l){return Wt(function(b){if(b>=b)for(;t(b),!l(b);)b.setTime(b-1)},function(b,T){if(b>=b)if(T<0)for(;++T<=0;)for(;e(b,-1),!l(b););else for(;--T>=0;)for(;e(b,1),!l(b););})},r&&(o.count=function(l,b){return Mi.setTime(+l),Bi.setTime(+b),t(Mi),t(Bi),Math.floor(r(Mi,Bi))},o.every=function(l){return l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?o.filter(n?function(b){return n(b)%l==0}:function(b){return o.count(0,b)%l==0}):o}),o}const ph=1e3,Pi=ph*60,vh=Pi*60,Ui=vh*24,gs=Ui*7;var bh=Wt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Pi)/Ui,t=>t.getDate()-1),xs=bh;function Er(t){return Wt(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r*7)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Pi)/gs})}var _h=Er(0),$i=Er(1);Er(2);Er(3);var xn=Er(4);Er(5);Er(6);var Es=Wt(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Es.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Wt(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r*t)})};var En=Es,yh=Wt(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/Ui},function(t){return t.getUTCDate()-1}),Ts=yh;function Tr(t){return Wt(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r*7)},function(e,r){return(r-e)/gs})}var gh=Tr(0),zi=Tr(1);Tr(2);Tr(3);var Tn=Tr(4);Tr(5);Tr(6);var ws=Wt(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});ws.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Wt(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r*t)})};var wn=ws;function Hi(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function ji(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function An(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function xh(t){var e=t.dateTime,r=t.date,n=t.time,o=t.periods,l=t.days,b=t.shortDays,T=t.months,D=t.shortMonths,j=Sn(o),le=kn(o),ge=Sn(l),ve=kn(l),oe=Sn(b),$e=kn(b),je=Sn(T),Ye=kn(T),Fe=Sn(D),be=kn(D),Te={a:Ln,A:Ta,b:wa,B:Sr,c:null,d:Rs,e:Rs,f:jh,g:em,G:rm,H:$h,I:zh,j:Hh,L:Os,m:Vh,M:Xh,p:Cn,q:Aa,Q:Ms,s:Bs,S:Wh,u:Yh,U:qh,V:Zh,w:Qh,W:Kh,x:null,X:null,y:Jh,Y:tm,Z:nm,"%":Ns},Ie={a:Sa,A:ka,b:La,B:Ca,c:null,d:Fs,e:Fs,f:fm,g:bm,G:ym,H:am,I:im,j:om,L:Gs,m:sm,M:um,p:Ra,q:Oa,Q:Ms,s:Bs,S:lm,u:cm,U:dm,V:hm,w:mm,W:pm,x:null,X:null,y:vm,Y:_m,Z:gm,"%":Ns},qe={a:ir,A:or,b:wr,B:Xr,c:Zt,d:Ls,e:Ls,f:Mh,g:ks,G:Ss,H:Cs,I:Cs,j:Fh,L:Nh,m:Dh,M:Gh,p:Mt,q:Oh,Q:Ph,s:Uh,S:Ih,u:Sh,U:kh,V:Lh,w:Ah,W:Ch,x:Ft,X:Ar,y:ks,Y:Ss,Z:Rh,"%":Bh};Te.x=Ze(r,Te),Te.X=Ze(n,Te),Te.c=Ze(e,Te),Ie.x=Ze(r,Ie),Ie.X=Ze(n,Ie),Ie.c=Ze(e,Ie);function Ze(Ee,ze){return function(Xe){var ne=[],xt=-1,Qe=0,Et=Ee.length,Tt,zt,wt;for(Xe instanceof Date||(Xe=new Date(+Xe));++xt<Et;)Ee.charCodeAt(xt)===37&&(ne.push(Ee.slice(Qe,xt)),(zt=As[Tt=Ee.charAt(++xt)])!=null?Tt=Ee.charAt(++xt):zt=Tt==="e"?" ":"0",(wt=ze[Tt])&&(Tt=wt(Xe,zt)),ne.push(Tt),Qe=xt+1);return ne.push(Ee.slice(Qe,xt)),ne.join("")}}function yt(Ee,ze){return function(Xe){var ne=An(1900,void 0,1),xt=gt(ne,Ee,Xe+="",0),Qe,Et;if(xt!=Xe.length)return null;if("Q"in ne)return new Date(ne.Q);if("s"in ne)return new Date(ne.s*1e3+("L"in ne?ne.L:0));if(ze&&!("Z"in ne)&&(ne.Z=0),"p"in ne&&(ne.H=ne.H%12+ne.p*12),ne.m===void 0&&(ne.m="q"in ne?ne.q:0),"V"in ne){if(ne.V<1||ne.V>53)return null;"w"in ne||(ne.w=1),"Z"in ne?(Qe=ji(An(ne.y,0,1)),Et=Qe.getUTCDay(),Qe=Et>4||Et===0?zi.ceil(Qe):zi(Qe),Qe=Ts.offset(Qe,(ne.V-1)*7),ne.y=Qe.getUTCFullYear(),ne.m=Qe.getUTCMonth(),ne.d=Qe.getUTCDate()+(ne.w+6)%7):(Qe=Hi(An(ne.y,0,1)),Et=Qe.getDay(),Qe=Et>4||Et===0?$i.ceil(Qe):$i(Qe),Qe=xs.offset(Qe,(ne.V-1)*7),ne.y=Qe.getFullYear(),ne.m=Qe.getMonth(),ne.d=Qe.getDate()+(ne.w+6)%7)}else("W"in ne||"U"in ne)&&("w"in ne||(ne.w="u"in ne?ne.u%7:"W"in ne?1:0),Et="Z"in ne?ji(An(ne.y,0,1)).getUTCDay():Hi(An(ne.y,0,1)).getDay(),ne.m=0,ne.d="W"in ne?(ne.w+6)%7+ne.W*7-(Et+5)%7:ne.w+ne.U*7-(Et+6)%7);return"Z"in ne?(ne.H+=ne.Z/100|0,ne.M+=ne.Z%100,ji(ne)):Hi(ne)}}function gt(Ee,ze,Xe,ne){for(var xt=0,Qe=ze.length,Et=Xe.length,Tt,zt;xt<Qe;){if(ne>=Et)return-1;if(Tt=ze.charCodeAt(xt++),Tt===37){if(Tt=ze.charAt(xt++),zt=qe[Tt in As?ze.charAt(xt++):Tt],!zt||(ne=zt(Ee,Xe,ne))<0)return-1}else if(Tt!=Xe.charCodeAt(ne++))return-1}return ne}function Mt(Ee,ze,Xe){var ne=j.exec(ze.slice(Xe));return ne?(Ee.p=le.get(ne[0].toLowerCase()),Xe+ne[0].length):-1}function ir(Ee,ze,Xe){var ne=oe.exec(ze.slice(Xe));return ne?(Ee.w=$e.get(ne[0].toLowerCase()),Xe+ne[0].length):-1}function or(Ee,ze,Xe){var ne=ge.exec(ze.slice(Xe));return ne?(Ee.w=ve.get(ne[0].toLowerCase()),Xe+ne[0].length):-1}function wr(Ee,ze,Xe){var ne=Fe.exec(ze.slice(Xe));return ne?(Ee.m=be.get(ne[0].toLowerCase()),Xe+ne[0].length):-1}function Xr(Ee,ze,Xe){var ne=je.exec(ze.slice(Xe));return ne?(Ee.m=Ye.get(ne[0].toLowerCase()),Xe+ne[0].length):-1}function Zt(Ee,ze,Xe){return gt(Ee,e,ze,Xe)}function Ft(Ee,ze,Xe){return gt(Ee,r,ze,Xe)}function Ar(Ee,ze,Xe){return gt(Ee,n,ze,Xe)}function Ln(Ee){return b[Ee.getDay()]}function Ta(Ee){return l[Ee.getDay()]}function wa(Ee){return D[Ee.getMonth()]}function Sr(Ee){return T[Ee.getMonth()]}function Cn(Ee){return o[+(Ee.getHours()>=12)]}function Aa(Ee){return 1+~~(Ee.getMonth()/3)}function Sa(Ee){return b[Ee.getUTCDay()]}function ka(Ee){return l[Ee.getUTCDay()]}function La(Ee){return D[Ee.getUTCMonth()]}function Ca(Ee){return T[Ee.getUTCMonth()]}function Ra(Ee){return o[+(Ee.getUTCHours()>=12)]}function Oa(Ee){return 1+~~(Ee.getUTCMonth()/3)}return{format:function(Ee){var ze=Ze(Ee+="",Te);return ze.toString=function(){return Ee},ze},parse:function(Ee){var ze=yt(Ee+="",!1);return ze.toString=function(){return Ee},ze},utcFormat:function(Ee){var ze=Ze(Ee+="",Ie);return ze.toString=function(){return Ee},ze},utcParse:function(Ee){var ze=yt(Ee+="",!0);return ze.toString=function(){return Ee},ze}}}var As={"-":"",_:" ","0":"0"},bt=/^\s*\d+/,Eh=/^%/,Th=/[\\^$*+?|[\]().{}]/g;function We(t,e,r){var n=t<0?"-":"",o=(n?-t:t)+"",l=o.length;return n+(l<r?new Array(r-l+1).join(e)+o:o)}function wh(t){return t.replace(Th,"\\$&")}function Sn(t){return new RegExp("^(?:"+t.map(wh).join("|")+")","i")}function kn(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function Ah(t,e,r){var n=bt.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function Sh(t,e,r){var n=bt.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function kh(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function Lh(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function Ch(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function Ss(t,e,r){var n=bt.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function ks(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Rh(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Oh(t,e,r){var n=bt.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function Dh(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Ls(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function Fh(t,e,r){var n=bt.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Cs(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function Gh(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function Ih(t,e,r){var n=bt.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function Nh(t,e,r){var n=bt.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function Mh(t,e,r){var n=bt.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Bh(t,e,r){var n=Eh.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function Ph(t,e,r){var n=bt.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function Uh(t,e,r){var n=bt.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Rs(t,e){return We(t.getDate(),e,2)}function $h(t,e){return We(t.getHours(),e,2)}function zh(t,e){return We(t.getHours()%12||12,e,2)}function Hh(t,e){return We(1+xs.count(En(t),t),e,3)}function Os(t,e){return We(t.getMilliseconds(),e,3)}function jh(t,e){return Os(t,e)+"000"}function Vh(t,e){return We(t.getMonth()+1,e,2)}function Xh(t,e){return We(t.getMinutes(),e,2)}function Wh(t,e){return We(t.getSeconds(),e,2)}function Yh(t){var e=t.getDay();return e===0?7:e}function qh(t,e){return We(_h.count(En(t)-1,t),e,2)}function Ds(t){var e=t.getDay();return e>=4||e===0?xn(t):xn.ceil(t)}function Zh(t,e){return t=Ds(t),We(xn.count(En(t),t)+(En(t).getDay()===4),e,2)}function Qh(t){return t.getDay()}function Kh(t,e){return We($i.count(En(t)-1,t),e,2)}function Jh(t,e){return We(t.getFullYear()%100,e,2)}function em(t,e){return t=Ds(t),We(t.getFullYear()%100,e,2)}function tm(t,e){return We(t.getFullYear()%1e4,e,4)}function rm(t,e){var r=t.getDay();return t=r>=4||r===0?xn(t):xn.ceil(t),We(t.getFullYear()%1e4,e,4)}function nm(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+We(e/60|0,"0",2)+We(e%60,"0",2)}function Fs(t,e){return We(t.getUTCDate(),e,2)}function am(t,e){return We(t.getUTCHours(),e,2)}function im(t,e){return We(t.getUTCHours()%12||12,e,2)}function om(t,e){return We(1+Ts.count(wn(t),t),e,3)}function Gs(t,e){return We(t.getUTCMilliseconds(),e,3)}function fm(t,e){return Gs(t,e)+"000"}function sm(t,e){return We(t.getUTCMonth()+1,e,2)}function um(t,e){return We(t.getUTCMinutes(),e,2)}function lm(t,e){return We(t.getUTCSeconds(),e,2)}function cm(t){var e=t.getUTCDay();return e===0?7:e}function dm(t,e){return We(gh.count(wn(t)-1,t),e,2)}function Is(t){var e=t.getUTCDay();return e>=4||e===0?Tn(t):Tn.ceil(t)}function hm(t,e){return t=Is(t),We(Tn.count(wn(t),t)+(wn(t).getUTCDay()===4),e,2)}function mm(t){return t.getUTCDay()}function pm(t,e){return We(zi.count(wn(t)-1,t),e,2)}function vm(t,e){return We(t.getUTCFullYear()%100,e,2)}function bm(t,e){return t=Is(t),We(t.getUTCFullYear()%100,e,2)}function _m(t,e){return We(t.getUTCFullYear()%1e4,e,4)}function ym(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Tn(t):Tn.ceil(t),We(t.getUTCFullYear()%1e4,e,4)}function gm(){return"+0000"}function Ns(){return"%"}function Ms(t){return+t}function Bs(t){return Math.floor(+t/1e3)}var ya,xm,Em;Tm({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Tm(t){return ya=xh(t),xm=ya.format,Em=ya.parse,ya}function Ps(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let Vr=Ps();function wm(t){Vr=t}const Am=/[&<>"']/,Sm=/[&<>"']/g,km=/[<>"']|&(?!#?\w+;)/,Lm=/[<>"']|&(?!#?\w+;)/g,Cm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Us=t=>Cm[t];function _t(t,e){if(e){if(Am.test(t))return t.replace(Sm,Us)}else if(km.test(t))return t.replace(Lm,Us);return t}const Rm=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function $s(t){return t.replace(Rm,(e,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}const Om=/(^|[^\[])\^/g;function Je(t,e){t=t.source||t,e=e||"";const r={replace:(n,o)=>(o=o.source||o,o=o.replace(Om,"$1"),t=t.replace(n,o),r),getRegex:()=>new RegExp(t,e)};return r}const Dm=/[^\w:]/g,Fm=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function zs(t,e,r){if(t){let n;try{n=decodeURIComponent($s(r)).replace(Dm,"").toLowerCase()}catch{return null}if(n.indexOf("javascript:")===0||n.indexOf("vbscript:")===0||n.indexOf("data:")===0)return null}e&&!Fm.test(r)&&(r=Mm(e,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch{return null}return r}const ga={},Gm=/^[^:]+:\/*[^/]*$/,Im=/^([^:]+:)[\s\S]*$/,Nm=/^([^:]+:\/*[^/]*)[\s\S]*$/;function Mm(t,e){ga[" "+t]||(Gm.test(t)?ga[" "+t]=t+"/":ga[" "+t]=Ea(t,"/",!0)),t=ga[" "+t];const r=t.indexOf(":")===-1;return e.substring(0,2)==="//"?r?e:t.replace(Im,"$1")+e:e.charAt(0)==="/"?r?e:t.replace(Nm,"$1")+e:t+e}const xa={exec:function(){}};function Nt(t){let e=1,r,n;for(;e<arguments.length;e++){r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}function Hs(t,e){const r=t.replace(/\|/g,(l,b,T)=>{let D=!1,j=b;for(;--j>=0&&T[j]==="\\";)D=!D;return D?"|":" |"}),n=r.split(/ \|/);let o=0;if(n[0].trim()||n.shift(),n[n.length-1].trim()||n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;o<n.length;o++)n[o]=n[o].trim().replace(/\\\|/g,"|");return n}function Ea(t,e,r){const n=t.length;if(n===0)return"";let o=0;for(;o<n;){const l=t.charAt(n-o-1);if(l===e&&!r)o++;else if(l!==e&&r)o++;else break}return t.substr(0,n-o)}function Bm(t,e){if(t.indexOf(e[1])===-1)return-1;const r=t.length;let n=0,o=0;for(;o<r;o++)if(t[o]==="\\")o++;else if(t[o]===e[0])n++;else if(t[o]===e[1]&&(n--,n<0))return o;return-1}function js(t){t&&t.sanitize&&!t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function Vs(t,e){if(e<1)return"";let r="";for(;e>1;)e&1&&(r+=t),e>>=1,t+=t;return r+t}function Xs(t,e,r,n){const o=e.href,l=e.title?_t(e.title):null,b=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){n.state.inLink=!0;const T={type:"link",raw:r,href:o,title:l,text:b,tokens:n.inlineTokens(b,[])};return n.state.inLink=!1,T}else return{type:"image",raw:r,href:o,title:l,text:_t(b)}}function Pm(t,e){const r=t.match(/^(\s+)(?:```)/);if(r===null)return e;const n=r[1];return e.split(`
`).map(o=>{const l=o.match(/^\s+/);if(l===null)return o;const[b]=l;return b.length>=n.length?o.slice(n.length):o}).join(`
`)}class Vi{constructor(e){this.options=e||Vr}space(e){const r=this.rules.block.newline.exec(e);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(e){const r=this.rules.block.code.exec(e);if(r){const n=r[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Ea(n,`
`)}}}fences(e){const r=this.rules.block.fences.exec(e);if(r){const n=r[0],o=Pm(n,r[3]||"");return{type:"code",raw:n,lang:r[2]?r[2].trim():r[2],text:o}}}heading(e){const r=this.rules.block.heading.exec(e);if(r){let n=r[2].trim();if(/#$/.test(n)){const l=Ea(n,"#");(this.options.pedantic||!l||/ $/.test(l))&&(n=l.trim())}const o={type:"heading",raw:r[0],depth:r[1].length,text:n,tokens:[]};return this.lexer.inline(o.text,o.tokens),o}}hr(e){const r=this.rules.block.hr.exec(e);if(r)return{type:"hr",raw:r[0]}}blockquote(e){const r=this.rules.block.blockquote.exec(e);if(r){const n=r[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:r[0],tokens:this.lexer.blockTokens(n,[]),text:n}}}list(e){let r=this.rules.block.list.exec(e);if(r){let n,o,l,b,T,D,j,le,ge,ve,oe,$e,je=r[1].trim();const Ye=je.length>1,Fe={type:"list",raw:"",ordered:Ye,start:Ye?+je.slice(0,-1):"",loose:!1,items:[]};je=Ye?`\\d{1,9}\\${je.slice(-1)}`:`\\${je}`,this.options.pedantic&&(je=Ye?je:"[*+-]");const be=new RegExp(`^( {0,3}${je})((?: [^\\n]*)?(?:\\n|$))`);for(;e&&($e=!1,!(!(r=be.exec(e))||this.rules.block.hr.test(e)));){if(n=r[0],e=e.substring(n.length),le=r[2].split(`
`,1)[0],ge=e.split(`
`,1)[0],this.options.pedantic?(b=2,oe=le.trimLeft()):(b=r[2].search(/[^ ]/),b=b>4?1:b,oe=le.slice(b),b+=r[1].length),D=!1,!le&&/^ *$/.test(ge)&&(n+=ge+`
`,e=e.substring(ge.length+1),$e=!0),!$e){const Ie=new RegExp(`^ {0,${Math.min(3,b-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(;e&&(ve=e.split(`
`,1)[0],le=ve,this.options.pedantic&&(le=le.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!Ie.test(le));){if(le.search(/[^ ]/)>=b||!le.trim())oe+=`
`+le.slice(b);else if(!D)oe+=`
`+le;else break;!D&&!le.trim()&&(D=!0),n+=ve+`
`,e=e.substring(ve.length+1)}}Fe.loose||(j?Fe.loose=!0:/\n *\n *$/.test(n)&&(j=!0)),this.options.gfm&&(o=/^\[[ xX]\] /.exec(oe),o&&(l=o[0]!=="[ ] ",oe=oe.replace(/^\[[ xX]\] +/,""))),Fe.items.push({type:"list_item",raw:n,task:!!o,checked:l,loose:!1,text:oe}),Fe.raw+=n}Fe.items[Fe.items.length-1].raw=n.trimRight(),Fe.items[Fe.items.length-1].text=oe.trimRight(),Fe.raw=Fe.raw.trimRight();const Te=Fe.items.length;for(T=0;T<Te;T++){this.lexer.state.top=!1,Fe.items[T].tokens=this.lexer.blockTokens(Fe.items[T].text,[]);const Ie=Fe.items[T].tokens.filter(Ze=>Ze.type==="space"),qe=Ie.every(Ze=>{const yt=Ze.raw.split("");let gt=0;for(const Mt of yt)if(Mt===`
`&&(gt+=1),gt>1)return!0;return!1});!Fe.loose&&Ie.length&&qe&&(Fe.loose=!0,Fe.items[T].loose=!0)}return Fe}}html(e){const r=this.rules.block.html.exec(e);if(r){const n={type:"html",raw:r[0],pre:!this.options.sanitizer&&(r[1]==="pre"||r[1]==="script"||r[1]==="style"),text:r[0]};return this.options.sanitize&&(n.type="paragraph",n.text=this.options.sanitizer?this.options.sanitizer(r[0]):_t(r[0]),n.tokens=[],this.lexer.inline(n.text,n.tokens)),n}}def(e){const r=this.rules.block.def.exec(e);if(r){r[3]&&(r[3]=r[3].substring(1,r[3].length-1));const n=r[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:n,raw:r[0],href:r[2],title:r[3]}}}table(e){const r=this.rules.block.table.exec(e);if(r){const n={type:"table",header:Hs(r[1]).map(o=>({text:o})),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:r[3]?r[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=r[0];let o=n.align.length,l,b,T,D;for(l=0;l<o;l++)/^ *-+: *$/.test(n.align[l])?n.align[l]="right":/^ *:-+: *$/.test(n.align[l])?n.align[l]="center":/^ *:-+ *$/.test(n.align[l])?n.align[l]="left":n.align[l]=null;for(o=n.rows.length,l=0;l<o;l++)n.rows[l]=Hs(n.rows[l],n.header.length).map(j=>({text:j}));for(o=n.header.length,b=0;b<o;b++)n.header[b].tokens=[],this.lexer.inlineTokens(n.header[b].text,n.header[b].tokens);for(o=n.rows.length,b=0;b<o;b++)for(D=n.rows[b],T=0;T<D.length;T++)D[T].tokens=[],this.lexer.inlineTokens(D[T].text,D[T].tokens);return n}}}lheading(e){const r=this.rules.block.lheading.exec(e);if(r){const n={type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}paragraph(e){const r=this.rules.block.paragraph.exec(e);if(r){const n={type:"paragraph",raw:r[0],text:r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}text(e){const r=this.rules.block.text.exec(e);if(r){const n={type:"text",raw:r[0],text:r[0],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}escape(e){const r=this.rules.inline.escape.exec(e);if(r)return{type:"escape",raw:r[0],text:_t(r[1])}}tag(e){const r=this.rules.inline.tag.exec(e);if(r)return!this.lexer.state.inLink&&/^<a /i.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):_t(r[0]):r[0]}}link(e){const r=this.rules.inline.link.exec(e);if(r){const n=r[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const b=Ea(n.slice(0,-1),"\\");if((n.length-b.length)%2==0)return}else{const b=Bm(r[2],"()");if(b>-1){const D=(r[0].indexOf("!")===0?5:4)+r[1].length+b;r[2]=r[2].substring(0,b),r[0]=r[0].substring(0,D).trim(),r[3]=""}}let o=r[2],l="";if(this.options.pedantic){const b=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(o);b&&(o=b[1],l=b[3])}else l=r[3]?r[3].slice(1,-1):"";return o=o.trim(),/^</.test(o)&&(this.options.pedantic&&!/>$/.test(n)?o=o.slice(1):o=o.slice(1,-1)),Xs(r,{href:o&&o.replace(this.rules.inline._escapes,"$1"),title:l&&l.replace(this.rules.inline._escapes,"$1")},r[0],this.lexer)}}reflink(e,r){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let o=(n[2]||n[1]).replace(/\s+/g," ");if(o=r[o.toLowerCase()],!o||!o.href){const l=n[0].charAt(0);return{type:"text",raw:l,text:l}}return Xs(n,o,n[0],this.lexer)}}emStrong(e,r,n=""){let o=this.rules.inline.emStrong.lDelim.exec(e);if(!o||o[3]&&n.match(/[\p{L}\p{N}]/u))return;const l=o[1]||o[2]||"";if(!l||l&&(n===""||this.rules.inline.punctuation.exec(n))){const b=o[0].length-1;let T,D,j=b,le=0;const ge=o[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ge.lastIndex=0,r=r.slice(-1*e.length+b);(o=ge.exec(r))!=null;){if(T=o[1]||o[2]||o[3]||o[4]||o[5]||o[6],!T)continue;if(D=T.length,o[3]||o[4]){j+=D;continue}else if((o[5]||o[6])&&b%3&&!((b+D)%3)){le+=D;continue}if(j-=D,j>0)continue;if(D=Math.min(D,D+j+le),Math.min(b,D)%2){const oe=e.slice(1,b+o.index+D);return{type:"em",raw:e.slice(0,b+o.index+D+1),text:oe,tokens:this.lexer.inlineTokens(oe,[])}}const ve=e.slice(2,b+o.index+D-1);return{type:"strong",raw:e.slice(0,b+o.index+D+1),text:ve,tokens:this.lexer.inlineTokens(ve,[])}}}}codespan(e){const r=this.rules.inline.code.exec(e);if(r){let n=r[2].replace(/\n/g," ");const o=/[^ ]/.test(n),l=/^ /.test(n)&&/ $/.test(n);return o&&l&&(n=n.substring(1,n.length-1)),n=_t(n,!0),{type:"codespan",raw:r[0],text:n}}}br(e){const r=this.rules.inline.br.exec(e);if(r)return{type:"br",raw:r[0]}}del(e){const r=this.rules.inline.del.exec(e);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2],[])}}autolink(e,r){const n=this.rules.inline.autolink.exec(e);if(n){let o,l;return n[2]==="@"?(o=_t(this.options.mangle?r(n[1]):n[1]),l="mailto:"+o):(o=_t(n[1]),l=o),{type:"link",raw:n[0],text:o,href:l,tokens:[{type:"text",raw:o,text:o}]}}}url(e,r){let n;if(n=this.rules.inline.url.exec(e)){let o,l;if(n[2]==="@")o=_t(this.options.mangle?r(n[0]):n[0]),l="mailto:"+o;else{let b;do b=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(b!==n[0]);o=_t(n[0]),n[1]==="www."?l="http://"+o:l=o}return{type:"link",raw:n[0],text:o,href:l,tokens:[{type:"text",raw:o,text:o}]}}}inlineText(e,r){const n=this.rules.inline.text.exec(e);if(n){let o;return this.lexer.state.inRawBlock?o=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):_t(n[0]):n[0]:o=_t(this.options.smartypants?r(n[0]):n[0]),{type:"text",raw:n[0],text:o}}}}const Oe={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:xa,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};Oe._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;Oe._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Oe.def=Je(Oe.def).replace("label",Oe._label).replace("title",Oe._title).getRegex();Oe.bullet=/(?:[*+-]|\d{1,9}[.)])/;Oe.listItemStart=Je(/^( *)(bull) */).replace("bull",Oe.bullet).getRegex();Oe.list=Je(Oe.list).replace(/bull/g,Oe.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Oe.def.source+")").getRegex();Oe._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Oe._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Oe.html=Je(Oe.html,"i").replace("comment",Oe._comment).replace("tag",Oe._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Oe.paragraph=Je(Oe._paragraph).replace("hr",Oe.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Oe._tag).getRegex();Oe.blockquote=Je(Oe.blockquote).replace("paragraph",Oe.paragraph).getRegex();Oe.normal=Nt({},Oe);Oe.gfm=Nt({},Oe.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});Oe.gfm.table=Je(Oe.gfm.table).replace("hr",Oe.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Oe._tag).getRegex();Oe.gfm.paragraph=Je(Oe._paragraph).replace("hr",Oe.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Oe.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Oe._tag).getRegex();Oe.pedantic=Nt({},Oe.normal,{html:Je(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Oe._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:xa,paragraph:Je(Oe.normal._paragraph).replace("hr",Oe.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Oe.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const xe={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:xa,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:xa,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};xe._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";xe.punctuation=Je(xe.punctuation).replace(/punctuation/g,xe._punctuation).getRegex();xe.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;xe.escapedEmSt=/\\\*|\\_/g;xe._comment=Je(Oe._comment).replace("(?:-->|$)","-->").getRegex();xe.emStrong.lDelim=Je(xe.emStrong.lDelim).replace(/punct/g,xe._punctuation).getRegex();xe.emStrong.rDelimAst=Je(xe.emStrong.rDelimAst,"g").replace(/punct/g,xe._punctuation).getRegex();xe.emStrong.rDelimUnd=Je(xe.emStrong.rDelimUnd,"g").replace(/punct/g,xe._punctuation).getRegex();xe._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;xe._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;xe._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;xe.autolink=Je(xe.autolink).replace("scheme",xe._scheme).replace("email",xe._email).getRegex();xe._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;xe.tag=Je(xe.tag).replace("comment",xe._comment).replace("attribute",xe._attribute).getRegex();xe._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;xe._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;xe._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;xe.link=Je(xe.link).replace("label",xe._label).replace("href",xe._href).replace("title",xe._title).getRegex();xe.reflink=Je(xe.reflink).replace("label",xe._label).replace("ref",Oe._label).getRegex();xe.nolink=Je(xe.nolink).replace("ref",Oe._label).getRegex();xe.reflinkSearch=Je(xe.reflinkSearch,"g").replace("reflink",xe.reflink).replace("nolink",xe.nolink).getRegex();xe.normal=Nt({},xe);xe.pedantic=Nt({},xe.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Je(/^!?\[(label)\]\((.*?)\)/).replace("label",xe._label).getRegex(),reflink:Je(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",xe._label).getRegex()});xe.gfm=Nt({},xe.normal,{escape:Je(xe.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});xe.gfm.url=Je(xe.gfm.url,"i").replace("email",xe.gfm._extended_email).getRegex();xe.breaks=Nt({},xe.gfm,{br:Je(xe.br).replace("{2,}","*").getRegex(),text:Je(xe.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function Um(t){return t.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function Ws(t){let e="",r,n;const o=t.length;for(r=0;r<o;r++)n=t.charCodeAt(r),Math.random()>.5&&(n="x"+n.toString(16)),e+="&#"+n+";";return e}class Yt{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Vr,this.options.tokenizer=this.options.tokenizer||new Vi,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:Oe.normal,inline:xe.normal};this.options.pedantic?(r.block=Oe.pedantic,r.inline=xe.pedantic):this.options.gfm&&(r.block=Oe.gfm,this.options.breaks?r.inline=xe.breaks:r.inline=xe.gfm),this.tokenizer.rules=r}static get rules(){return{block:Oe,inline:xe}}static lex(e,r){return new Yt(r).lex(e)}static lexInline(e,r){return new Yt(r).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(e,this.tokens);let r;for(;r=this.inlineQueue.shift();)this.inlineTokens(r.src,r.tokens);return this.tokens}blockTokens(e,r=[]){this.options.pedantic&&(e=e.replace(/^ +$/gm,""));let n,o,l,b;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(T=>(n=T.call({lexer:this},e,r))?(e=e.substring(n.raw.length),r.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+n.raw,o.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=o.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),r.push(n);continue}if(l=e,this.options.extensions&&this.options.extensions.startBlock){let T=1/0;const D=e.slice(1);let j;this.options.extensions.startBlock.forEach(function(le){j=le.call({lexer:this},D),typeof j=="number"&&j>=0&&(T=Math.min(T,j))}),T<1/0&&T>=0&&(l=e.substring(0,T+1))}if(this.state.top&&(n=this.tokenizer.paragraph(l))){o=r[r.length-1],b&&o.type==="paragraph"?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(n),b=l.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),o=r[r.length-1],o&&o.type==="text"?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(n);continue}if(e){const T="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(T);break}else throw new Error(T)}}return this.state.top=!0,r}inline(e,r){this.inlineQueue.push({src:e,tokens:r})}inlineTokens(e,r=[]){let n,o,l,b=e,T,D,j;if(this.tokens.links){const le=Object.keys(this.tokens.links);if(le.length>0)for(;(T=this.tokenizer.rules.inline.reflinkSearch.exec(b))!=null;)le.includes(T[0].slice(T[0].lastIndexOf("[")+1,-1))&&(b=b.slice(0,T.index)+"["+Vs("a",T[0].length-2)+"]"+b.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(T=this.tokenizer.rules.inline.blockSkip.exec(b))!=null;)b=b.slice(0,T.index)+"["+Vs("a",T[0].length-2)+"]"+b.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(T=this.tokenizer.rules.inline.escapedEmSt.exec(b))!=null;)b=b.slice(0,T.index)+"++"+b.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(D||(j=""),D=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(le=>(n=le.call({lexer:this},e,r))?(e=e.substring(n.raw.length),r.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),o=r[r.length-1],o&&n.type==="text"&&o.type==="text"?(o.raw+=n.raw,o.text+=n.text):r.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),o=r[r.length-1],o&&n.type==="text"&&o.type==="text"?(o.raw+=n.raw,o.text+=n.text):r.push(n);continue}if(n=this.tokenizer.emStrong(e,b,j)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),r.push(n);continue}if(n=this.tokenizer.autolink(e,Ws)){e=e.substring(n.raw.length),r.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e,Ws))){e=e.substring(n.raw.length),r.push(n);continue}if(l=e,this.options.extensions&&this.options.extensions.startInline){let le=1/0;const ge=e.slice(1);let ve;this.options.extensions.startInline.forEach(function(oe){ve=oe.call({lexer:this},ge),typeof ve=="number"&&ve>=0&&(le=Math.min(le,ve))}),le<1/0&&le>=0&&(l=e.substring(0,le+1))}if(n=this.tokenizer.inlineText(l,Um)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(j=n.raw.slice(-1)),D=!0,o=r[r.length-1],o&&o.type==="text"?(o.raw+=n.raw,o.text+=n.text):r.push(n);continue}if(e){const le="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(le);break}else throw new Error(le)}}return r}}class Xi{constructor(e){this.options=e||Vr}code(e,r,n){const o=(r||"").match(/\S*/)[0];if(this.options.highlight){const l=this.options.highlight(e,o);l!=null&&l!==e&&(n=!0,e=l)}return e=e.replace(/\n$/,"")+`
`,o?'<pre><code class="'+this.options.langPrefix+_t(o,!0)+'">'+(n?e:_t(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:_t(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,r,n,o){return this.options.headerIds?"<h"+r+' id="'+this.options.headerPrefix+o.slug(n)+'">'+e+"</h"+r+`>
`:"<h"+r+">"+e+"</h"+r+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,r,n){const o=r?"ol":"ul",l=r&&n!==1?' start="'+n+'"':"";return"<"+o+l+`>
`+e+"</"+o+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,r){return r&&(r="<tbody>"+r+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,r){const n=r.header?"th":"td";return(r.align?"<"+n+' align="'+r.align+'">':"<"+n+">")+e+"</"+n+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,r,n){if(e=zs(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let o='<a href="'+_t(e)+'"';return r&&(o+=' title="'+r+'"'),o+=">"+n+"</a>",o}image(e,r,n){if(e=zs(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let o='<img src="'+e+'" alt="'+n+'"';return r&&(o+=' title="'+r+'"'),o+=this.options.xhtml?"/>":">",o}text(e){return e}}class Ys{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,r,n){return""+n}image(e,r,n){return""+n}br(){return""}}class qs{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,r){let n=e,o=0;if(this.seen.hasOwnProperty(n)){o=this.seen[e];do o++,n=e+"-"+o;while(this.seen.hasOwnProperty(n))}return r||(this.seen[e]=o,this.seen[n]=0),n}slug(e,r={}){const n=this.serialize(e);return this.getNextSafeSlug(n,r.dryrun)}}class qt{constructor(e){this.options=e||Vr,this.options.renderer=this.options.renderer||new Xi,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Ys,this.slugger=new qs}static parse(e,r){return new qt(r).parse(e)}static parseInline(e,r){return new qt(r).parseInline(e)}parse(e,r=!0){let n="",o,l,b,T,D,j,le,ge,ve,oe,$e,je,Ye,Fe,be,Te,Ie,qe,Ze;const yt=e.length;for(o=0;o<yt;o++){if(oe=e[o],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[oe.type]&&(Ze=this.options.extensions.renderers[oe.type].call({parser:this},oe),Ze!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(oe.type))){n+=Ze||"";continue}switch(oe.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(oe.tokens),oe.depth,$s(this.parseInline(oe.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(oe.text,oe.lang,oe.escaped);continue}case"table":{for(ge="",le="",T=oe.header.length,l=0;l<T;l++)le+=this.renderer.tablecell(this.parseInline(oe.header[l].tokens),{header:!0,align:oe.align[l]});for(ge+=this.renderer.tablerow(le),ve="",T=oe.rows.length,l=0;l<T;l++){for(j=oe.rows[l],le="",D=j.length,b=0;b<D;b++)le+=this.renderer.tablecell(this.parseInline(j[b].tokens),{header:!1,align:oe.align[b]});ve+=this.renderer.tablerow(le)}n+=this.renderer.table(ge,ve);continue}case"blockquote":{ve=this.parse(oe.tokens),n+=this.renderer.blockquote(ve);continue}case"list":{for($e=oe.ordered,je=oe.start,Ye=oe.loose,T=oe.items.length,ve="",l=0;l<T;l++)be=oe.items[l],Te=be.checked,Ie=be.task,Fe="",be.task&&(qe=this.renderer.checkbox(Te),Ye?be.tokens.length>0&&be.tokens[0].type==="paragraph"?(be.tokens[0].text=qe+" "+be.tokens[0].text,be.tokens[0].tokens&&be.tokens[0].tokens.length>0&&be.tokens[0].tokens[0].type==="text"&&(be.tokens[0].tokens[0].text=qe+" "+be.tokens[0].tokens[0].text)):be.tokens.unshift({type:"text",text:qe}):Fe+=qe),Fe+=this.parse(be.tokens,Ye),ve+=this.renderer.listitem(Fe,Ie,Te);n+=this.renderer.list(ve,$e,je);continue}case"html":{n+=this.renderer.html(oe.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(oe.tokens));continue}case"text":{for(ve=oe.tokens?this.parseInline(oe.tokens):oe.text;o+1<yt&&e[o+1].type==="text";)oe=e[++o],ve+=`
`+(oe.tokens?this.parseInline(oe.tokens):oe.text);n+=r?this.renderer.paragraph(ve):ve;continue}default:{const gt='Token with "'+oe.type+'" type was not found.';if(this.options.silent){console.error(gt);return}else throw new Error(gt)}}}return n}parseInline(e,r){r=r||this.renderer;let n="",o,l,b;const T=e.length;for(o=0;o<T;o++){if(l=e[o],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[l.type]&&(b=this.options.extensions.renderers[l.type].call({parser:this},l),b!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type))){n+=b||"";continue}switch(l.type){case"escape":{n+=r.text(l.text);break}case"html":{n+=r.html(l.text);break}case"link":{n+=r.link(l.href,l.title,this.parseInline(l.tokens,r));break}case"image":{n+=r.image(l.href,l.title,l.text);break}case"strong":{n+=r.strong(this.parseInline(l.tokens,r));break}case"em":{n+=r.em(this.parseInline(l.tokens,r));break}case"codespan":{n+=r.codespan(l.text);break}case"br":{n+=r.br();break}case"del":{n+=r.del(this.parseInline(l.tokens,r));break}case"text":{n+=r.text(l.text);break}default:{const D='Token with "'+l.type+'" type was not found.';if(this.options.silent){console.error(D);return}else throw new Error(D)}}}return n}}function Pe(t,e,r){if(typeof t=="undefined"||t===null)throw new Error("marked(): input parameter is undefined or null");if(typeof t!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");if(typeof e=="function"&&(r=e,e=null),e=Nt({},Pe.defaults,e||{}),js(e),r){const n=e.highlight;let o;try{o=Yt.lex(t,e)}catch(T){return r(T)}const l=function(T){let D;if(!T)try{e.walkTokens&&Pe.walkTokens(o,e.walkTokens),D=qt.parse(o,e)}catch(j){T=j}return e.highlight=n,T?r(T):r(null,D)};if(!n||n.length<3||(delete e.highlight,!o.length))return l();let b=0;Pe.walkTokens(o,function(T){T.type==="code"&&(b++,setTimeout(()=>{n(T.text,T.lang,function(D,j){if(D)return l(D);j!=null&&j!==T.text&&(T.text=j,T.escaped=!0),b--,b===0&&l()})},0))}),b===0&&l();return}try{const n=Yt.lex(t,e);return e.walkTokens&&Pe.walkTokens(n,e.walkTokens),qt.parse(n,e)}catch(n){if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+_t(n.message+"",!0)+"</pre>";throw n}}Pe.options=Pe.setOptions=function(t){return Nt(Pe.defaults,t),wm(Pe.defaults),Pe};Pe.getDefaults=Ps;Pe.defaults=Vr;Pe.use=function(...t){const e=Nt({},...t),r=Pe.defaults.extensions||{renderers:{},childTokens:{}};let n;t.forEach(o=>{if(o.extensions&&(n=!0,o.extensions.forEach(l=>{if(!l.name)throw new Error("extension name required");if(l.renderer){const b=r.renderers?r.renderers[l.name]:null;b?r.renderers[l.name]=function(...T){let D=l.renderer.apply(this,T);return D===!1&&(D=b.apply(this,T)),D}:r.renderers[l.name]=l.renderer}if(l.tokenizer){if(!l.level||l.level!=="block"&&l.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");r[l.level]?r[l.level].unshift(l.tokenizer):r[l.level]=[l.tokenizer],l.start&&(l.level==="block"?r.startBlock?r.startBlock.push(l.start):r.startBlock=[l.start]:l.level==="inline"&&(r.startInline?r.startInline.push(l.start):r.startInline=[l.start]))}l.childTokens&&(r.childTokens[l.name]=l.childTokens)})),o.renderer){const l=Pe.defaults.renderer||new Xi;for(const b in o.renderer){const T=l[b];l[b]=(...D)=>{let j=o.renderer[b].apply(l,D);return j===!1&&(j=T.apply(l,D)),j}}e.renderer=l}if(o.tokenizer){const l=Pe.defaults.tokenizer||new Vi;for(const b in o.tokenizer){const T=l[b];l[b]=(...D)=>{let j=o.tokenizer[b].apply(l,D);return j===!1&&(j=T.apply(l,D)),j}}e.tokenizer=l}if(o.walkTokens){const l=Pe.defaults.walkTokens;e.walkTokens=function(b){o.walkTokens.call(this,b),l&&l.call(this,b)}}n&&(e.extensions=r),Pe.setOptions(e)})};Pe.walkTokens=function(t,e){for(const r of t)switch(e.call(Pe,r),r.type){case"table":{for(const n of r.header)Pe.walkTokens(n.tokens,e);for(const n of r.rows)for(const o of n)Pe.walkTokens(o.tokens,e);break}case"list":{Pe.walkTokens(r.items,e);break}default:Pe.defaults.extensions&&Pe.defaults.extensions.childTokens&&Pe.defaults.extensions.childTokens[r.type]?Pe.defaults.extensions.childTokens[r.type].forEach(function(n){Pe.walkTokens(r[n],e)}):r.tokens&&Pe.walkTokens(r.tokens,e)}};Pe.parseInline=function(t,e){if(typeof t=="undefined"||t===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof t!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");e=Nt({},Pe.defaults,e||{}),js(e);try{const r=Yt.lexInline(t,e);return e.walkTokens&&Pe.walkTokens(r,e.walkTokens),qt.parseInline(r,e)}catch(r){if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+_t(r.message+"",!0)+"</pre>";throw r}};Pe.Parser=qt;Pe.parser=qt.parse;Pe.Renderer=Xi;Pe.TextRenderer=Ys;Pe.Lexer=Yt;Pe.lexer=Yt.lex;Pe.Tokenizer=Vi;Pe.Slugger=qs;Pe.parse=Pe;qt.parse;Yt.lex;export{Ap as $,_p as A,Hd as B,dd as C,Vd as D,dp as E,kd as F,Jm as G,wd as H,ar as I,ns as J,Wm as K,cp as L,zm as M,Hm as N,ip as O,Vm as P,Xm as Q,jm as R,Ep as S,Tp as T,Sp as U,va as V,vp as W,ap as X,up as Y,wp as Z,ls as _,Cd as a,$m as a0,Zm as a1,zr as a2,xm as a3,Em as a4,op as a5,Pe as a6,Qm as a7,ss as a8,tp as a9,Ld as b,Km as c,dn as d,ca as e,np as f,Sd as g,Rd as h,xp as i,rp as j,Ym as k,qm as l,ep as m,hp as n,pp as o,mp as p,Ud as q,lp as r,hd as s,Ri as t,sp as u,fp as v,yp as w,gp as x,zd as y,bp as z};
